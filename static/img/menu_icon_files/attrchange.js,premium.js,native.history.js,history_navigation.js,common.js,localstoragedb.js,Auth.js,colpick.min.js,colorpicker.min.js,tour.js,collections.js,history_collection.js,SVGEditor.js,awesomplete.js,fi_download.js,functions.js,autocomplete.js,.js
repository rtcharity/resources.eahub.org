(function($){function isDOMAttrModifiedSupported(){var p=document.createElement('p');var flag=false;if(p.addEventListener){p.addEventListener('DOMAttrModified',function(){flag=true},false);}else if(p.attachEvent){p.attachEvent('onDOMAttrModified',function(){flag=true});}else{return false;}
p.setAttribute('id','target');return flag;}
function checkAttributes(chkAttr,e){if(chkAttr){var attributes=this.data('attr-old-value');if(e.attributeName.indexOf('style')>=0){if(!attributes['style'])
attributes['style']={};var keys=e.attributeName.split('.');e.attributeName=keys[0];e.oldValue=attributes['style'][keys[1]];e.newValue=keys[1]+':'
+this.prop("style")[$.camelCase(keys[1])];attributes['style'][keys[1]]=e.newValue;}else{e.oldValue=attributes[e.attributeName];e.newValue=this.attr(e.attributeName);attributes[e.attributeName]=e.newValue;}
this.data('attr-old-value',attributes);}}
var MutationObserver=window.MutationObserver||window.WebKitMutationObserver;$.fn.attrchange=function(a,b){if(typeof a=='object'){var cfg={trackValues:false,callback:$.noop};if(typeof a==="function"){cfg.callback=a;}else{$.extend(cfg,a);}
if(cfg.trackValues){this.each(function(i,el){var attributes={};for(var attr,i=0,attrs=el.attributes,l=attrs.length;i<l;i++){attr=attrs.item(i);attributes[attr.nodeName]=attr.value;}
$(this).data('attr-old-value',attributes);});}
if(MutationObserver){var mOptions={subtree:false,attributes:true,attributeOldValue:cfg.trackValues};var observer=new MutationObserver(function(mutations){mutations.forEach(function(e){var _this=e.target;if(cfg.trackValues){e.newValue=$(_this).attr(e.attributeName);}
if($(_this).data('attrchange-status')==='connected'){cfg.callback.call(_this,e);}});});return this.data('attrchange-method','Mutation Observer').data('attrchange-status','connected').data('attrchange-obs',observer).each(function(){observer.observe(this,mOptions);});}else if(isDOMAttrModifiedSupported()){return this.data('attrchange-method','DOMAttrModified').data('attrchange-status','connected').on('DOMAttrModified',function(event){if(event.originalEvent){event=event.originalEvent;}
event.attributeName=event.attrName;event.oldValue=event.prevValue;if($(this).data('attrchange-status')==='connected'){cfg.callback.call(this,event);}});}else if('onpropertychange'in document.body){return this.data('attrchange-method','propertychange').data('attrchange-status','connected').on('propertychange',function(e){e.attributeName=window.event.propertyName;checkAttributes.call($(this),cfg.trackValues,e);if($(this).data('attrchange-status')==='connected'){cfg.callback.call(this,e);}});}
return this;}else if(typeof a=='string'&&$.fn.attrchange.hasOwnProperty('extensions')&&$.fn.attrchange['extensions'].hasOwnProperty(a)){return $.fn.attrchange['extensions'][a].call(this,b);}}})(jQuery);;$(function(){$('#license-premium').on('change',function(){Premium.bannerSearch();});Premium.imgDetailIcon();})
var Premium={premium:0,selector_show:'.fi-premium',selector_hide:'.fi-not-premium',selector_show_icon:'.fi-premium-icon',selector_hide_icon:'.fi-not-premium-icon',original_banner:'',premium_banner:'',init:function()
{this.premium=(typeof gr.auth.me.premium!='undefined')?parseInt(gr.auth.me.premium,10):0;this.activatePremium();this.packLink();},is:function()
{return this.premium;},activatePremium:function()
{var premium_icon=document.querySelector('#download-form #premium');if(premium_icon)
{if(premium_icon.value==1)
{if(this.premium)
{this.showElements(this.selector_show_icon);this.hideElements(this.selector_hide_icon);}
else
{this.showElements(this.selector_hide_icon);this.hideElements(this.selector_show_icon);}}
else
{this.showElements(this.selector_show_icon);this.hideElements(this.selector_hide_icon);}}
if(this.premium)
{this.showElements(this.selector_show);this.hideElements(this.selector_hide);}
else
{this.showElements(this.selector_hide);this.hideElements(this.selector_show);}
if(document.getElementById('edge-content-icon-list'))this.bannerSearch();},bannerSearch:function()
{var banner_icon=document.getElementById('banner-icon-list');if(banner_icon)
{var license_premium=document.querySelector('input#license-premium');if(!this.premium&&license_premium)
{if(Premium.original_banner==''&&banner_icon)
{Premium.original_banner=banner_icon.innerHTML;}
var premium_ads=document.getElementById('fi-premium-edge-content-premium');if(Premium.premium_banner==''&&premium_ads)
{Premium.premium_banner=premium_ads.innerHTML;}
if(Premium.original_banner&&Premium.premium_banner)
{if(license_premium.checked)
{banner_icon.innerHTML=Premium.premium_banner;banner_icon.classList.add('fi-premium-edge-content-first');}}}}},check:function()
{this.premium=(typeof gr.auth.me.premium!='undefined')?gr.auth.me.premium:0;this.checkElements();this.activatePremium();return;},showElements:function(selector)
{[].forEach.call(document.querySelectorAll(selector),function(elem){elem.classList.remove('hidden')});},hideElements:function(selector)
{[].forEach.call(document.querySelectorAll(selector),function(elem){elem.classList.add('hidden')});},deleteElements:function(selector)
{document.querySelectorAll(selector).forEach(function(elem){document.getElementById(elem.id).parentNode.removeChild(elem);});},imgDetailIcon:function()
{if(typeof pack_items=='object'&&pack_items!=null)
{var self=this;pack_items.forEach(function(i,json){if(json.premium=="1"&&!self.premium)
{var img=document.querySelector('.detail-content .main-icon[data-type="img"] img');if(img){img.src=json.png;}
json.src=json.png;}});}},checkElements:function()
{document.querySelectorAll(this.selector_show+", "+this.selector_show_icon).forEach(function(element){element.classList.toggle("hidden",!~~gr.auth.me.premium)});document.querySelectorAll(this.selector_hide+", "+this.selector_hide_icon).forEach(function(element){element.classList.toggle("hidden",~~gr.auth.me.premium)});},packLink:function()
{var link=document.querySelector('section.list-top > a');if(link&&link.dataset.premium=='1'&&!this.premium)
{link.href=ACCOUNTS_BASE_URL+'premium/'+link.dataset.pack;}}}
Premium.init();;if(typeof JSON!=='object'){JSON={};}
(function(){'use strict';function f(n){return n<10?'0'+n:n;}
if(typeof Date.prototype.toJSON!=='function'){Date.prototype.toJSON=function(key){return isFinite(this.valueOf())?this.getUTCFullYear()+'-'+
f(this.getUTCMonth()+1)+'-'+
f(this.getUTCDate())+'T'+
f(this.getUTCHours())+':'+
f(this.getUTCMinutes())+':'+
f(this.getUTCSeconds())+'Z':null;};String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(key){return this.valueOf();};}
var cx=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,escapable=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,gap,indent,meta={'\b':'\\b','\t':'\\t','\n':'\\n','\f':'\\f','\r':'\\r','"':'\\"','\\':'\\\\'},rep;function quote(string){escapable.lastIndex=0;return escapable.test(string)?'"'+string.replace(escapable,function(a){var c=meta[a];return typeof c==='string'?c:'\\u'+('0000'+a.charCodeAt(0).toString(16)).slice(-4);})+'"':'"'+string+'"';}
function str(key,holder){var i,k,v,length,mind=gap,partial,value=holder[key];if(value&&typeof value==='object'&&typeof value.toJSON==='function'){value=value.toJSON(key);}
if(typeof rep==='function'){value=rep.call(holder,key,value);}
switch(typeof value){case'string':return quote(value);case'number':return isFinite(value)?String(value):'null';case'boolean':case'null':return String(value);case'object':if(!value){return'null';}
gap+=indent;partial=[];if(Object.prototype.toString.apply(value)==='[object Array]'){length=value.length;for(i=0;i<length;i+=1){partial[i]=str(i,value)||'null';}
v=partial.length===0?'[]':gap?'[\n'+gap+partial.join(',\n'+gap)+'\n'+mind+']':'['+partial.join(',')+']';gap=mind;return v;}
if(rep&&typeof rep==='object'){length=rep.length;for(i=0;i<length;i+=1){if(typeof rep[i]==='string'){k=rep[i];v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}else{for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=str(k,value);if(v){partial.push(quote(k)+(gap?': ':':')+v);}}}}
v=partial.length===0?'{}':gap?'{\n'+gap+partial.join(',\n'+gap)+'\n'+mind+'}':'{'+partial.join(',')+'}';gap=mind;return v;}}
if(typeof JSON.stringify!=='function'){JSON.stringify=function(value,replacer,space){var i;gap='';indent='';if(typeof space==='number'){for(i=0;i<space;i+=1){indent+=' ';}}else if(typeof space==='string'){indent=space;}
rep=replacer;if(replacer&&typeof replacer!=='function'&&(typeof replacer!=='object'||typeof replacer.length!=='number')){throw new Error('JSON.stringify');}
return str('',{'':value});};}
if(typeof JSON.parse!=='function'){JSON.parse=function(text,reviver){var j;function walk(holder,key){var k,v,value=holder[key];if(value&&typeof value==='object'){for(k in value){if(Object.prototype.hasOwnProperty.call(value,k)){v=walk(value,k);if(v!==undefined){value[k]=v;}else{delete value[k];}}}}
return reviver.call(holder,key,value);}
text=String(text);cx.lastIndex=0;if(cx.test(text)){text=text.replace(cx,function(a){return'\\u'+
('0000'+a.charCodeAt(0).toString(16)).slice(-4);});}
if(/^[\],:{}\s]*$/.test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,'@').replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,']').replace(/(?:^|:|,)(?:\s*\[)+/g,''))){j=eval('('+text+')');return typeof reviver==='function'?walk({'':j},''):j;}
throw new SyntaxError('JSON.parse');};}}());(function(window,undefined){"use strict";var History=window.History=window.History||{};if(typeof History.Adapter!=='undefined'){throw new Error('History.js Adapter has already been loaded...');}
History.Adapter={handlers:{},_uid:1,uid:function(element){return element._uid||(element._uid=History.Adapter._uid++);},bind:function(element,eventName,callback){var uid=History.Adapter.uid(element);History.Adapter.handlers[uid]=History.Adapter.handlers[uid]||{};History.Adapter.handlers[uid][eventName]=History.Adapter.handlers[uid][eventName]||[];History.Adapter.handlers[uid][eventName].push(callback);element['on'+eventName]=(function(element,eventName){return function(event){History.Adapter.trigger(element,eventName,event);};})(element,eventName);},trigger:function(element,eventName,event){event=event||{};var uid=History.Adapter.uid(element),i,n;History.Adapter.handlers[uid]=History.Adapter.handlers[uid]||{};History.Adapter.handlers[uid][eventName]=History.Adapter.handlers[uid][eventName]||[];for(i=0,n=History.Adapter.handlers[uid][eventName].length;i<n;++i){History.Adapter.handlers[uid][eventName][i].apply(this,[event]);}},extractEventData:function(key,event){var result=(event&&event[key])||undefined;return result;},onDomLoad:function(callback){var timeout=window.setTimeout(function(){callback();},2000);window.onload=function(){clearTimeout(timeout);callback();};}};if(typeof History.init!=='undefined'){History.init();}})(window);(function(window,undefined){"use strict";var
document=window.document,setTimeout=window.setTimeout||setTimeout,clearTimeout=window.clearTimeout||clearTimeout,setInterval=window.setInterval||setInterval,History=window.History=window.History||{};if(typeof History.initHtml4!=='undefined'){throw new Error('History.js HTML4 Support has already been loaded...');}
History.initHtml4=function(){if(typeof History.initHtml4.initialized!=='undefined'){return false;}
else{History.initHtml4.initialized=true;}
History.enabled=true;History.savedHashes=[];History.isLastHash=function(newHash){var oldHash=History.getHashByIndex(),isLast;isLast=newHash===oldHash;return isLast;};History.isHashEqual=function(newHash,oldHash){newHash=encodeURIComponent(newHash).replace(/%25/g,"%");oldHash=encodeURIComponent(oldHash).replace(/%25/g,"%");return newHash===oldHash;};History.saveHash=function(newHash){if(History.isLastHash(newHash)){return false;}
History.savedHashes.push(newHash);return true;};History.getHashByIndex=function(index){var hash=null;if(typeof index==='undefined'){hash=History.savedHashes[History.savedHashes.length-1];}
else if(index<0){hash=History.savedHashes[History.savedHashes.length+index];}
else{hash=History.savedHashes[index];}
return hash;};History.discardedHashes={};History.discardedStates={};History.discardState=function(discardedState,forwardState,backState){var discardedStateHash=History.getHashByState(discardedState),discardObject;discardObject={'discardedState':discardedState,'backState':backState,'forwardState':forwardState};History.discardedStates[discardedStateHash]=discardObject;return true;};History.discardHash=function(discardedHash,forwardState,backState){var discardObject={'discardedHash':discardedHash,'backState':backState,'forwardState':forwardState};History.discardedHashes[discardedHash]=discardObject;return true;};History.discardedState=function(State){var StateHash=History.getHashByState(State),discarded;discarded=History.discardedStates[StateHash]||false;return discarded;};History.discardedHash=function(hash){var discarded=History.discardedHashes[hash]||false;return discarded;};History.recycleState=function(State){var StateHash=History.getHashByState(State);if(History.discardedState(State)){delete History.discardedStates[StateHash];}
return true;};if(History.emulated.hashChange){History.hashChangeInit=function(){History.checkerFunction=null;var lastDocumentHash='',iframeId,iframe,lastIframeHash,checkerRunning,startedWithHash=Boolean(History.getHash());if(History.isInternetExplorer()){iframeId='historyjs-iframe';iframe=document.createElement('iframe');iframe.setAttribute('id',iframeId);iframe.setAttribute('src','#');iframe.style.display='none';document.body.appendChild(iframe);iframe.contentWindow.document.open();iframe.contentWindow.document.close();lastIframeHash='';checkerRunning=false;History.checkerFunction=function(){if(checkerRunning){return false;}
checkerRunning=true;var
documentHash=History.getHash(),iframeHash=History.getHash(iframe.contentWindow.document);if(documentHash!==lastDocumentHash){lastDocumentHash=documentHash;if(iframeHash!==documentHash){lastIframeHash=iframeHash=documentHash;iframe.contentWindow.document.open();iframe.contentWindow.document.close();iframe.contentWindow.document.location.hash=History.escapeHash(documentHash);}
History.Adapter.trigger(window,'hashchange');}
else if(iframeHash!==lastIframeHash){lastIframeHash=iframeHash;if(startedWithHash&&iframeHash===''){History.back();}
else{History.setHash(iframeHash,false);}}
checkerRunning=false;return true;};}
else{History.checkerFunction=function(){var documentHash=History.getHash()||'';if(documentHash!==lastDocumentHash){lastDocumentHash=documentHash;History.Adapter.trigger(window,'hashchange');}
return true;};}
History.intervalList.push(setInterval(History.checkerFunction,History.options.hashChangeInterval));return true;};History.Adapter.onDomLoad(History.hashChangeInit);}
if(History.emulated.pushState){History.onHashChange=function(event){var currentUrl=((event&&event.newURL)||History.getLocationHref()),currentHash=History.getHashByUrl(currentUrl),currentState=null,currentStateHash=null,currentStateHashExits=null,discardObject;if(History.isLastHash(currentHash)){History.busy(false);return false;}
History.doubleCheckComplete();History.saveHash(currentHash);if(currentHash&&History.isTraditionalAnchor(currentHash)){History.Adapter.trigger(window,'anchorchange');History.busy(false);return false;}
currentState=History.extractState(History.getFullUrl(currentHash||History.getLocationHref()),true);if(History.isLastSavedState(currentState)){History.busy(false);return false;}
currentStateHash=History.getHashByState(currentState);discardObject=History.discardedState(currentState);if(discardObject){if(History.getHashByIndex(-2)===History.getHashByState(discardObject.forwardState)){History.back(false);}else{History.forward(false);}
return false;}
History.pushState(currentState.data,currentState.title,encodeURI(currentState.url),false);return true;};History.Adapter.bind(window,'hashchange',History.onHashChange);History.pushState=function(data,title,url,queue){url=encodeURI(url).replace(/%25/g,"%");if(History.getHashByUrl(url)){throw new Error('History.js does not support states with fragment-identifiers (hashes/anchors).');}
if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.pushState,args:arguments,queue:queue});return false;}
History.busy(true);var newState=History.createStateObject(data,title,url),newStateHash=History.getHashByState(newState),oldState=History.getState(false),oldStateHash=History.getHashByState(oldState),html4Hash=History.getHash(),wasExpected=History.expectedStateId==newState.id;History.storeState(newState);History.expectedStateId=newState.id;History.recycleState(newState);History.setTitle(newState);if(newStateHash===oldStateHash){History.busy(false);return false;}
History.saveState(newState);if(!History.isHashEqual(newStateHash,html4Hash)&&!History.isHashEqual(newStateHash,History.getShortUrl(History.getLocationHref()))){History.setHash(newStateHash,false);}
History.busy(false);return true;};History.replaceState=function(data,title,url,queue){url=encodeURI(url).replace(/%25/g,"%");if(History.getHashByUrl(url)){throw new Error('History.js does not support states with fragment-identifiers (hashes/anchors).');}
if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.replaceState,args:arguments,queue:queue});return false;}
History.busy(true);var newState=History.createStateObject(data,title,url),newStateHash=History.getHashByState(newState),oldState=History.getState(false),oldStateHash=History.getHashByState(oldState),previousState=History.getStateByIndex(-2);History.discardState(oldState,newState,previousState);if(newStateHash===oldStateHash){History.storeState(newState);History.expectedStateId=newState.id;History.recycleState(newState);History.setTitle(newState);History.saveState(newState);History.Adapter.trigger(window,'statechange');History.busy(false);}
else{History.pushState(newState.data,newState.title,newState.url,false);}
return true;};}
if(History.emulated.pushState){if(History.getHash()&&!History.emulated.hashChange){History.Adapter.onDomLoad(function(){History.Adapter.trigger(window,'hashchange');});}}};if(typeof History.init!=='undefined'){History.init();}})(window);(function(window,undefined){"use strict";var
console=window.console||undefined,document=window.document,navigator=window.navigator,sessionStorage=false,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,setInterval=window.setInterval,clearInterval=window.clearInterval,JSON=window.JSON,alert=window.alert,History=window.History=window.History||{},history=window.history;try{sessionStorage=window.sessionStorage;sessionStorage.setItem('TEST','1');sessionStorage.removeItem('TEST');}catch(e){sessionStorage=false;}
JSON.stringify=JSON.stringify||JSON.encode;JSON.parse=JSON.parse||JSON.decode;if(typeof History.init!=='undefined'){throw new Error('History.js Core has already been loaded...');}
History.init=function(options){if(typeof History.Adapter==='undefined'){return false;}
if(typeof History.initCore!=='undefined'){History.initCore();}
if(typeof History.initHtml4!=='undefined'){History.initHtml4();}
return true;};History.initCore=function(options){if(typeof History.initCore.initialized!=='undefined'){return false;}
else{History.initCore.initialized=true;}
History.options=History.options||{};History.options.hashChangeInterval=History.options.hashChangeInterval||100;History.options.safariPollInterval=History.options.safariPollInterval||500;History.options.doubleCheckInterval=History.options.doubleCheckInterval||500;History.options.disableSuid=History.options.disableSuid||false;History.options.storeInterval=History.options.storeInterval||1000;History.options.busyDelay=History.options.busyDelay||250;History.options.debug=History.options.debug||false;History.options.initialTitle=History.options.initialTitle||document.title;History.options.html4Mode=History.options.html4Mode||false;History.options.delayInit=History.options.delayInit||false;History.intervalList=[];History.clearAllIntervals=function(){var i,il=History.intervalList;if(typeof il!=="undefined"&&il!==null){for(i=0;i<il.length;i++){clearInterval(il[i]);}
History.intervalList=null;}};History.debug=function(){if((History.options.debug||false)){History.log.apply(History,arguments);}};History.log=function(){var
consoleExists=!(typeof console==='undefined'||typeof console.log==='undefined'||typeof console.log.apply==='undefined'),textarea=document.getElementById('log'),message,i,n,args,arg;if(consoleExists){args=Array.prototype.slice.call(arguments);message=args.shift();if(typeof console.debug!=='undefined'){console.debug.apply(console,[message,args]);}
else{console.log.apply(console,[message,args]);}}
else{message=("\n"+arguments[0]+"\n");}
for(i=1,n=arguments.length;i<n;++i){arg=arguments[i];if(typeof arg==='object'&&typeof JSON!=='undefined'){try{arg=JSON.stringify(arg);}
catch(Exception){}}
message+="\n"+arg+"\n";}
if(textarea){textarea.value+=message+"\n-----\n";textarea.scrollTop=textarea.scrollHeight-textarea.clientHeight;}
else if(!consoleExists){alert(message);}
return true;};History.getInternetExplorerMajorVersion=function(){var result=History.getInternetExplorerMajorVersion.cached=(typeof History.getInternetExplorerMajorVersion.cached!=='undefined')?History.getInternetExplorerMajorVersion.cached:(function(){var v=3,div=document.createElement('div'),all=div.getElementsByTagName('i');while((div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->')&&all[0]){}
return(v>4)?v:false;})();return result;};History.isInternetExplorer=function(){var result=History.isInternetExplorer.cached=(typeof History.isInternetExplorer.cached!=='undefined')?History.isInternetExplorer.cached:Boolean(History.getInternetExplorerMajorVersion());return result;};if(History.options.html4Mode){History.emulated={pushState:true,hashChange:true};}
else{History.emulated={pushState:!Boolean(window.history&&window.history.pushState&&window.history.replaceState&&!((/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i).test(navigator.userAgent)||(/AppleWebKit\/5([0-2]|3[0-2])/i).test(navigator.userAgent))),hashChange:Boolean(!(('onhashchange'in window)||('onhashchange'in document))||(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<8))};}
History.enabled=!History.emulated.pushState;History.bugs={setHash:Boolean(!History.emulated.pushState&&navigator.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(navigator.userAgent)),safariPoll:Boolean(!History.emulated.pushState&&navigator.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(navigator.userAgent)),ieDoubleCheck:Boolean(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<7)};History.isEmptyObject=function(obj){for(var name in obj){if(obj.hasOwnProperty(name)){return false;}}
return true;};History.cloneObject=function(obj){var hash,newObj;if(obj){hash=JSON.stringify(obj);newObj=JSON.parse(hash);}
else{newObj={};}
return newObj;};History.getRootUrl=function(){var rootUrl=document.location.protocol+'//'+(document.location.hostname||document.location.host);if(document.location.port||false){rootUrl+=':'+document.location.port;}
rootUrl+='/';return rootUrl;};History.getBaseHref=function(){var
baseElements=document.getElementsByTagName('base'),baseElement=null,baseHref='';if(baseElements.length===1){baseElement=baseElements[0];baseHref=baseElement.href.replace(/[^\/]+$/,'');}
baseHref=baseHref.replace(/\/+$/,'');if(baseHref)baseHref+='/';return baseHref;};History.getBaseUrl=function(){var baseUrl=History.getBaseHref()||History.getBasePageUrl()||History.getRootUrl();return baseUrl;};History.getPageUrl=function(){var
State=History.getState(false,false),stateUrl=(State||{}).url||History.getLocationHref(),pageUrl;pageUrl=stateUrl.replace(/\/+$/,'').replace(/[^\/]+$/,function(part,index,string){return(/\./).test(part)?part:part+'/';});return pageUrl;};History.getBasePageUrl=function(){var basePageUrl=(History.getLocationHref()).replace(/[#\?].*/,'').replace(/[^\/]+$/,function(part,index,string){return(/[^\/]$/).test(part)?'':part;}).replace(/\/+$/,'')+'/';return basePageUrl;};History.getFullUrl=function(url,allowBaseHref){var fullUrl=url,firstChar=url.substring(0,1);allowBaseHref=(typeof allowBaseHref==='undefined')?true:allowBaseHref;if(/[a-z]+\:\/\//.test(url)){}
else if(firstChar==='/'){fullUrl=History.getRootUrl()+url.replace(/^\/+/,'');}
else if(firstChar==='#'){fullUrl=History.getPageUrl().replace(/#.*/,'')+url;}
else if(firstChar==='?'){fullUrl=History.getPageUrl().replace(/[\?#].*/,'')+url;}
else{if(allowBaseHref){fullUrl=History.getBaseUrl()+url.replace(/^(\.\/)+/,'');}else{fullUrl=History.getBasePageUrl()+url.replace(/^(\.\/)+/,'');}}
return fullUrl.replace(/\#$/,'');};History.getShortUrl=function(url){var shortUrl=url,baseUrl=History.getBaseUrl(),rootUrl=History.getRootUrl();if(History.emulated.pushState){shortUrl=shortUrl.replace(baseUrl,'');}
shortUrl=shortUrl.replace(rootUrl,'/');if(History.isTraditionalAnchor(shortUrl)){shortUrl='./'+shortUrl;}
shortUrl=shortUrl.replace(/^(\.\/)+/g,'./').replace(/\#$/,'');return shortUrl;};History.getLocationHref=function(doc){doc=doc||document;if(doc.URL===doc.location.href)
return doc.location.href;if(doc.location.href===decodeURIComponent(doc.URL))
return doc.URL;if(doc.location.hash&&decodeURIComponent(doc.location.href.replace(/^[^#]+/,""))===doc.location.hash)
return doc.location.href;if(doc.URL.indexOf('#')==-1&&doc.location.href.indexOf('#')!=-1)
return doc.location.href;return doc.URL||doc.location.href;};History.store={};History.idToState=History.idToState||{};History.stateToId=History.stateToId||{};History.urlToId=History.urlToId||{};History.storedStates=History.storedStates||[];History.savedStates=History.savedStates||[];History.normalizeStore=function(){History.store.idToState=History.store.idToState||{};History.store.urlToId=History.store.urlToId||{};History.store.stateToId=History.store.stateToId||{};};History.getState=function(friendly,create){if(typeof friendly==='undefined'){friendly=true;}
if(typeof create==='undefined'){create=true;}
var State=History.getLastSavedState();if(!State&&create){State=History.createStateObject();}
if(friendly){State=History.cloneObject(State);State.url=State.cleanUrl||State.url;}
return State;};History.getIdByState=function(newState){var id=History.extractId(newState.url),str;if(!id){str=History.getStateString(newState);if(typeof History.stateToId[str]!=='undefined'){id=History.stateToId[str];}
else if(typeof History.store.stateToId[str]!=='undefined'){id=History.store.stateToId[str];}
else{while(true){id=(new Date()).getTime()+String(Math.random()).replace(/\D/g,'');if(typeof History.idToState[id]==='undefined'&&typeof History.store.idToState[id]==='undefined'){break;}}
History.stateToId[str]=id;History.idToState[id]=newState;}}
return id;};History.normalizeState=function(oldState){var newState,dataNotEmpty;if(!oldState||(typeof oldState!=='object')){oldState={};}
if(typeof oldState.normalized!=='undefined'){return oldState;}
if(!oldState.data||(typeof oldState.data!=='object')){oldState.data={};}
newState={};newState.normalized=true;newState.title=oldState.title||'';newState.url=History.getFullUrl(oldState.url?oldState.url:(History.getLocationHref()));newState.hash=History.getShortUrl(newState.url);newState.data=History.cloneObject(oldState.data);newState.id=History.getIdByState(newState);newState.cleanUrl=newState.url.replace(/\??\&_suid.*/,'');newState.url=newState.cleanUrl;dataNotEmpty=!History.isEmptyObject(newState.data);if((newState.title||dataNotEmpty)&&History.options.disableSuid!==true){newState.hash=History.getShortUrl(newState.url).replace(/\??\&_suid.*/,'');if(!/\?/.test(newState.hash)){newState.hash+='?';}
newState.hash+='&_suid='+newState.id;}
newState.hashedUrl=History.getFullUrl(newState.hash);if((History.emulated.pushState||History.bugs.safariPoll)&&History.hasUrlDuplicate(newState)){newState.url=newState.hashedUrl;}
return newState;};History.createStateObject=function(data,title,url){var State={'data':data,'title':title,'url':url};State=History.normalizeState(State);return State;};History.getStateById=function(id){id=String(id);var State=History.idToState[id]||History.store.idToState[id]||undefined;return State;};History.getStateString=function(passedState){var State,cleanedState,str;State=History.normalizeState(passedState);cleanedState={data:State.data,title:passedState.title,url:passedState.url};str=JSON.stringify(cleanedState);return str;};History.getStateId=function(passedState){var State,id;State=History.normalizeState(passedState);id=State.id;return id;};History.getHashByState=function(passedState){var State,hash;State=History.normalizeState(passedState);hash=State.hash;return hash;};History.extractId=function(url_or_hash){var id,parts,url,tmp;if(url_or_hash.indexOf('#')!=-1)
{tmp=url_or_hash.split("#")[0];}
else
{tmp=url_or_hash;}
parts=/(.*)\&_suid=([0-9]+)$/.exec(tmp);url=parts?(parts[1]||url_or_hash):url_or_hash;id=parts?String(parts[2]||''):'';return id||false;};History.isTraditionalAnchor=function(url_or_hash){var isTraditional=!(/[\/\?\.]/.test(url_or_hash));return isTraditional;};History.extractState=function(url_or_hash,create){var State=null,id,url;create=create||false;id=History.extractId(url_or_hash);if(id){State=History.getStateById(id);}
if(!State){url=History.getFullUrl(url_or_hash);id=History.getIdByUrl(url)||false;if(id){State=History.getStateById(id);}
if(!State&&create&&!History.isTraditionalAnchor(url_or_hash)){State=History.createStateObject(null,null,url);}}
return State;};History.getIdByUrl=function(url){var id=History.urlToId[url]||History.store.urlToId[url]||undefined;return id;};History.getLastSavedState=function(){return History.savedStates[History.savedStates.length-1]||undefined;};History.getLastStoredState=function(){return History.storedStates[History.storedStates.length-1]||undefined;};History.hasUrlDuplicate=function(newState){var hasDuplicate=false,oldState;oldState=History.extractState(newState.url);hasDuplicate=oldState&&oldState.id!==newState.id;return hasDuplicate;};History.storeState=function(newState){History.urlToId[newState.url]=newState.id;History.storedStates.push(History.cloneObject(newState));return newState;};History.isLastSavedState=function(newState){var isLast=false,newId,oldState,oldId;if(History.savedStates.length){newId=newState.id;oldState=History.getLastSavedState();oldId=oldState.id;isLast=(newId===oldId);}
return isLast;};History.saveState=function(newState){if(History.isLastSavedState(newState)){return false;}
History.savedStates.push(History.cloneObject(newState));return true;};History.getStateByIndex=function(index){var State=null;if(typeof index==='undefined'){State=History.savedStates[History.savedStates.length-1];}
else if(index<0){State=History.savedStates[History.savedStates.length+index];}
else{State=History.savedStates[index];}
return State;};History.getCurrentIndex=function(){var index=null;if(History.savedStates.length<1){index=0;}
else{index=History.savedStates.length-1;}
return index;};History.getHash=function(doc){var url=History.getLocationHref(doc),hash;hash=History.getHashByUrl(url);return hash;};History.unescapeHash=function(hash){var result=History.normalizeHash(hash);result=decodeURIComponent(result);return result;};History.normalizeHash=function(hash){var result=hash.replace(/[^#]*#/,'').replace(/#.*/,'');return result;};History.setHash=function(hash,queue){var State,pageUrl;if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.setHash,args:arguments,queue:queue});return false;}
History.busy(true);State=History.extractState(hash,true);if(State&&!History.emulated.pushState){History.pushState(State.data,State.title,State.url,false);}
else if(History.getHash()!==hash){if(History.bugs.setHash){pageUrl=History.getPageUrl();History.pushState(null,null,pageUrl+'#'+hash,false);}
else{document.location.hash=hash;}}
return History;};History.escapeHash=function(hash){var result=History.normalizeHash(hash);result=window.encodeURIComponent(result);if(!History.bugs.hashEscape){result=result.replace(/\%21/g,'!').replace(/\%26/g,'&').replace(/\%3D/g,'=').replace(/\%3F/g,'?');}
return result;};History.getHashByUrl=function(url){var hash=String(url).replace(/([^#]*)#?([^#]*)#?(.*)/,'$2');hash=History.unescapeHash(hash);return hash;};History.setTitle=function(newState){var title=newState.title,firstState;if(!title){firstState=History.getStateByIndex(0);if(firstState&&firstState.url===newState.url){title=firstState.title||History.options.initialTitle;}}
try{document.getElementsByTagName('title')[0].innerHTML=title.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ');}
catch(Exception){}
document.title=title;return History;};History.queues=[];History.busy=function(value){if(typeof value!=='undefined'){History.busy.flag=value;}
else if(typeof History.busy.flag==='undefined'){History.busy.flag=false;}
if(!History.busy.flag){clearTimeout(History.busy.timeout);var fireNext=function(){var i,queue,item;if(History.busy.flag)return;for(i=History.queues.length-1;i>=0;--i){queue=History.queues[i];if(queue.length===0)continue;item=queue.shift();History.fireQueueItem(item);History.busy.timeout=setTimeout(fireNext,History.options.busyDelay);}};History.busy.timeout=setTimeout(fireNext,History.options.busyDelay);}
return History.busy.flag;};History.busy.flag=false;History.fireQueueItem=function(item){return item.callback.apply(item.scope||History,item.args||[]);};History.pushQueue=function(item){History.queues[item.queue||0]=History.queues[item.queue||0]||[];History.queues[item.queue||0].push(item);return History;};History.queue=function(item,queue){if(typeof item==='function'){item={callback:item};}
if(typeof queue!=='undefined'){item.queue=queue;}
if(History.busy()){History.pushQueue(item);}else{History.fireQueueItem(item);}
return History;};History.clearQueue=function(){History.busy.flag=false;History.queues=[];return History;};History.stateChanged=false;History.doubleChecker=false;History.doubleCheckComplete=function(){History.stateChanged=true;History.doubleCheckClear();return History;};History.doubleCheckClear=function(){if(History.doubleChecker){clearTimeout(History.doubleChecker);History.doubleChecker=false;}
return History;};History.doubleCheck=function(tryAgain){History.stateChanged=false;History.doubleCheckClear();if(History.bugs.ieDoubleCheck){History.doubleChecker=setTimeout(function(){History.doubleCheckClear();if(!History.stateChanged){tryAgain();}
return true;},History.options.doubleCheckInterval);}
return History;};History.safariStatePoll=function(){var
urlState=History.extractState(History.getLocationHref()),newState;if(!History.isLastSavedState(urlState)){newState=urlState;}
else{return;}
if(!newState){newState=History.createStateObject();}
History.Adapter.trigger(window,'popstate');return History;};History.back=function(queue){if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.back,args:arguments,queue:queue});return false;}
History.busy(true);History.doubleCheck(function(){History.back(false);});history.go(-1);return true;};History.forward=function(queue){if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.forward,args:arguments,queue:queue});return false;}
History.busy(true);History.doubleCheck(function(){History.forward(false);});history.go(1);return true;};History.go=function(index,queue){var i;if(index>0){for(i=1;i<=index;++i){History.forward(queue);}}
else if(index<0){for(i=-1;i>=index;--i){History.back(queue);}}
else{throw new Error('History.go: History.go requires a positive or negative integer passed.');}
return History;};if(History.emulated.pushState){var emptyFunction=function(){};History.pushState=History.pushState||emptyFunction;History.replaceState=History.replaceState||emptyFunction;}
else{History.onPopState=function(event,extra){var stateId=false,newState=false,currentHash,currentState;History.doubleCheckComplete();currentHash=History.getHash();if(currentHash){currentState=History.extractState(currentHash||History.getLocationHref(),true);if(currentState){History.replaceState(currentState.data,currentState.title,currentState.url,false);}
else{History.Adapter.trigger(window,'anchorchange');History.busy(false);}
History.expectedStateId=false;return false;}
stateId=History.Adapter.extractEventData('state',event,extra)||false;if(stateId){newState=History.getStateById(stateId);}
else if(History.expectedStateId){newState=History.getStateById(History.expectedStateId);}
else{newState=History.extractState(History.getLocationHref());}
if(!newState){newState=History.createStateObject(null,null,History.getLocationHref());}
History.expectedStateId=false;if(History.isLastSavedState(newState)){History.busy(false);return false;}
History.storeState(newState);History.saveState(newState);History.setTitle(newState);History.Adapter.trigger(window,'statechange');History.busy(false);return true;};History.Adapter.bind(window,'popstate',History.onPopState);History.pushState=function(data,title,url,queue){if(History.getHashByUrl(url)&&History.emulated.pushState){throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');}
if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.pushState,args:arguments,queue:queue});return false;}
History.busy(true);var newState=History.createStateObject(data,title,url);if(History.isLastSavedState(newState)){History.busy(false);}
else{History.storeState(newState);History.expectedStateId=newState.id;history.pushState(newState.id,newState.title,newState.url);History.Adapter.trigger(window,'popstate');}
return true;};History.replaceState=function(data,title,url,queue){if(History.getHashByUrl(url)&&History.emulated.pushState){throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).');}
if(queue!==false&&History.busy()){History.pushQueue({scope:History,callback:History.replaceState,args:arguments,queue:queue});return false;}
History.busy(true);var newState=History.createStateObject(data,title,url);if(History.isLastSavedState(newState)){History.busy(false);}
else{History.storeState(newState);History.expectedStateId=newState.id;history.replaceState(newState.id,newState.title,newState.url);History.Adapter.trigger(window,'popstate');}
return true;};}
if(sessionStorage){try{History.store=JSON.parse(sessionStorage.getItem('History.store'))||{};}
catch(err){History.store={};}
History.normalizeStore();}
else{History.store={};History.normalizeStore();}
History.Adapter.bind(window,"unload",History.clearAllIntervals);History.saveState(History.storeState(History.extractState(History.getLocationHref(),true)));if(sessionStorage){History.onUnload=function(){var currentStore,item,currentStoreString;try{currentStore=JSON.parse(sessionStorage.getItem('History.store'))||{};}
catch(err){currentStore={};}
currentStore.idToState=currentStore.idToState||{};currentStore.urlToId=currentStore.urlToId||{};currentStore.stateToId=currentStore.stateToId||{};for(item in History.idToState){if(!History.idToState.hasOwnProperty(item)){continue;}
currentStore.idToState[item]=History.idToState[item];}
for(item in History.urlToId){if(!History.urlToId.hasOwnProperty(item)){continue;}
currentStore.urlToId[item]=History.urlToId[item];}
for(item in History.stateToId){if(!History.stateToId.hasOwnProperty(item)){continue;}
currentStore.stateToId[item]=History.stateToId[item];}
History.store=currentStore;History.normalizeStore();currentStoreString=JSON.stringify(currentStore);try{sessionStorage.setItem('History.store',currentStoreString);}
catch(e){if(e.code===DOMException.QUOTA_EXCEEDED_ERR){if(sessionStorage.length){sessionStorage.removeItem('History.store');sessionStorage.setItem('History.store',currentStoreString);}else{}}else{throw e;}}};History.intervalList.push(setInterval(History.onUnload,History.options.storeInterval));History.Adapter.bind(window,'beforeunload',History.onUnload);History.Adapter.bind(window,'unload',History.onUnload);}
if(!History.emulated.pushState){if(History.bugs.safariPoll){History.intervalList.push(setInterval(History.safariStatePoll,History.options.safariPollInterval));}
if(navigator.vendor==='Apple Computer, Inc.'||(navigator.appCodeName||'')==='Mozilla'){History.Adapter.bind(window,'hashchange',function(){History.Adapter.trigger(window,'popstate');});if(History.getHash()){History.Adapter.onDomLoad(function(){History.Adapter.trigger(window,'hashchange');});}}}};if(!History.options||!History.options.delayInit){History.init();}})(window);;$(function(){$(window).on('load',function(){setTimeout(function(e){$(window).bind('popstate',function(e){var State=History.getState();if(window.location.href.indexOf(messages.common.free_icon)!=-1)
{if(!document.querySelector('#detail.loaded'))
{ModalDetail.getDetail(window.location.href);return;}}
if(State)
{if(document.querySelector('#detail-overlay.loading')){ModalDetail.close();return;}
if(!INFINITY.infinityLoading)
{window.location.href=window.location.href;return;}}
else
{window.location.href=window.location.href;return;}});},0);});$(document).keydown(function(e){var inputs=document.querySelectorAll('.collection .collection-content.edit-mode .icons .collectionIcon .edit .collection-icon-rename, .collection .collection-header .edit-name.active .collection-name-input');var focused=[].some.call(inputs,function(e){return e==document.activeElement;});if(!focused)
{if(document.querySelector('#detail-overlay.loading'))
{if(e.keyCode==27){ModalDetail.close();ModalDetail.pushState({page:'pagination'},document.title,ModalDetail.prev_url);}
if(e.keyCode==39){ModalDetail.goNext();}
if(e.keyCode==37){ModalDetail.goPrev();}}
else
{if(document.getElementById('pagination-page')&&typeof axScript!=='undefined')
{if(e.keyCode==39)
{INFINITY.infinityLoaderBtn(axScript,'next');}
if(e.keyCode==37)
{INFINITY.infinityLoaderBtn(axScript,'prev');}}}
if(document.getElementById('download-form')){icon_id=parseInt(document.getElementById('icon_id').value,10);icon_name=document.getElementById('keyword').value
icon_team=parseInt(document.getElementById('team').value,10);icon_color=parseInt(document.getElementById('colored').value,10);icon_premium=parseInt(document.querySelector('#download-form #premium').value,10);if(!db instanceof(Object)){return;}
var collection=Collection.getActive();if(!collection)return;var stored=db.queryAll(collection.bookmark_id,{query:{id:icon_id}}).length;if((e.keyCode==107)||(e.keyCode==187)||(e.keyCode==171)){if(stored)return;Widget.addIcon(icon_id,icon_name,icon_team,icon_color,icon_premium);}
if((e.keyCode==109)||(e.keyCode==189)||(e.keyCode==173)){if(!stored)return;Widget.delIcon(icon_id,icon_name,icon_team);}}}});if(typeof toggleDetailButton=='function')toggleDetailButton();});var History=window.History;;$(function(){var methods=["assert","cd","clear","count","countReset","debug","dir","dirxml","error","exception","group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","select","table","time","timeEnd","timeStamp","timeline","timelineEnd","trace","warn"];var length=methods.length;var console=(window.console=window.console||{});var method;var noop=function(){};while(length--){method=methods[length];if(!console[method]){try{console[method]=noop;}catch(e){}}}
try{localStorage.n_pageviews=(typeof localStorage.n_pageviews!='undefined')?parseInt(localStorage.n_pageviews,10)+1:1;}catch(e){}
if(typeof gr.sponsor!='undefined'&&gr.sponsor!=null)
{if(typeof gr.sponsor.coupon!="undefined"&&!~~gr.auth.me.premium){gr.sponsor.coupon.launch();}}
$('#report-form, #report-form-collection').submit(function(e){e.preventDefault();var data={};var radio_holder=this.querySelector('.radio-holder');if(typeof radio_holder!='undefined')radio_holder.classList.remove('error');var serializeArray=$(this).serializeArray();if(serializeArray.length==1){radio_holder.classList.add('error');UserAlerts.warning('Oops!',messages.report.message);return;}
if($(this).attr('id')=='report-form')
{data.item=(pack_items&&current)?parseInt(pack_items[current].id,10):icon_id;data.format=$_("#download-form #format").value;data.content=$_("#download-form #icon_id").value;}
if($(this).attr('id')=='report-form-collection')
{data.item=($_("#download-collection-form #downC_bookmark_id").value)?$_("#download-collection-form #downC_bookmark_id").value:Collection.getActive().bookmark_id;data.format=$("#download-collection-form #downC_format").val();data.content=this.reason.value+': '+$("#download-collection-form #downC_icons").val();}
$(this).serializeArray().forEach(function(field){field.name=field.name.replace('-collection','');data[field.name]=field.value;});data.navigator="User-agent: "+navigator.userAgent+"\n";data.navigator+="Platform: "+navigator.platform+"\n";data.navigator+="Browser Language: "+navigator.language+"\n";data.navigator+="Cookies Enabled: "+navigator.cookieEnabled+"\n";data.navigator+="Browser Online: "+navigator.onLine+"\n";data.url=window.location.href;data.language=LANGUAGE_SHORT;plugins=[];if(typeof navigator.plugins!="undefined"){[].forEach.call(navigator.plugins,function(e){plugins.push(e.name)});}
plugins=JSON.stringify(plugins);if(typeof document.querySelector=='function'){var script=document.querySelector("script[src*='?key=']").src.split("key=")[1];}
data.script=script;data.plugins=plugins;gr.request.post('valuations/user_report',data);ga('send','event','Detail View','Report this icon',$('#report-form :input:checked, #report-form-collection :input:checked ')[0].value);});});$(document).ajaxError(function(e,jqxhr,settings){if(!~settings.url.indexOf("coupons/popup"))
{UserAlerts.danger('Oops!',messages.errors.connectivity);}});function detailReportReceived(data){if(document.get('#modal-report')&&document.get('#modal-report').checked)
{document.get('#report-form').reset();document.get("#modal-report").checked=false;}
else
{document.get('#report-form-collection').reset();document.get("#modal-report-collection").checked=false;}
var method=(data.success)?'success':'warning';UserAlerts[method](data.title,data.message);}
if(!String.prototype.format){String.prototype.format=function(){var args=arguments;return this.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!='undefined'?args[number]:match;});};}
function $_(s){var s=document.querySelectorAll(s);return(s.length>1)?s:(s[0])?s[0]:null;};document.get=function(s){return document.querySelector(s);};document.find=function(s){return document.querySelectorAll(s);};Element.prototype.get=function(s){return this.querySelector(s);};Element.prototype.find=function(s){return this.querySelectorAll(s);};Element.prototype.parents=function(s){var l=[],e=this;if(s){var t=s.charAt(0);}
for(var q=0;e&&e!==document&&!q;e=e.parentNode){if(s){if(t==='.'&&e.classList.contains(s.substr(1)))q=1;if(t==='#'&&e.id===s.substr(1))q=1;if(t==='['&&e.hasAttribute(s.substr(1,s.length-1)))q=1;if(e.tagName.toLowerCase()===s)q=1;}
l.push(e);}
return(!l.length||(l.reverse()[0].tagName=='HTML'&&s))?null:l;};Element.prototype.parent=function(s){var list=this.parents(s);if(typeof s=="undefined")list.reverse();return(list&&list.length)?list[0]:null;};Element.prototype.outerWidth=function(){var width,margin;width=this.clientWidth;margin=parseInt(getComputedStyle(this).marginLeft,10)+parseInt(getComputedStyle(this).marginRight,10);return(width+margin);}
Element.prototype.outerHeight=function(){var height,margin;height=this.clientHeight;margin=parseInt(getComputedStyle(this).marginTop,10)+parseInt(getComputedStyle(this).marginBottom,10);return(height+margin);}
Handlebars.tag=function(tag){return Handlebars.compile(document.getElementById("tpl-"+tag).innerHTML);};Handlebars.registerHelper('isColor',function(color,options){return color!='XXXXXX'?options.fn(this):options.inverse(this);});Handlebars.registerHelper('specialItem',function(premium,selection,options){return premium==1||selection==1?options.fn(this):options.inverse(this);});Handlebars.registerHelper('retinaImage',function(){return this.png.replace("png/128","png/512");});Handlebars.registerHelper('isPersonalIcon',function(premium){return premium==4;});Handlebars.registerHelper('numberFormat',function(num){return num.replace(/\B(?=(\d{3})+(?!\d))/g,",");});Handlebars.registerHelper('isEqualTo',function(v,value,opts){if(v==value)
return opts.fn(this);else
return opts.inverse(this);});function Notifier(){this.warning=function(title,body,sticky){_notify(title,body,sticky,'warning');};this.danger=function(title,body,sticky){_notify(title,body,sticky,'danger');};this.success=function(title,body,sticky){_notify(title,body,sticky,'success');};var timeout=8000;function _notify(title,body,sticky,type){_displayCustomNotification(title,body,sticky,type);}
function _displayCustomNotification(title,body,sticky,type){var time=Date.now();if(title instanceof(Object)){body=title.body;title=title.title;}
var container=document.getElementById("user-alert-container");if(!container){container=document.createElement('div');container.id="user-alert-container";container.className="user-alert-container";document.body.appendChild(container);}
container.insertAdjacentHTML('beforeend',Handlebars.tag('notification')({title:title,body:body,sticky:sticky,type:type,time:time}));if(!sticky){setTimeout(function(){var notification=document.getElementById('notify-'+time);notification.parentElement.removeChild(notification);},timeout);}}}
Notifier.close=function(element){var notification=document.getElementById('notify-'+element.dataset.time);notification.parentElement.removeChild(notification);};var UserAlerts=new Notifier();try{sessionStorage.setItem('test','1');sessionStorage.removeItem('test');}catch(error){UserAlerts.danger("ERROR!","Your browser doesn't support Storage Feature or you are using private browsing. Please use a compatible browser",true);}
function filter_text(str){if(typeof str!='undefined')
{str=str.replace(/^\s+|\s+$|\(\)\'/g,'').toLowerCase();var from="/,:;";var to="aaaaaeeeeeiiiiooooouuuunc-----";for(var i=0,l=from.length;i<l;i++){str=str.replace(new RegExp(from.charAt(i),'g'),to.charAt(i));}
return str.replace(/[^a-z0-9 -]/g,'').replace(/\s+/g,'-').replace(/-+/g,'-');}
return str;}
function slug(str){if(typeof str!='string')return str;str=str.replace(/^\s+|\s+$/g,'').toLowerCase();var from="/_,:;";var to="aaaaaeeeeeiiiiooooouuuunc------";for(var i=0,l=from.length;i<l;i++){str=str.replace(new RegExp(from.charAt(i),'g'),to.charAt(i));}
return str.replace(/[^a-z0-9 -]/g,'').replace(/\s+/g,'-').replace(/-+/g,'-');}
function sanitize_filename(str){var d=new Date();var n=d.getTime();str=str.split('.').join(n);var new_str=slug(str);new_str=new_str.split(n).join('.');return new_str;}
function detectBrowser(){if(navigator.userAgent.indexOf("Chrome")!=-1){return'Chrome';}else if(navigator.userAgent.indexOf("Opera")!=-1){return'Opera';}else if(navigator.userAgent.indexOf("Firefox")!=-1){return'Firefox';}else if((navigator.userAgent.indexOf("MSIE")!=-1)||(!!document.documentMode==true))
{return'IE';}else if(navigator.userAgent.indexOf("Safari")!=-1){return'Safari';}else{return navigator.userAgent;}}
function detectIE10(){if(navigator.appName.indexOf("Internet Explorer")!=-1){return(navigator.appVersion.indexOf("MSIE 1")==-1);}}
var Cookie={get:function(cookie_name){var name=cookie_name+"=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1);if(c.indexOf(name)==0)return c.substring(name.length,c.length);}
return"";},set:function(name,value,days){var domain=window.location.host.replace(/[^.]+\./,'');if(days){var date=new Date();date.setTime(date.getTime()+(days*24*60*60*1000));var expires="; expires="+date.toGMTString();}else var expires="";document.cookie=name+"="+value+expires+"; path=/; domain=."+domain;},setH:function(name,value,hours){var domain=window.location.host.replace(/[^.]+\./,'');if(hours){var date=new Date();date.setTime(date.getTime()+(hours*60*60*1000));var expires="; expires="+date.toGMTString();}else var expires="";document.cookie=name+"="+value+expires+"; path=/; domain=."+domain;},del:function(name){var domain=window.location.host.replace(/[^.]+\./,'')||window.location.host;document.cookie=name+'=; expires=Thu, 01 Jan 1970 00:00:01 GMT; domain=.'+domain;}};function check_url(url,method,fn_ok,fn_error){var m=(method=='get'||method=='post')?method:'get';if(typeof url!='undefined'){$.ajax({type:'HEAD',method:m,url:url,success:function(){fn_ok();},error:function(){register_log('error','Checking url: '+url);fn_error();}});}}
function closeModal(elem){elem.parent(".modal").get('.modal-state').checked=false;}
function register_log(type,text){var url=URL_LOG;if(!type||type=='undefined'&&text.indexOf('undefined')!=-1)return false;if(url)
{$.ajax({url:url,type:'POST',global:false,data:{t:type,o:text,u:window.location.href}});}}
function errorHandler(f){if(arguments.length>1){f.forEach(function(error,item){console.error("%s for item %i",error,item);});}
if(typeof f!=="undefined")console.error(failures);}
function isValidColor(color){return(/((^[0-9A-F]{6}$|XXXXXX))/i.test(color));}
function getTimestamp(date){if(typeof date=='undefined'){return Math.floor(Date.now()/1000);}
if(date instanceof Date){return convertToUTC(date);}else{var now=new Date(date);if(now instanceof Date){return convertToUTC(now);}else{return Math.floor(Date.now()/1000);}}
function convertToUTC(date){var now_utc=new Date(date.getUTCFullYear(),date.getUTCMonth(),date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds());return parseInt(Date.parse(now_utc).toString().slice(0,10),10);}}
var Spinner={show:function(){document.getElementById('loader').style.display='block'},hide:function(){document.getElementById('loader').style.display='none'},};function capitalize(word){if(word!=''&&typeof word=='string')
return word.charAt(0).toUpperCase()+word.slice(1);else
return word;}
function detectPagination(url){var pag=0;var init=url.lastIndexOf('/');var end=url.length;if(url.lastIndexOf('?')!=-1){end=url.lastIndexOf('?');}
if(init!=-1){pag=url.substring(init+1,end);}
return(isNaN(pag)?0:pag);}
function urlWithoutPag(url){var pag=detectPagination(url);var out=null;if(pag!=0){out=url.substring(0,url.lastIndexOf('/'));}else{var qs=window.location.search;if(qs!=''&&url==window.location.href){out=url.substring(0,url.lastIndexOf('?'));}else{out=url;}}
return out;}
function addVarQueryString(url,name,value)
{var out=url;if(url.lastIndexOf('?')==-1)
{out=url+'?'+name+'='+value;}
else
{out=url+'&'+name+'='+value;}
return out;}
function getUrlNavigation(url,pag,query){var nStrip=0;while(url.length>nStrip&&url[url.length-(nStrip+1)]=='/'){nStrip+=1;}
if(nStrip>0){url=url.slice(0,-nStrip);}
if(pag!=''&&typeof pag!=='undefined'&&pag>1){url=url+'/'+pag;}
if(query!=''&&typeof query!=='undefined'){query=cleanQueryString(query);url=url.replace("/\/\/$/","/");url=url.replace("#","");url=(query.lastIndexOf('?')==-1)?url+'?'+query:url+query}
return url;}
function cleanQueryString(query){if(query!=''&&typeof query!=='undefined'){query=query.replace(/pack_id=(\d)*/g,"");query=query.replace("\&\&","\&").replace(/[^=&]+=(&|$)/g,"").replace(/^&|&$/,"");}
return query;}
function setUrlNavigator(url,pag,query){var url_end=getUrlNavigation(url,pag,query);if('history'in window){if(typeof window.history.pushState=='function'){if(url_end.indexOf('undefined')==-1)
ModalDetail.pushState({page:'other'},document.title,url_end);else
ModalDetail.pushState({page:'other'},document.title,APP_URL);}}}
if(typeof parseQueryString!=='function'){function parseQueryString(a){a=a.substr(1).split('&');if(a=="")return{};var b={};for(var i=0;i<a.length;++i){var p=a[i].split('=',2);if(p.length==1)
b[p[0]]="";else
b[p[0]]=decodeURIComponent(p[1].replace(/\+/g," "));}
return b;}}
function createFunctionWithTimeout(callback,opt_timeout){var called=false;var cb=function(){if(!called){called=true;callback();}};setTimeout(cb,opt_timeout||1000);return cb;}
function filterSpecialChars(text)
{return text.replace(/[\*\%\?\-\+\/\\\'\}\{_\:\,;\.<>\&\#\"@\+\=\~]+/g,'');}
function formatTimer(distance,letterSeparator){var _second=1000;var _minute=_second*60;var _hour=_minute*60;var _day=_hour*24;var _secondSeparator=(letterSeparator)?'s':'';var _minuteSeparator=(letterSeparator)?'m ':':';var _hourSeparator=(letterSeparator)?'h ':':';var _daySeparator=(letterSeparator)?'d ':':';var days=Math.floor(distance/_day);var hours=Math.floor((distance%_day)/_hour);var minutes=Math.floor((distance%_hour)/_minute);var seconds=Math.floor((distance%_minute)/_second);var dateString=normalizeTimer(minutes)+_minuteSeparator+normalizeTimer(seconds)+_secondSeparator;if(days>0&&hours>0){dateString=normalizeTimer(days)+_daySeparator+normalizeTimer(hours)+_hourSeparator+dateString;}else{dateString=normalizeTimer(hours)+_hourSeparator+dateString;}
return dateString;}
function normalizeTimer(number){if(number<10){return'0'+number;}
return number;}
function setCountdown(popup,interval,startDate,endDate){var currentDate=new Date();if(currentDate.getTime()>=startDate.getTime()&&currentDate.getTime()<=endDate.getTime()){var popupModalContdown=popup.querySelector('.countdown');if(popupModalContdown){var timeleft=endDate-currentDate;popupModalContdown.innerText=formatTimer(timeleft,false);}}else{$(popup).removeClass('show');clearInterval(interval);}};!(function(_global,undefined){function localStorageDB(db_name,engine){if(!db_name)db_name="0";var db_prefix='fi_',db_id=db_prefix+db_name,db_new=false,db=null;try{var storage=(engine==sessionStorage?sessionStorage:localStorage);}catch(e){var storage=engine;}
db=storage[db_id];if(!(db&&(db=JSON.parse(db))&&db.tables&&db.data)){if(!validateName(db_name)){error("The name '"+db_name+"' contains invalid characters");}else{db={tables:{},data:{}};commit();db_new=true;}}
function drop(){if(storage.hasOwnProperty(db_id)){delete storage[db_id];}
db=null;}
function tableCount(){var count=0;for(var table in db.tables){if(db.tables.hasOwnProperty(table)){count++;}}
return count;}
function showTables(){var list=[];for(var table in db.tables){if(db.tables.hasOwnProperty(table)){list.push(table);}}
return list;}
function tableFields(table_name){return db.tables[table_name].fields;}
function tableExists(table_name){return db.tables[table_name]?true:false;}
function tableExistsWarn(table_name){if(!tableExists(table_name)){error("The table '"+table_name+"' does not exist");}}
function columnExists(table_name,field_name){var exists=false;var table_fields=db.tables[table_name].fields;for(var field in table_fields){if(table_fields[field]==field_name)
{exists=true;break;}}
return exists;}
function createTable(table_name,fields){db.tables[table_name]={fields:fields,auto_increment:1};db.data[table_name]={};}
function dropTable(table_name){delete db.tables[table_name];delete db.data[table_name];}
function truncate(table_name){db.tables[table_name].auto_increment=1;db.data[table_name]={};}
function alterTable(table_name,new_fields,default_values){db.tables[table_name].fields=db.tables[table_name].fields.concat(new_fields);if(typeof default_values!="undefined"){for(var ID in db.data[table_name]){if(!db.data[table_name].hasOwnProperty(ID)){continue;}
for(var field in new_fields){if(typeof default_values=="object"){db.data[table_name][ID][new_fields[field]]=default_values[new_fields[field]];}else{db.data[table_name][ID][new_fields[field]]=default_values;}}}}}
function rowCount(table_name){var count=0;for(var ID in db.data[table_name]){if(db.data[table_name].hasOwnProperty(ID)){count++;}}
return count;}
function insert(table_name,data){var keys=Object.keys(db.data[table_name]);for(var i=1;i<keys.length+1;i++){if(keys[i-1]!=i){data.ID=i;break;}}
if(!data.ID){data.ID=db.tables[table_name].auto_increment;db.tables[table_name].auto_increment++;}
db.data[table_name][data.ID]=data;return data.ID;}
function select(table_name,ids,start,limit,sort,distinct){var ID=null,results=[],row=null;for(var i=0;i<ids.length;i++){ID=ids[i];row=db.data[table_name][ID];results.push(clone(row));}
if(sort&&sort instanceof Array){for(var i=0;i<sort.length;i++){results.sort(sort_results(sort[i][0],sort[i].length>1?sort[i][1]:null));}}
if(distinct&&distinct instanceof Array){for(var j=0;j<distinct.length;j++){var seen={},d=distinct[j];for(var i=0;i<results.length;i++){if(results[i]===undefined){continue;}
if(results[i].hasOwnProperty(d)&&seen.hasOwnProperty(results[i][d])){delete(results[i]);}else{seen[results[i][d]]=1;}}}
var new_results=[];for(var i=0;i<results.length;i++){if(results[i]!==undefined){new_results.push(results[i]);}}
results=new_results;}
start=start&&typeof start==="number"?start:null;limit=limit&&typeof limit==="number"?limit:null;if(start&&limit){results=results.slice(start,start+limit);}else if(start){results=results.slice(start);}else if(limit){results=results.slice(start,limit);}
return results;}
function sort_results(field,order){return function(x,y){var v1=typeof(x[field])==="string"?x[field].toLowerCase():x[field],v2=typeof(y[field])==="string"?y[field].toLowerCase():y[field];if(order==="DESC"){return v1==v2?0:(v1<v2?1:-1);}else{return v1==v2?0:(v1>v2?1:-1);}};}
function queryByValues(table_name,data){var result_ids=[],exists=false,row=null;for(var ID in db.data[table_name]){if(!db.data[table_name].hasOwnProperty(ID)){continue;}
row=db.data[table_name][ID];exists=true;for(var field in data){if(!data.hasOwnProperty(field)){continue;}
if(typeof data[field]=='string'){if(row[field]===null||row[field].toString().toLowerCase()!=data[field].toString().toLowerCase()){exists=false;break;}}else{if(row[field]!=data[field]){exists=false;break;}}}
if(exists){result_ids.push(ID);}}
return result_ids;}
function queryByFunction(table_name,query_function){var result_ids=[],exists=false,row=null;for(var ID in db.data[table_name]){if(!db.data[table_name].hasOwnProperty(ID)){continue;}
row=db.data[table_name][ID];if(query_function(clone(row))==true){result_ids.push(ID);}}
return result_ids;}
function getDB(){return db;}
function getIDs(table_name){var result_ids=[];for(var ID in db.data[table_name]){if(db.data[table_name].hasOwnProperty(ID)){result_ids.push(ID);}}
return result_ids;}
function deleteRows(table_name,ids){for(var i=0;i<ids.length;i++){if(db.data[table_name].hasOwnProperty(ids[i])){delete db.data[table_name][ids[i]];}}
return ids.length;}
function update(table_name,ids,update_function){var ID='',num=0;for(var i=0;i<ids.length;i++){ID=ids[i];var updated_data=update_function(clone(db.data[table_name][ID]));if(updated_data){delete updated_data['ID'];var new_data=db.data[table_name][ID];for(var field in updated_data){if(updated_data.hasOwnProperty(field)){new_data[field]=updated_data[field];}}
db.data[table_name][ID]=validFields(table_name,new_data);num++;}}
return num;}
function commit(){try{storage.setItem(db_id,JSON.stringify(db));return true;}catch(e){return false;}}
function serialize(){return JSON.stringify(db);}
function error(msg){throw new Error(msg);}
function clone(obj){var new_obj={};for(var key in obj){if(obj.hasOwnProperty(key)){new_obj[key]=obj[key];}}
return new_obj;}
function validateName(name){return name.toString().match(/[^a-z_0-9]/ig)?false:true;}
function validFields(table_name,data){var field='',new_data={};for(var i=0;i<db.tables[table_name].fields.length;i++){field=db.tables[table_name].fields[i];if(data[field]!==undefined){new_data[field]=data[field];}}
return new_data;}
function validateData(table_name,data){var field='',new_data={};for(var i=0;i<db.tables[table_name].fields.length;i++){field=db.tables[table_name].fields[i];new_data[field]=(data[field]===null||data[field]===undefined)?null:data[field];}
return new_data;}
function renameTable(old_table,new_table){if(old_table==new_table){throw"Same table name choosen";}
if(!db.data.hasOwnProperty(old_table)&&!db.tables.hasOwnProperty(old_table)){throw"The table doesn't exists on database";}
if(db.data.hasOwnProperty(new_table)||db.tables.hasOwnProperty(new_table)){throw"New table name already exists on database";}
db.data[new_table]=db.data[old_table];db.tables[new_table]=db.tables[old_table];delete db.data[old_table];delete db.tables[old_table];storage.setItem(db_id,JSON.stringify(db));return true;}
return{commit:function(){return commit();},isNew:function(){return db_new;},drop:function(){drop();},renameTable:function(old_table,new_table){return renameTable(old_table,new_table);},getDB:function(){return getDB();},serialize:function(){return serialize();},tableExists:function(table_name){return tableExists(table_name);},tableFields:function(table_name){return tableFields(table_name);},tableCount:function(){return tableCount();},showTables:function(){return showTables();},columnExists:function(table_name,field_name){return columnExists(table_name,field_name);},createTable:function(table_name,fields){if(!table_name)table_name=0;var result=false;if(!validateName(table_name)){error("The database name '"+table_name+"' contains invalid characters.");}else if(this.tableExists(table_name)){error("The table name '"+table_name+"' already exists.");}else{var is_valid=true;for(var i=0;i<fields.length;i++){if(!validateName(fields[i])){is_valid=false;break;}}
if(is_valid){var fields_literal={};for(var i=0;i<fields.length;i++){fields_literal[fields[i]]=true;}
delete fields_literal['ID'];fields=['ID'];for(var field in fields_literal){if(fields_literal.hasOwnProperty(field)){fields.push(field);}}
createTable(table_name,fields);result=true;}else{error("One or more field names in the table definition contains invalid characters");}}
return result;},createTableWithData:function(table_name,data){if(typeof data!=='object'||!data.length||data.length<1){error("Data supplied isn't in object form. Example: [{k:v,k:v},{k:v,k:v} ..]");}
var fields=Object.keys(data[0]);if(this.createTable(table_name,fields)){this.commit();for(var i=0;i<data.length;i++){if(!insert(table_name,data[i])){error("Failed to insert record: ["+JSON.stringify(data[i])+"]");}}
this.commit();}
return true;},dropTable:function(table_name){tableExistsWarn(table_name);dropTable(table_name);commit();},truncate:function(table_name){tableExistsWarn(table_name);truncate(table_name);commit();},alterTable:function(table_name,new_fields,default_values){var result=false;if(!validateName(table_name)){error("The database name '"+table_name+"' contains invalid characters");}else{if(typeof new_fields=="object"){var is_valid=true;for(var i=0;i<new_fields.length;i++){if(!validateName(new_fields[i])){is_valid=false;break;}}
if(is_valid){var fields_literal={};for(var i=0;i<new_fields.length;i++){fields_literal[new_fields[i]]=true;}
delete fields_literal['ID'];new_fields=[];for(var field in fields_literal){if(fields_literal.hasOwnProperty(field)){new_fields.push(field);}}
alterTable(table_name,new_fields,default_values);result=true;}else{error("One or more field names in the table definition contains invalid characters");}}else if(typeof new_fields=="string"){if(validateName(new_fields)){var new_fields_array=[];new_fields_array.push(new_fields);alterTable(table_name,new_fields_array,default_values);result=true;}else{error("One or more field names in the table definition contains invalid characters");}}}
return result;},rowCount:function(table_name){tableExistsWarn(table_name);return rowCount(table_name);},insert:function(table_name,data){tableExistsWarn(table_name);return insert(table_name,validateData(table_name,data));},insertOrUpdate:function(table_name,query,data){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query));}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query);}
if(result_ids.length==0){return insert(table_name,validateData(table_name,data));}else{var ids=[];for(var n=0;n<result_ids.length;n++){update(table_name,result_ids,function(o){ids.push(o.ID);return data;});}
return ids;}},update:function(table_name,query,update_function){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query));}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query);}
return update(table_name,result_ids,update_function);},query:function(table_name,query,limit,start,sort,distinct){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name,limit,start);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query),limit,start);}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query,limit,start);}
return select(table_name,result_ids,start,limit,sort,distinct);},queryAll:function(table_name,params){if(!params){return this.query(table_name)}else{return this.query(table_name,params.hasOwnProperty('query')?params.query:null,params.hasOwnProperty('limit')?params.limit:null,params.hasOwnProperty('start')?params.start:null,params.hasOwnProperty('sort')?params.sort:null,params.hasOwnProperty('distinct')?params.distinct:null);}},deleteRows:function(table_name,query){tableExistsWarn(table_name);var result_ids=[];if(!query){result_ids=getIDs(table_name);}else if(typeof query=='object'){result_ids=queryByValues(table_name,validFields(table_name,query));}else if(typeof query=='function'){result_ids=queryByFunction(table_name,query);}
return deleteRows(table_name,result_ids);}}}
if(typeof define==='function'&&define.amd){define(function(){return localStorageDB;});}else{_global['localStorageDB']=localStorageDB;}}(window));;$(function(){document.getElementById("logout_link").href='javascript:Auth.logout()';});function logged_in_callback(data){if(typeof Collection=='function')Collection.init();if(typeof ga_logged_in_callback=='function'){ga_logged_in_callback(data);}
if(data.status){localStorage.fi_user=JSON.stringify(data);}
else
{var down_pack=document.querySelector(".btn-download-pack");if(down_pack)
{down_pack.disabled=true;down_pack.removeAttribute("data-pack");}}
clearTimeout(window.gr.auth.timeout);gr.auth.me.id=~~gr.auth.me.id;gr.auth.me.premium=~~gr.auth.me.premium;if(gr.auth.me.premium)
{var btn=document.getElementById("gr_user_menu_avatar");if(btn)
{btn.insertAdjacentHTML("afterbegin",'<i class="premium flaticon-premium" title="Premium user"></i>');}
$('.dropdown-upgrade').hide();var btn_premium=document.querySelector(".join-premium-button");if(btn_premium)
{btn_premium.style.display='none';}
var btn_text=document.querySelector(".join-premium-text");if(btn_text)
{btn_text.style.display='block';}
var pattern_btn=document.querySelector(".btn-pattern");if(pattern_btn)
{pattern_btn.removeAttribute("disabled");pattern_btn.classList.remove("disabled");}
if(typeof cc_will_expire=='function'){cc_will_expire(data.cc_will_expire);}}
for(var key in gr.auth.me)
{if(gr.auth.me.hasOwnProperty(key))
{if(!Object.defineProperty instanceof(Function))
{return false;}
Object.defineProperty(gr.auth.me,key,{value:gr.auth.me[key],writable:false,configurable:false,enumerable:false});}}
if(typeof update_download_counter=='function'){update_download_counter(1);}}
function cc_will_expire(expire)
{if(expire)
{var msg1=(typeof messages.common.cc_exp_title=='string')?messages.common.cc_exp_title:'Attention!';var msg2=(typeof messages.common.cc_exp_desc=='string')?messages.common.cc_exp_desc:'Your credit card is about to expire, please update your credit card and continue with your premium plan';if(typeof UserAlerts!='undefined'){UserAlerts.warning(msg1,msg2,true);}}}
var Auth={error:function(data){localStorage.removeItem('fi_user');if(typeof UserAlerts!='undefined'){UserAlerts.warning(data.title,data.body);}
setTimeout(gr.auth.logout,3000);},logout:function(){localStorage.removeItem('fi_user');gr.auth.logout();}}
gr.auth.timeout=setTimeout(function(){var msg=(typeof messages.errors.connectivity=='string')?messages.errors.connectivity:'Error to connect Flaticon servers.';if(typeof UserAlerts!='undefined'){UserAlerts.danger('Oopps!',msg);}
if(typeof Collection=='function')Collection.init();},5000);
;!function(t){var e=function(){var e='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"><div class="colpick_selector_inner"></div></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_new_color"></div><div class="colpick_current_color"></div><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_submit"></div></div>',a={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:!0,flat:!1,layout:"full",submit:1,submitText:"OK",height:156},l=function(e,a){var i=c(e);t(a).data("colpick").fields.eq(1).val(i.r).end().eq(2).val(i.g).end().eq(3).val(i.b).end()},r=function(e,a){t(a).data("colpick").fields.eq(4).val(Math.round(e.h)).end().eq(5).val(Math.round(e.s)).end().eq(6).val(Math.round(e.b)).end()},n=function(e,a){t(a).data("colpick").fields.eq(0).val(d(e).toUpperCase())},s=function(e,a){t(a).data("colpick").selector.css("backgroundColor","#"+d({h:e.h,s:100,b:100})),t(a).data("colpick").selectorIndic.css({left:parseInt(t(a).data("colpick").height*e.s/100,10),top:parseInt(t(a).data("colpick").height*(100-e.b)/100,10)})},p=function(e,a){t(a).data("colpick").hue.css("top",parseInt(t(a).data("colpick").height-t(a).data("colpick").height*e.h/360,10))},h=function(e,a){t(a).data("colpick").currentColor.css("backgroundColor","#"+d(e))},u=function(e,a){t(a).data("colpick").newColor.css("backgroundColor","#"+d(e))},f=function(e){var a,h=t(this).parent().parent();this.parentNode.className.indexOf("_hex")>0?(h.data("colpick").color=a=i(L(this.value)),l(a,h.get(0)),r(a,h.get(0))):this.parentNode.className.indexOf("_hsb")>0?(h.data("colpick").color=a=X({h:parseInt(h.data("colpick").fields.eq(4).val(),10),s:parseInt(h.data("colpick").fields.eq(5).val(),10),b:parseInt(h.data("colpick").fields.eq(6).val(),10)}),l(a,h.get(0)),n(a,h.get(0))):(h.data("colpick").color=a=o(E({r:parseInt(h.data("colpick").fields.eq(1).val(),10),g:parseInt(h.data("colpick").fields.eq(2).val(),10),b:parseInt(h.data("colpick").fields.eq(3).val(),10)})),n(a,h.get(0)),r(a,h.get(0))),s(a,h.get(0)),p(a,h.get(0)),u(a,h.get(0)),h.data("colpick").onChange.apply(h.parent(),[a,d(a),c(a),h.data("colpick").el,0])},v=function(e){t(this).parent().removeClass("colpick_focus")},g=function(){t(this).parent().parent().data("colpick").fields.parent().removeClass("colpick_focus"),t(this).parent().addClass("colpick_focus")},k=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var a=t(this).parent().find("input").focus(),i={el:t(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:e.pageY,field:a,val:parseInt(a.val(),10),preview:t(this).parent().parent().data("colpick").livePreview};t(document).mouseup(i,m),t(document).mousemove(i,_)},_=function(t){return t.data.field.val(Math.max(0,Math.min(t.data.max,parseInt(t.data.val-t.pageY+t.data.y,10)))),t.data.preview&&f.apply(t.data.field.get(0),[!0]),!1},m=function(e){return f.apply(e.data.field.get(0),[!0]),e.data.el.removeClass("colpick_slider").find("input").focus(),t(document).off("mouseup",m),t(document).off("mousemove",_),!1},b=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var a={cal:t(this).parent(),y:t(this).offset().top};t(document).on("mouseup touchend",a,y),t(document).on("mousemove touchmove",a,x);var i="touchstart"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;return f.apply(a.cal.data("colpick").fields.eq(4).val(parseInt(360*(a.cal.data("colpick").height-(i-a.y))/a.cal.data("colpick").height,10)).get(0),[a.cal.data("colpick").livePreview]),!1},x=function(t){var e="touchmove"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;return f.apply(t.data.cal.data("colpick").fields.eq(4).val(parseInt(360*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.y)))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},y=function(e){return l(e.data.cal.data("colpick").color,e.data.cal.get(0)),n(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",y),t(document).off("mousemove touchmove",x),!1},w=function(e){e.preventDefault?e.preventDefault():e.returnValue=!1;var a={cal:t(this).parent(),pos:t(this).offset()};a.preview=a.cal.data("colpick").livePreview,t(document).on("mouseup touchend",a,M),t(document).on("mousemove touchmove",a,C);var i;return"touchstart"==e.type?(pageX=e.originalEvent.changedTouches[0].pageX,i=e.originalEvent.changedTouches[0].pageY):(pageX=e.pageX,i=e.pageY),f.apply(a.cal.data("colpick").fields.eq(6).val(parseInt(100*(a.cal.data("colpick").height-(i-a.pos.top))/a.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*(pageX-a.pos.left)/a.cal.data("colpick").height,10)).get(0),[a.preview]),!1},C=function(t){var e;return"touchmove"==t.type?(pageX=t.originalEvent.changedTouches[0].pageX,e=t.originalEvent.changedTouches[0].pageY):(pageX=t.pageX,e=t.pageY),f.apply(t.data.cal.data("colpick").fields.eq(6).val(parseInt(100*(t.data.cal.data("colpick").height-Math.max(0,Math.min(t.data.cal.data("colpick").height,e-t.data.pos.top)))/t.data.cal.data("colpick").height,10)).end().eq(5).val(parseInt(100*Math.max(0,Math.min(t.data.cal.data("colpick").height,pageX-t.data.pos.left))/t.data.cal.data("colpick").height,10)).get(0),[t.data.preview]),!1},M=function(e){return l(e.data.cal.data("colpick").color,e.data.cal.get(0)),n(e.data.cal.data("colpick").color,e.data.cal.get(0)),t(document).off("mouseup touchend",M),t(document).off("mousemove touchmove",C),!1},I=function(e){var a=t(this).parent(),i=a.data("colpick").color;a.data("colpick").origColor=i,h(i,a.get(0)),a.data("colpick").onSubmit(i,d(i),c(i),a.data("colpick").el)},T=function(e){e.stopPropagation();var a=t("#"+t(this).data("colpickId"));a.data("colpick").onBeforeShow.apply(this,[a.get(0)]);var i=t(this).offset(),o=i.top+this.offsetHeight,c=i.left,l=S(),d=a.width();c+d>l.l+l.w&&(c-=d),a.css({left:c+"px",top:o+"px"}),0!=a.data("colpick").onShow.apply(this,[a.get(0)])&&a.show(),t("html").mousedown({cal:a},q),a.mousedown(function(t){t.stopPropagation()})},q=function(e){0!=e.data.cal.data("colpick").onHide.apply(this,[e.data.cal.get(0)])&&e.data.cal.hide(),t("html").off("mousedown",q)},S=function(){var t="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(t?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(t?document.documentElement.clientWidth:document.body.clientWidth)}},X=function(t){return{h:Math.min(360,Math.max(0,t.h)),s:Math.min(100,Math.max(0,t.s)),b:Math.min(100,Math.max(0,t.b))}},E=function(t){return{r:Math.min(255,Math.max(0,t.r)),g:Math.min(255,Math.max(0,t.g)),b:Math.min(255,Math.max(0,t.b))}},L=function(t){var e=6-t.length;if(e>0){for(var a=[],i=0;e>i;i++)a.push("0");a.push(t),t=a.join("")}return t.toUpperCase()},P=function(){var e=t(this).parent(),a=e.data("colpick").origColor;e.data("colpick").color=a,l(a,e.get(0)),n(a,e.get(0)),r(a,e.get(0)),s(a,e.get(0)),p(a,e.get(0)),u(a,e.get(0))};return{init:function(c){if(c=t.extend({},a,c||{}),"string"==typeof c.color)c.color=i(c.color);else if(void 0!=c.color.r&&void 0!=c.color.g&&void 0!=c.color.b)c.color=o(c.color);else{if(void 0==c.color.h||void 0==c.color.s||void 0==c.color.b)return this;c.color=X(c.color)}return this.each(function(){if(!t(this).data("colpickId")){var a=t.extend({},c);a.origColor=c.color;var i="collorpicker_"+parseInt(1e3*Math.random());t(this).data("colpickId",i);var o=t(e).attr("id",i);o.addClass("colpick_"+a.layout+(a.submit?"":" colpick_"+a.layout+"_ns")),"light"!=a.colorScheme&&o.addClass("colpick_"+a.colorScheme),o.find("div.colpick_submit").html(a.submitText).click(I),a.fields=o.find("input").change(f).blur(v).focus(g),o.find("div.colpick_field_arrs").mousedown(k).end().find("div.colpick_current_color").click(P),a.selector=o.find("div.colpick_color").on("mousedown touchstart",w),a.selectorIndic=a.selector.find("div.colpick_selector_outer"),a.el=this,a.hue=o.find("div.colpick_hue_arrs"),huebar=a.hue.parent();var d=navigator.userAgent.toLowerCase(),_="Microsoft Internet Explorer"===navigator.appName,m=_?parseFloat(d.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0,x=_&&10>m,y=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(x){var C,M;for(C=0;11>=C;C++)M=t("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+y[C]+", endColorstr="+y[C+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+y[C]+", endColorstr="+y[C+1]+')";'),huebar.append(M)}else stopList=y.join(","),huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ");o.find("div.colpick_hue").on("mousedown touchstart",b),a.newColor=o.find("div.colpick_new_color"),a.currentColor=o.find("div.colpick_current_color"),o.data("colpick",a),l(a.color,o.get(0)),r(a.color,o.get(0)),n(a.color,o.get(0)),p(a.color,o.get(0)),s(a.color,o.get(0)),h(a.color,o.get(0)),u(a.color,o.get(0)),a.flat?(o.appendTo(this).show(),o.css({position:"relative",display:"block"})):(o.appendTo(document.body),t(this).on(a.showEvent,T),o.css({position:"absolute"}))}})},showPicker:function(){return this.each(function(){t(this).data("colpickId")&&T.apply(this)})},hidePicker:function(){return this.each(function(){t(this).data("colpickId")&&t("#"+t(this).data("colpickId")).hide()})},setColor:function(e,a){if(a="undefined"==typeof a?1:a,"string"==typeof e)e=i(e);else if(void 0!=e.r&&void 0!=e.g&&void 0!=e.b)e=o(e);else{if(void 0==e.h||void 0==e.s||void 0==e.b)return this;e=X(e)}return this.each(function(){if(t(this).data("colpickId")){var i=t("#"+t(this).data("colpickId"));i.data("colpick").color=e,i.data("colpick").origColor=e,l(e,i.get(0)),r(e,i.get(0)),n(e,i.get(0)),p(e,i.get(0)),s(e,i.get(0)),u(e,i.get(0)),i.data("colpick").onChange.apply(i.parent(),[e,d(e),c(e),i.data("colpick").el,1]),a&&h(e,i.get(0))}})}}}(),a=function(t){var t=parseInt(t.indexOf("#")>-1?t.substring(1):t,16);return{r:t>>16,g:(65280&t)>>8,b:255&t}},i=function(t){return o(a(t))},o=function(t){var e={h:0,s:0,b:0},a=Math.min(t.r,t.g,t.b),i=Math.max(t.r,t.g,t.b),o=i-a;return e.b=i,e.s=0!=i?255*o/i:0,0!=e.s?t.r==i?e.h=(t.g-t.b)/o:t.g==i?e.h=2+(t.b-t.r)/o:e.h=4+(t.r-t.g)/o:e.h=-1,e.h*=60,e.h<0&&(e.h+=360),e.s*=100/255,e.b*=100/255,e},c=function(t){var e={},a=t.h,i=255*t.s/100,o=255*t.b/100;if(0==i)e.r=e.g=e.b=o;else{var c=o,l=(255-i)*o/255,d=(c-l)*(a%60)/60;360==a&&(a=0),60>a?(e.r=c,e.b=l,e.g=l+d):120>a?(e.g=c,e.b=l,e.r=c-d):180>a?(e.g=c,e.r=l,e.b=l+d):240>a?(e.b=c,e.r=l,e.g=c-d):300>a?(e.b=c,e.g=l,e.r=l+d):360>a?(e.r=c,e.g=l,e.b=c-d):(e.r=0,e.g=0,e.b=0)}return{r:Math.round(e.r),g:Math.round(e.g),b:Math.round(e.b)}},l=function(e){var a=[e.r.toString(16),e.g.toString(16),e.b.toString(16)];return t.each(a,function(t,e){1==e.length&&(a[t]="0"+e)}),a.join("")},d=function(t){return l(c(t))};t.fn.extend({colpick:e.init,colpickHide:e.hidePicker,colpickShow:e.showPicker,colpickSetColor:e.setColor}),t.extend({colpick:{rgbToHex:l,rgbToHsb:o,hsbToHex:d,hsbToRgb:c,hexToHsb:i,hexToRgb:a}})}(jQuery);
;(function(s,t,u){var v=(s.SVGAngle||t.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#BasicStructure","1.1")?"SVG":"VML"),picker,slide,hueOffset=15,svgNS='http://www.w3.org/2000/svg';var w=['<div class="picker-wrapper">','<div class="picker"></div>','<div class="picker-indicator"></div>','</div>','<div class="slide-wrapper">','<div class="slide"></div>','<div class="slide-indicator"></div>','</div>'].join('');function mousePosition(a){if(s.event&&s.event.contentOverflow!==u){return{x:s.event.offsetX,y:s.event.offsetY}}if(a.offsetX!==u&&a.offsetY!==u){return{x:a.offsetX,y:a.offsetY}}var b=a.target.parentNode.parentNode;return{x:a.layerX-b.offsetLeft,y:a.layerY-b.offsetTop}}function $(a,b,c){a=t.createElementNS(svgNS,a);for(var d in b)a.setAttribute(d,b[d]);if(Object.prototype.toString.call(c)!='[object Array]')c=[c];var i=0,len=(c[0]&&c.length)||0;for(;i<len;i++)a.appendChild(c[i]);return a}if(v=='SVG'){slide=$('svg',{xmlns:'http://www.w3.org/2000/svg',version:'1.1',width:'100%',height:'100%'},[$('defs',{},$('linearGradient',{id:'gradient-hsv',x1:'0%',y1:'100%',x2:'0%',y2:'0%'},[$('stop',{offset:'0%','stop-color':'#FF0000','stop-opacity':'1'}),$('stop',{offset:'13%','stop-color':'#FF00FF','stop-opacity':'1'}),$('stop',{offset:'25%','stop-color':'#8000FF','stop-opacity':'1'}),$('stop',{offset:'38%','stop-color':'#0040FF','stop-opacity':'1'}),$('stop',{offset:'50%','stop-color':'#00FFFF','stop-opacity':'1'}),$('stop',{offset:'63%','stop-color':'#00FF40','stop-opacity':'1'}),$('stop',{offset:'75%','stop-color':'#0BED00','stop-opacity':'1'}),$('stop',{offset:'88%','stop-color':'#FFFF00','stop-opacity':'1'}),$('stop',{offset:'100%','stop-color':'#FF0000','stop-opacity':'1'})])),$('rect',{x:'0',y:'0',width:'100%',height:'100%',fill:'url(#gradient-hsv)'})]);picker=$('svg',{xmlns:'http://www.w3.org/2000/svg',version:'1.1',width:'100%',height:'100%'},[$('defs',{},[$('linearGradient',{id:'gradient-black',x1:'0%',y1:'100%',x2:'0%',y2:'0%'},[$('stop',{offset:'0%','stop-color':'#000000','stop-opacity':'1'}),$('stop',{offset:'100%','stop-color':'#CC9A81','stop-opacity':'0'})]),$('linearGradient',{id:'gradient-white',x1:'0%',y1:'100%',x2:'100%',y2:'100%'},[$('stop',{offset:'0%','stop-color':'#FFFFFF','stop-opacity':'1'}),$('stop',{offset:'100%','stop-color':'#CC9A81','stop-opacity':'0'})])]),$('rect',{x:'0',y:'0',width:'100%',height:'100%',fill:'url(#gradient-white)'}),$('rect',{x:'0',y:'0',width:'100%',height:'100%',fill:'url(#gradient-black)'})])}else if(v=='VML'){slide=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; top: 0; left: 0; width: 100%; height: 100%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="red" color2="red" colors="8519f fuchsia;.25 #8000ff;24903f #0040ff;.5 aqua;41287f #00ff40;.75 #0bed00;57671f yellow"></v:fill>','</v:rect>','</DIV>'].join('');picker=['<DIV style="position: relative; width: 100%; height: 100%">','<v:rect style="position: absolute; left: -1px; top: -1px; width: 101%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="270" color="#FFFFFF" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>','</v:rect>','<v:rect style="position: absolute; left: 0px; top: 0px; width: 100%; height: 101%" stroked="f" filled="t">','<v:fill type="gradient" method="none" angle="0" color="#000000" opacity="100%" color2="#CC9A81" o:opacity2="0%"></v:fill>','</v:rect>','</DIV>'].join('');if(!t.namespaces['v'])t.namespaces.add('v','urn:schemas-microsoft-com:vml','#default#VML')}function hsv2rgb(a){var R,G,B,X,C;var h=(a.h%360)/60;C=a.v*a.s;X=C*(1-Math.abs(h%2-1));R=G=B=a.v-C;h=~~h;R+=[C,X,0,0,X,C][h];G+=[X,C,C,X,0,0][h];B+=[0,0,X,C,C,X][h];var r=Math.floor(R*255);var g=Math.floor(G*255);var b=Math.floor(B*255);return{r:r,g:g,b:b,hex:"#"+(16777216|b|(g<<8)|(r<<16)).toString(16).slice(1)}}function rgb2hsv(a){var r=a.r;var g=a.g;var b=a.b;if(a.r>1||a.g>1||a.b>1){r/=255;g/=255;b/=255}var H,S,V,C;V=Math.max(r,g,b);C=V-Math.min(r,g,b);H=(C==0?null:V==r?(g-b)/C+(g<b?6:0):V==g?(b-r)/C+2:(r-g)/C+4);H=(H%6)*60;S=C==0?0:C/V;return{h:H,s:S,v:V}}function slideListener(d,e,f){return function(a){a=a||s.event;var b=mousePosition(a);d.h=b.y/e.offsetHeight*360+hueOffset;d.s=d.v=1;var c=hsv2rgb({h:d.h,s:1,v:1});f.style.backgroundColor=c.hex;d.callback&&d.callback(c.hex,{h:d.h-hueOffset,s:d.s,v:d.v},{r:c.r,g:c.g,b:c.b},u,b)}};function pickerListener(d,e){return function(a){a=a||s.event;var b=mousePosition(a),width=e.offsetWidth,height=e.offsetHeight;d.s=b.x/width;d.v=(height-b.y)/height;var c=hsv2rgb(d);d.callback&&d.callback(c.hex,{h:d.h-hueOffset,s:d.s,v:d.v},{r:c.r,g:c.g,b:c.b},b)}};var x=0;function ColorPicker(f,g,h){if(!(this instanceof ColorPicker))return new ColorPicker(f,g,h);this.h=0;this.s=1;this.v=1;if(!h){var i=f;i.innerHTML=w;this.slideElement=i.getElementsByClassName('slide')[0];this.pickerElement=i.getElementsByClassName('picker')[0];var j=i.getElementsByClassName('slide-indicator')[0];var k=i.getElementsByClassName('picker-indicator')[0];ColorPicker.fixIndicators(j,k);this.callback=function(a,b,c,d,e){ColorPicker.positionIndicators(j,k,e,d);g(a,b,c)}}else{this.callback=h;this.pickerElement=g;this.slideElement=f}if(v=='SVG'){var l=slide.cloneNode(true);var m=picker.cloneNode(true);var n=l.getElementsByTagName('linearGradient')[0];var o=l.getElementsByTagName('rect')[0];n.id='gradient-hsv-'+x;o.setAttribute('fill','url(#'+n.id+')');var p=[m.getElementsByTagName('linearGradient')[0],m.getElementsByTagName('linearGradient')[1]];var q=m.getElementsByTagName('rect');p[0].id='gradient-black-'+x;p[1].id='gradient-white-'+x;q[0].setAttribute('fill','url(#'+p[1].id+')');q[1].setAttribute('fill','url(#'+p[0].id+')');this.slideElement.appendChild(l);this.pickerElement.appendChild(m);x++}else{this.slideElement.innerHTML=slide;this.pickerElement.innerHTML=picker}addEventListener(this.slideElement,'click',slideListener(this,this.slideElement,this.pickerElement));addEventListener(this.pickerElement,'click',pickerListener(this,this.pickerElement));enableDragging(this,this.slideElement,slideListener(this,this.slideElement,this.pickerElement));enableDragging(this,this.pickerElement,pickerListener(this,this.pickerElement))};function addEventListener(a,b,c){if(a.attachEvent){a.attachEvent('on'+b,c)}else if(a.addEventListener){a.addEventListener(b,c,false)}}function enableDragging(b,c,d){var e=false;addEventListener(c,'mousedown',function(a){e=true});addEventListener(c,'mouseup',function(a){e=false});addEventListener(c,'mouseout',function(a){e=false});addEventListener(c,'mousemove',function(a){if(e){d(a)}})}ColorPicker.hsv2rgb=function(a){var b=hsv2rgb(a);delete b.hex;return b};ColorPicker.hsv2hex=function(a){return hsv2rgb(a).hex};ColorPicker.rgb2hsv=rgb2hsv;ColorPicker.rgb2hex=function(a){return hsv2rgb(rgb2hsv(a)).hex};ColorPicker.hex2hsv=function(a){return rgb2hsv(ColorPicker.hex2rgb(a))};ColorPicker.hex2rgb=function(a){return{r:parseInt(a.substr(1,2),16),g:parseInt(a.substr(3,2),16),b:parseInt(a.substr(5,2),16)}};function setColor(a,b,d,e){a.h=b.h%360;a.s=b.s;a.v=b.v;var c=hsv2rgb(a);var f={y:(a.h*a.slideElement.offsetHeight)/360,x:0};var g=a.pickerElement.offsetHeight;var h={x:a.s*a.pickerElement.offsetWidth,y:g-a.v*g};a.pickerElement.style.backgroundColor=hsv2rgb({h:a.h,s:1,v:1}).hex;a.callback&&a.callback(e||c.hex,{h:a.h,s:a.s,v:a.v},d||{r:c.r,g:c.g,b:c.b},h,f);return a};ColorPicker.prototype.setHsv=function(a){return setColor(this,a)};ColorPicker.prototype.setRgb=function(a){return setColor(this,rgb2hsv(a),a)};ColorPicker.prototype.setHex=function(a){return setColor(this,ColorPicker.hex2hsv(a),u,a)};ColorPicker.positionIndicators=function(a,b,c,d){if(c){b.style.left='auto';b.style.right='0px';b.style.top='0px';a.style.top=(c.y-a.offsetHeight/2)+'px'}if(d){b.style.top=(d.y-b.offsetHeight/2)+'px';b.style.left=(d.x-b.offsetWidth/2)+'px'}};ColorPicker.fixIndicators=function(a,b){b.style.pointerEvents='none';a.style.pointerEvents='none'};s.ColorPicker=ColorPicker})(window,window.document);

;$(function(){var collection_tour=new Tour();if(location.pathname!="/"){collection_tour.show();}
$('#collections-tour .nav-prev').on('click',function(){if(!$('#collections-tour .slider li:first-child').hasClass('active')){$('#collections-tour .slider li.active').removeClass('active').prev().addClass('active');$('#collections-tour .nav li.active').removeClass('active').prev().addClass('active');}});$('#collections-tour .nav-next').on('click',function(){if(!$('#collections-tour .slider li:last-child').hasClass('active')){$('#collections-tour .slider li.active').removeClass('active').next().addClass('active');$('#collections-tour .nav li.active').removeClass('active').next().addClass('active');}});$('#collections-tour .nav li').on('click',function(){var pos=$('#collections-tour .nav li').index(this)+1;$('#collections-tour .nav li, #collections-tour .slider li').removeClass('active');this.addClass('active');$('#collections-tour .slider li:nth-child('+pos+')').addClass('active');});$('#collections-tour .close-tour').on('click',function(){collection_tour.close();});$(document).on("click",".open_tour",function(e){e.preventDefault();collection_tour.open();});});function Tour(){var idTour='collections-tour';var idCollections='collections';var self=this;this.open=function(){if(!document.getElementById(idCollections).classList.contains('visible')){document.getElementById(idCollections).classList.add('visible');}
document.getElementById("viewport").classList.add('collections-visible');document.getElementById(idTour).classList.add('active');};this.close=function(){document.getElementById(idTour).classList.remove('active');};this.show=function(force){if(!force&&localStorage.tour_viewed)return false;if(~~localStorage.n_pageviews>4)
{self.open();localStorage.tour_viewed=true;}};};var db;$(function(){$(".edit-icon-content").click(function(e){e.stopPropagation();});$(".edit-icon-wrapper .close-button").click(function(e){e.stopPropagation();Widget._openEditModal(false,false);});$(document).on("click",".btn-edit-icon",function(){var data={id:document.querySelector("#download-form #icon_id").value,name:document.querySelector("#download-form #keyword").value,color:document.querySelector("#download-form #colored").value,premium:document.querySelector("#download-form #premium").value};Widget._openEditModal(true,data,true);});$(document).on("click",".context_btn-edit-icon",function(e){e.preventDefault();var element=this.parents('.icon')[0];console.log('CLICK EDIT -> ',element);var data={id:element.dataset.id,name:element.dataset.name,color:element.dataset.color,premium:element.dataset.premium}
console.log('===> EDIT -> ',data);if(this.classList.contains('collection-context')){Widget._openEditModal(true,data);}else{Widget._openEditModal(true,data,false,true);}});$(document).on("click",'.only_registered .close-alert',function(){Widget.reset_widget();});$('.edit-icon-content .right > header button').on('click',Widget._toggleEditPanel);$('.edit-icon-content .left #download_button').on('click',function(){Widget._toggleEditPanel(true);});$(".collection").on("change",".collection_icons_list li .edit input",function(e){var checkbox=$('.collection[data-order="0"] .collection-content.color-mode .icons li .edit label input:checked')
$('#edit-color').toggleClass("show",checkbox.length>0);});$(".collections").on("change",".collection_icons_list li .edit input",function(e){var checkbox=$('.collection[data-order="0"] .collection-content.edit-mode:not(.color-mode) .icons li .edit label input:checked');var icon=this.parent(".icon");var bookmark_id=Collection.getActive().bookmark_id;var data=db.queryAll(bookmark_id,{query:{id:icon.dataset.id}});Widget._openEditModal(checkbox.length>0,data[0]);$(document).on("click",".collection_color_button",Widget.createCollectionCPicker);});$(document).on("click",".edit-icon-content .right header button",function(){Widget._openEditModal(false,false);$('#edit-color').removeClass("show");$('.collection[data-order="0"] .collection_icons_list .icon .edit input[type=checkbox]:checked').prop("checked",false);});window.addEventListener("dragstart",function(e){e=e||event;},false);window.addEventListener("dragenter",function(e){e=e||event;e.preventDefault()},false);window.addEventListener("dragleave",function(e){e=e||event;e.preventDefault()},false);window.addEventListener("dragover",function(e){e=e||event;e.preventDefault()},false);window.addEventListener("dragend",function(e){e=e||event;e.preventDefault()},false);window.addEventListener("drop",function(e){e=e||event;e.preventDefault()},false);$(document).on('dragstart','.collection-content.sort-mode .collectionIcon',function(e){e.originalEvent.dataTransfer.setData('text/plain','icon');Icon.moveDragStart(e);});$(document).on('dragleave','.collection-content.sort-mode .collectionIcon',function(e){Icon.moveDragLeave(e)});$(document).on('drop','.collection-content.sort-mode .collectionIcon',function(e){Icon.moveDrop(e);});$(document).on('dragend','.collection-content.sort-mode .collectionIcon',function(e){Icon.moveDragEnd(e);});$(document).on('dragenter','.collection-content.sort-mode .collectionIcon',function(e){Icon.moveDragEnter(e);});$("#btn-fetch-collection").click(Collection.fetch);$(document).on('click','.overlay-drop .register button',function(e){e.preventDefault();this.parentNode.parentNode.style.display='none';this.parentNode.parentNode.classList.remove('register');});$(document).on('click','.overlay-drop .upgrade button',function(e){e.preventDefault();this.parentNode.parentNode.style.display='none';this.parentNode.parentNode.classList.remove('upgrade');});$(document).on('click','.collection-content:not(.sort-mode) .icon-upload',function(e){e.preventDefault();this.parentNode.parentNode.parentNode.parentNode.querySelector('input.fileCollection').click();});$(document).on('change','.fileCollection',function(e){e.preventDefault();if(!Collection.checkUploadLimits(e))return false;if(e.target.files.length)
{for(var i=0;i<e.target.files.length;i++)
{Icon.checkUploadSvg(e.target.files[i]);}
document.getElementById('fileCollection-'+Collection.getActive().bookmark_id).value='';}});$(".icons .icon").attrchange({trackValues:true,callback:function(e){if(e.attributeName=='data-premium'&&e.oldValue==1&&e.newValue==0)
{e.target.setAttribute('data-premium',e.oldValue);}
if(e.attributeName=='data-id'&&e.newValue!=e.target.dataset.modified)
{e.target.dataset.modified=e.oldValue;e.target.setAttribute('data-id',e.oldValue);}}});setInterval(function(){[].forEach.call(document.getElementsByClassName("collectionIconImage"),function(i){Widget.renderSVG(i);});if(!$_(".collections"))Widget.update();},5000);$(".collections").on("click",".help_link",function(e){e.preventDefault();var win=window.open(this.href,'_blank');win.focus();});$(".modal-collection-pack #download-collection-free").on("click",function(e){e.stopPropagation();$("#download-collection-form").submit();$_("#modal-collection-pack").checked=false;});$("#modal-collection-pack").change(function(e){if(!this.checked){document.querySelector('.collection.expanded .download-holder button').classList.remove('disabled');document.getElementById('collections').classList.remove('loading');}});$(".modal-collection-pack .modal-fade-screen").on("click",function(e){document.querySelector('.collection.expanded .download-holder button').classList.remove('disabled');document.getElementById('collections').classList.remove('loading');});$("#max-collections").on("click",'.box:not(.keepDisabled)',function(e){e.stopPropagation();var keep=this.parentNode.find(".box.keep-collection").length;if(keep==Collection.limit.collections&&!this.classList.contains('keep-collection')){return false;}
this.classList.toggle("keep-collection");keep=this.parentNode.find(".box.keep-collection").length;var counter=Collection.limit.collections-keep;this.parentNode.find(".box:not(.keep-collection)").forEach(function(e){e.classList.toggle('keepDisabled',counter==0);});$_(".max-collections-container .keepCounter").innerHTML=counter;var btn=document.get("#max-collections #button-confirm");var choose=document.get("#max-collections p.choose");if(counter==0){btn.classList.remove("hidden");choose.classList.add("hidden");btn.disabled=false;}else{btn.classList.add("hidden");choose.classList.remove("hidden");btn.disabled=true;}});$("#max-collections").on("click","#button-confirm",function(){var ids=[];$_(".keep-collection").forEach(function(collection){ids.push(parseInt(collection.getAttribute("data-bookmark"),10));});db.update("list",function(collection){return!~ids.indexOf(collection.bookmark_id);},function(collection){var element=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");element.classList.add("locked");var options=element.get(".popover .menu-options");if(options){[].forEach.call(options.querySelectorAll('li button.collection-option'),function(option){if(!option.classList.contains('delete-collection')){option.classList.add('hidden');}});options.querySelector('.locked-collection').classList.remove('hidden');}
var download_wrapper=element.get(".download-wrapper");if(download_wrapper)
download_wrapper.parentNode.removeChild(download_wrapper);var upgrade_btn=element.get(".upgrade_btn");if(upgrade_btn)
upgrade_btn.classList.remove("hidden");collection.status=0;Collection.emit('set',{bookmark_id:collection.bookmark_id,status:0});return collection;});db.commit();$_("#max-collections").classList.remove('visible');});$("#collections").on("click",'.collection_share_button',function(){Collection.share(this.dataset.type);});$(document).on("click",".collection-header.hover",function(e){document.body.classList.add('notouch')});$(document).on("click",'.collection-icon-delete, .collectionIcon .flaticon-collections_remove',function(e){e.stopPropagation();e.preventDefault();Widget.delIcon(parseInt(this.parent('.icon').dataset.id,10));});$(document).on("click",".icon .overlay button, a.collection_add-remove",function(e){e.stopPropagation();e.preventDefault();var elem=this.parent(".icon");Widget[(elem.classList.contains('selected'))?'delIcon':'addIcon'](elem.dataset.id,elem.dataset.name,elem.dataset.team,elem.dataset.color,elem.dataset.premium,elem.dataset.custom_color);});$(document).on("click",".collection .collection-header",function(e){e.stopPropagation();window.launching=true;var parent=this.parent('.collection');if(!parent.classList.contains('expanded')){window.firstColorChange=true;Collection.setActive(parent.dataset.bookmark);}else{if(!parent.classList.contains('locked')){History_Collection.set_collection();}}});$(document).on("click",".collection-header .edit-collection",function(e){e.stopPropagation();window.launching=true;var parent=this.parent('.collection');if(!parent.classList.contains('expanded')){window.firstColorChange=true;Collection.setActive(parent.dataset.bookmark);}else{if(!parent.classList.contains('locked')){var edit=parent.get('.edit-name');edit.classList.add("active");edit.get('input').select();History_Collection.set_collection();}}});$(document).on("click",".collectionIcon .edit .popover-button",function(){Widget.createIconsCPicker(this);});$(document).on("click",".collection .edit-name:not(.active), .edit-name.active .flaticon-disk",function(e){e.stopPropagation()
Collection.rename(this);});$(document).on('click','.download-holder button',function(e){e.stopPropagation();this.parent('.collection').get('.collection-download').classList.add('active');});$(document).on("click",'#collections ul.download li button.btn',function(e){e.stopPropagation();e.preventDefault();this.parent('.download-files').get('.customize').classList.add("active");});$(document).on("click",'.collection-download.active .download-button',function(e){e.stopPropagation();var collection=this.parent('.collection');collection.get('.collection-download .customize').classList.remove("active");collection.get('.collection-download').classList.remove("active");Collection.download(collection.dataset.bookmark,this.dataset.format,this.dataset.size);});$(document).on("click",'.collection-download.active .header-download button',function(e){e.stopPropagation();var collection=this.parent('.collection');collection.get('.collection-download .customize').classList.remove("active");collection.get('.collection-download').classList.remove("active");});$(window).resize(function(){clearTimeout(window.resizeWindowInterval);window.resizeWindowInterval=setTimeout(function(){var collection_content=$_(".collection.expanded .collection-content");delete window.resizeWindowInterval;},500);});$(document).on("scroll",'#collections',function(e){ev.stopPropagation();ev.preventDefault();ev.returnValue=false;return false;});var scrollable='#collections, #collections-holder.scrollable, #collections .icons, .collection-download';$(document).on('DOMMouseScroll mousewheel',scrollable,function(ev){ev.stopPropagation();var up=(ev.type=='DOMMouseScroll'?ev.originalEvent.detail*-40:ev.originalEvent.wheelDelta)>0,c=this.scrollTop/(this.scrollHeight-this.clientHeight),prevent=function(){ev.preventDefault();ev.returnValue=false;return false;}
var list=document.get('.collection.expanded .icons');var download=document.get('.collection.expanded .collection-download.active');var holder=document.get('#collections-holder.scrollable');var scroll=(holder)?holder:((download)?download:list);var scrollBar=(scroll&&scroll.scrollHeight>scroll.clientHeight)||false;if((!up&&c===1)||(up&&c===0)||!scrollBar)return prevent();});$(document).on("keyup",".collection-name-input",function(e){e.preventDefault();if(e.which==13)Collection.rename(this);if(e.which==27){this.value=this.dataset.original;this.parentElement.classList.remove('active');this.blur();}});$(document).on("click",'.collection-icon-rename',function(e){e.stopPropagation();this.select();});$(document).on("keyup",'.collection-icon-rename',function(e){e.preventDefault();if(e.which==13)Icon.rename(this);if(e.which==27)this.value=this.dataset.original;});$(document).on("blur",'.collection-icon-rename',Icon.rename);$(document).on('click','#collections-toggle',function(e){e.stopPropagation();Widget.toggle();});$(document).on("click",'.collection-header button.edit-collection',function(e){e.stopPropagation();var edit=this.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.parentElement.querySelector('.edit-name');closeCollectionsMenu();[].forEach.call(document.find(".collection .collection-header .edit-name"),function(e){e.classList.remove('active');});edit.classList.add("active");edit.get('input').select();});$(document).on("click",'.collection-options .toggle-edit',Collection.openEditMode);$(document).on("click",".collection .collection-content .header-edit .btn-back",Collection.closeEditMode);$(document).on("click",'.collection-options .toggle-sort',Collection.openSortMode);$(document).on("click",".collection .collection-content .header-sort .btn-back",Collection.closeSortMode);$(document).on("click",'.collection-options .toggle-share',Collection.toggleShareLayer);$(document).on("click",'.collection-share .close',Collection.toggleShareLayer);$(document).on("click",'.collection-options .toggle-backup',Collection.toggleBackupLayer);$(document).on("click",'.collection-backup .close',Collection.toggleBackupLayer);$(document).on("click",'.collection-header button.flaticon-bin, .collection.locked .locked-options button',function(e){e.stopPropagation();var checkbox=$_("#modal-delete-collection");var btn=checkbox.parentNode.get(".modal-inner button.btn-danger");btn.dataset.bookmark=this.dataset.bookmark
checkbox.checked=true;});$('.modal_delete_collection .modal_delete_collection_btn').click(function(e){e.stopPropagation();var bookmark_id=this.getAttribute('data-bookmark');if(bookmark_id)
{Collection.del(bookmark_id);}
closeModal(this);});$(document).on("click",'.collection .color-selector li button',function(e){$(this.parent('.color-selector').nextElementSibling).colpickSetColor(this.dataset.color);});$(document).on("click",".collection_color_button",Widget.createCollectionCPicker);$(document).on('change','.upload-file-input',function(e){var file=this.files[0];var textType=/text.*/;if(file.type.match(textType)){var reader=new FileReader();reader.onload=function(e){$.ajax({url:APP_URL+'Collections/restore_backup',type:'POST',data:JSON.stringify(reader.result),success:function(response){Collection.restore_backup(response);}});}
reader.readAsText(file);this.value='';}else{console.log("File not supported!");}});$(document).on("click","#paint_collection",function(){if(document.getElementById('collections').classList.contains('expanded')){document.querySelector('.paint-popover').classList.remove('popover-left');document.querySelector('.paint-popover').classList.add('popover-right');}else{document.querySelector('.paint-popover').classList.remove('popover-right');document.querySelector('.paint-popover').classList.add('popover-left');}
Widget.createCollectionCPicker();document.querySelector('section[data-bookmark="'+Collection.getActive().bookmark_id+'"] .trigger_popover').click()});});function Collection(data,loading,duplicate){var properties=['bookmark_id','name','color','created','updated','active','order','source','status'];var ts=getTimestamp();var restoring=false;this.bookmark_id=data.bookmark_id||(Math.random().toString(36)+'00000000000000000').slice(2,16+2);this.name=data.name||"My icons collection";this.status=(data.status!=0)?1:0;this.color=data.color||'000000';this.created=data.created;this.updated=data.updated;this.source=data.source||'local';this.icons=data.icons||[];this.active=parseInt(data.active,10)||1;this.order=parseInt(data.order,10)||0;db.update('list',function(){return true},function(collection){collection.active=0;collection.order++;return collection;});db.commit();var self=this;data={duplicate:false};properties.forEach(function(k){if(typeof self[k]!='undefined'){data[k]=self[k];}});var list=db.queryAll("list");var current=list.filter(function(collection){return collection.bookmark_id==data.bookmark_id;});if(current.length){data.active=current[0].active;data.order=current[0].order;}
db.insertOrUpdate("list",{bookmark_id:this.bookmark_id},data);if(db.tableExists(this.bookmark_id)){db.dropTable(this.bookmark_id);}
if(this.icons.length){this.icons.forEach(function(icon){for(var key in icon){if(!~Icon.properties.indexOf(key)){icon[key]=null;}}
icon.bookmark_id=self.bookmark_id;});db.createTableWithData(this.bookmark_id,this.icons);}else{db.createTable(this.bookmark_id,Icon.properties);}
db.commit();if(duplicate)
{data.duplicate=true;data.icons=this.icons;}
if(!loading&&data.bookmark_id!='tour_demo_collection'){Collection.emit('create',data);}
if(!loading)
{Widget.update(loading);}
var collectionHolder=document.querySelector('#collections-holder');collectionHolder.classList.add('overflow');collectionHolder.classList.remove('scrollable');document.querySelector('button.flaticon-share').disabled=!gr.auth.me.status;}
Collection.fetch=function(check)
{collectionHeaderHover();if(check===true)
{var error=false;var btn_fetch=document.getElementById("btn-fetch-collection");if(!btn_fetch)return false;if(Array.isArray(collection_icons))
{if(collection_icons.every(function(i){return i.premium!=0;}))
{error=true;}
if(Collection.limit.collections&&db.rowCount("list")>=Collection.limit.collections)
{error=true;}}
btn_fetch.disabled=error;return;}
if(typeof collection_icons=='undefined')return false;if(!Array.isArray(collection_icons)||!gr.auth.logged||(Collection.limit.collections&&db.rowCount("list")>=Collection.limit.collections))
{console.warn("No se puede realizar fetch",!Array.isArray(collection_icons),!gr.auth.logged,(Collection.limit.collections&&db.rowCount("list")>=Collection.limit.collections));return false;}
var errors={personal:false,premium:false};var data={};data.color='000000';data.name=document.getElementsByTagName("h1")[0].innerText;data.source='fetch';data.icons=collection_icons.filter(function(icon){if(icon.premium==4&&icon.author!=gr.auth.me.id)
{errors.personal=true;return false;}
if(icon.premium==1&&!gr.auth.me.premium)
{errors.premium=true;return false;}
return true;});if(errors.premium)UserAlerts.warning('Ooops!',messages.collection.fetch_premium);if(errors.personal)UserAlerts.warning('Ooops!',messages.collection.fetch_personal);new Collection(data,false,true);}
function Icon(id,name,author,color,bookmark_id,premium,sort){if(typeof id!='number')throw"Invalid icon id";if(!bookmark_id)throw"Invalid bookmark_id";if(typeof author!='number')throw"Invalid author";this.premium=parseInt(premium)||0;this.id=parseInt(id,10);this.author=parseInt(author,10);this.bookmark_id=bookmark_id;this.color=isValidColor(color)?color:"000000";this.sort=parseInt(sort,10);if(typeof name!='undefined'){this.name=(name.toString().length)?slug(name.toString()):'icon-'+this.id;}else{this.name='icon-'+this.id;}
if(!db.queryAll(this.bookmark_id,{query:{id:this.id}}).length){var data={};var self=this;Icon.properties.forEach(function(i){data[i]=self[i];});db.insertOrUpdate(this.bookmark_id,{id:data.id},data);db.commit();Widget.updateToggle();}}
Icon.properties=["id","name","author","color","premium","sort"];Icon.set=function(id,values,bookmark_id,loading){if(!id)return false;if(!id)throw"Invalid icon id (Icon.set)";if(!bookmark_id)throw"Invalid bookmark_id (Icon.set)";var updatable=['color','name','sort','id','premium'];for(var k in values){if(updatable.indexOf(k)==-1){delete values[k];}}
if(!db.tableExists(bookmark_id))throw"Table "+bookmark_id+" doesn't exists (Icon.set)";if(!Object.keys(values).length)throw"Nothing to update (Icon.set) ",values;var date=getTimestamp();db.update('list',{bookmark_id:bookmark_id},function(collection){collection.updated=date;return collection;});db.update(bookmark_id,{id:id},function(icon){for(var i in values){icon[i]=values[i];}
values={};Icon.properties.forEach(function(field){values[field]=icon[field];});values.bookmark_id=bookmark_id;values.updated=date;if(!loading){Collection.emit('put_icon',values);}
return icon;});db.commit();}
Icon.refreshSVG=function(data)
{var icon=$_(".collection[data-bookmark='"+data.bookmark_id+"'] .icon[data-id='"+data.original+"']");icon.dataset.color=data.color;var url=urlUserIcon(data.id);icon.get("svg,img").outerHTML='<img src="{0}" data-premium="4"></img>'.format(url);if(icon.dataset.color!='XXXXXX')
{Widget.getSVGCode({id:data.original,bookmark:data.bookmark_id,src:url,premium:4,color:data.color});Icon.set(data.original,{id:data.original,color:data.color},data.bookmark_id,true);icon.dataset.id=data.original;}else{Widget.getSVGCode({id:data.id,bookmark:data.bookmark_id,src:url,premium:4,color:data.color});Icon.set(data.original,{id:data.id,premium:4,color:data.color},data.bookmark_id,true);icon.dataset.id=data.id;}
if(typeof toggleDetailButton=='function')toggleDetailButton();}
Icon.toggle=function(id){if(typeof toggleDetailButton=='function')toggleDetailButton();var icons=document.querySelectorAll(".icons .icon[data-id='"+id+"']:not(.collectionIcon)");if(!icons.length)return;var btn;var actions;[].forEach.call(icons,function(i){i.classList.toggle('selected');btn=i.get(".overlay button");actions=['add','remove'];if(i.classList.contains('selected'))actions.reverse();btn.classList[actions[0]]('flaticon-collections_add');btn.classList[actions[1]]('flaticon-collections_remove');i.querySelector('.collection_add-remove i').classList[actions[0]]('flaticon-collections_add');i.querySelector('.collection_add-remove i').classList[actions[1]]('flaticon-collections_remove');if(actions[0]==='remove')i.querySelector('.collection_add-remove span').innerText='Remove from collection';if(actions[0]==='add')i.querySelector('.collection_add-remove span').innerText='Add to collection';});}
Icon.rename=function(elem){elem=(elem instanceof(Element))?elem:elem.currentTarget;var name=(elem.value.length)?slug(elem.value):elem.dataset.original;if(name==elem.dataset.original)return;var id=parseInt(elem.parent('.icon').dataset.id,10);var bookmark_id=$_(".collection[data-order='0']").dataset.bookmark;Icon.set(id,{name:name},bookmark_id);elem.dataset.original=name;elem.value=name;ga('send','event','Collection','Rename Icon');}
Icon.cleanSvgIcon=function(content)
{var wrapper=document.createElement("div");wrapper.innerHTML=content;var nodes=wrapper.getElementsByTagName('*');for(var i=-1,l=nodes.length;++i<l;){if(typeof nodes[i]!='undefined')continue;if(nodes[i].hasAttribute("fill")&&nodes[i].getAttribute("fill")=='none'&&(!nodes[i].hasAttribute("stroke")||nodes[i].hasAttribute("stroke")&&nodes[i].getAttribute("stroke")=='none'))
{nodes[i].parentNode.removeChild(nodes[i]);}}
return wrapper.innerHTML;}
Icon.equal_colors=function(array_to_check){if(!Array.isArray(array_to_check)||array_to_check.length==1||array_to_check.length==0){return null;}
for(i=0;i<array_to_check.length;i++){if(i>0&&array_to_check[i]!=array_to_check[i-1]){return array_to_check;}}
return null;}
Icon.checkSvgColor=function(content){var expreg=/#(?:[a-f\d]{3}){1,2}\b|rgb\((?:(?:\s*0*(?:25[0-5]|2[0-4]\d|1?\d?\d)\s*,){2}\s*0*(?:25[0-5]|2[0-4]\d|1?\d?\d)|\s*0*(?:100(?:\.0+)?|\d?\d(?:\.\d+)?)%(?:\s*,\s*0*(?:100(?:\.0+)?|\d?\d(?:\.\d+)?)%){2})\s*\)|hsl\(\s*0*(?:360|3[0-5]\d|[12]?\d?\d)\s*(?:,\s*0*(?:100(?:\.0+)?|\d?\d(?:\.\d+)?)%\s*){2}\)|(?:rgba\((?:(?:\s*0*(?:25[0-5]|2[0-4]\d|1?\d?\d)\s*,){3}|(?:\s*0*(?:100(?:\.0+)?|\d?\d(?:\.\d+)?)%\s*,){3})|hsla\(\s*0*(?:360|3[0-5]\d|[12]?\d?\d)\s*(?:,\s*0*(?:100(?:\.0+)?|\d?\d(?:\.\d+)?)%\s*){2},)\s*0*(?:1|0(?:\.\d+)?)\s*\)/gi;var colores=content.match(expreg);colores=Icon.equal_colors(colores);return(colores!=null)?1:0;}
Icon.checkXmlFormat=function(content)
{var oParser=new DOMParser();var result;try{var oDOM=oParser.parseFromString(content,"text/xml");}catch(exc){return false;}
if(/script/i.test(content)){result='ERROR while parsing';}else{result=oDOM.documentElement.nodeName=="parsererror"?"error while parsing":oDOM.documentElement.nodeName;}
return result=="svg";}
Icon.checkUploadSvg=function(f)
{var reader=new FileReader();var filename=sanitize_filename(f.name);f.name=filename;if(f.size>150000)
{ga('send','event','Collection','Upload Icon','Error: Exceeded size.');UserAlerts.danger('ERROR',messages.limit.max_size+' (Max. 150Kb.)',false);return false;}
reader.filename=filename;reader.filetype=f.type;reader.file=f;reader.onloadend=function(e){var msg;var checked=false;var file_type="";var isColor=0;var DOMURL=window.webkitURL||window.URL||window;if(e.target.filetype=='image/svg+xml')
{if(!Icon.checkXmlFormat(e.target.result))
{ga('send','event','Collection','Upload Icon','Error: Malformed SVG');UserAlerts.danger('ERROR',messages.collection.svg_incorrect,false);return false;}
isColor=Icon.checkSvgColor(e.target.result);file_type=e.target.filetype;var collection=Collection.getActive();var sort=db.query(collection.bookmark_id).length+1;Collection.upload_icon(this.file,isColor,sort);}
else
{ga('send','event','Collection','Upload Icon','Error: File not SVG');UserAlerts.danger('ERROR',messages.collection.only_svg,false);return;}}
reader.onerror=function(e){console.log('ERROR',e);}
reader.readAsText(f);delete reader;}
Icon.moveDragStart=function(event){var dataTransfer=event.originalEvent.dataTransfer;dataTransfer.effectAllowed='move';dataTransfer.dropEffect='move';Widget.dragged_icon=(event.target.nodeName=='LI')?event.target:event.target.parentNode.parentNode;Widget.dragged_icon.classList.add('dragHover');Widget.dragged_position=parseInt(Widget.dragged_icon.dataset.sort,10);}
Icon.moveDragEnter=function(event){var icon=(event.target.nodeName=='LI')?event.target:event.target.parentNode.parentNode;if(icon.dataset.id==Widget.dragged_icon.dataset.id)return false;var place;if(Widget.dragged_icon.dataset.sort==icon.dataset.sort+1)
{place=event.currentTarget;}
else
{place=(Widget.dragged_icon.dataset.sort<=icon.dataset.sort)?event.currentTarget:event.currentTarget.nextElementSibling;}
Widget.moveIcon(Widget.dragged_icon,place);Widget.scroll(event.clientX,event.clientY);}
Icon.moveDragLeave=function(event){}
Icon.moveDragEnd=function(event){event.preventDefault();event.stopPropagation();Icon.moveDrop(event);}
Icon.moveDrop=function(event){event.preventDefault();var collection=Collection.getActive();var collection_section=document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"]');Widget.reorderIcons(collection_section,false);if(Widget.dragged_icon.classList.contains('dragHover'))
{Widget.dragged_icon.classList.remove('dragHover');var icon_id=parseInt(Widget.dragged_icon.dataset.id,10);var new_order=parseInt(collection_section.querySelector('li[data-id="'+icon_id+'"]').dataset.sort,10);Icon.updateReorder(collection.bookmark_id,icon_id,Widget.dragged_position,new_order);}}
Icon.updateReorder=function(bookmark_id,icon_id,order,new_order)
{Collection.emit('reorder_item',{bookmark_id:bookmark_id,icon_id:icon_id,old_order:order,new_order:new_order});}
Collection.init=function(){if(db)return;Collection.limit={};var properties={icons:{value:50},collections:{value:1}};if(gr.auth.logged){var dropdown=$_(".dropdown-upgrade.register");properties={icons:{value:256},collections:{value:3}}}else{var dropdown=$_(".dropdown-upgrade.upgrade");}
if(dropdown){dropdown.parentNode.removeChild(dropdown);}
if(gr.auth.me.premium){properties.collections.value=0;}
Object.defineProperties(Collection.limit,properties);Object.freeze(Collection);var db_name=gr.auth.me.id||0;db=new localStorageDB(db_name);if(!db.tableExists('list')){db.createTable("list",["name","bookmark_id","created","updated","active","source","order","color","status"]);ga('send','event','Collection','Create First');}else{if(!(db.columnExists("list","status"))){db.alterTable("list","status",1);}}
db.queryAll("list").forEach(function(collection){if(!(db.columnExists(collection.bookmark_id,"premium"))){db.alterTable(collection.bookmark_id,"premium",0);}
if(!(db.columnExists(collection.bookmark_id,"sort"))){db.alterTable(collection.bookmark_id,"sort",0);}});if(db.tableExists('tour_demo_collection')){db.dropTable('tour_demo_collection');db.deleteRows('list',{bookmark_id:'tour_demo_collection'});}
db.commit();var set_id=localStorage.getItem('widget_state_user');if(set_id!=gr.auth.me.id){$_("#collections-holder").innerHTML='';}
if(document.getElementById("collections-holder").childElementCount){Widget.update(true);var updated=true;}
if(gr.auth.logged){Collection.push();}else{if(!updated){Widget.update();}}
Collection.fetch(true);}
Collection.pull=function(){Collection.emit('pull');}
Collection.openEditMode=function(){Collection._toggleEditMode('add');}
Collection.closeEditMode=function(){Collection._toggleEditMode('remove');}
Collection._toggleEditMode=function(method){var collection=$_('.collection[data-order="0"]');collection.get('.collection-content').classList[method]('edit-mode');collection.get('.header-sort').classList[method]('hidden');collection.get('.header-edit').classList[method]('visible');collection.get('.download-wrapper').classList[method]('hidden');closeCollectionsMenu();}
Collection.openSortMode=function(){ga('send','event','Collection','Sort');Collection._toggleSortMode('add');Collection.FirstIconOrder('add');document.querySelectorAll('li.icon-upload').forEach(function(li){li.dataset.tooltip=messages.collection.upload_disabled;})}
Collection.closeSortMode=function(){Collection._toggleSortMode('remove');Collection.FirstIconOrder('remove');document.querySelectorAll('li.icon-upload').forEach(function(li){li.dataset.tooltip=messages.collection.upload_enabled;});}
Collection._toggleSortMode=function(method){var collection=$_('.collection[data-order="0"]');collection.get('.collection-content').classList[method]('sort-mode');collection.get('.header-sort').classList[method]('visible');closeCollectionsMenu();}
Collection.toggleShareLayer=function(method){var collection=$_('.collection[data-order="0"]');collection.get('.collection-share').classList.toggle('visible');closeCollectionsMenu();}
Collection.toggleBackupLayer=function(method){var collection=$_('.collection[data-order="0"]');collection.get('.collection-backup').classList.toggle('visible');closeCollectionsMenu();}
Collection.merge=function(){var _db=new localStorageDB(0);var library=_db.queryAll("list");library.forEach(function(collection){collection.icons=_db.queryAll(collection.bookmark_id);if(collection.icons.length){var ts=getTimestamp();if(!collection.created)collection.created=ts;if(!collection.updated)collection.updated=ts;new Collection(collection,false,true);}});_db.drop();}
Collection.set_id=function(params){db.renameTable(params.old_id,params.bookmark_id);db.update("list",{bookmark_id:params.old_id},function(collection){collection.bookmark_id=params.bookmark_id;collection.source='local';return collection;});db.commit();var stored_icons=db.rowCount(params.bookmark_id);if(stored_icons)
{db.update(params.bookmark_id,function(i){return true},function(icon){icon.bookmark_id=params.bookmark_id;return icon;});db.commit();}
Widget.limitsCollection(params.bookmark_id);var collectionElem=$_(".collection[data-bookmark='"+params.old_id+"']");if(collectionElem){collectionElem.dataset.bookmark=params.bookmark_id;}
var deleteButton=collectionElem.querySelector(".header-options button.flaticon-bin");if(deleteButton)
{deleteButton.dataset.bookmark=params.bookmark_id;}
var shareInput=collectionElem.querySelector(".collection-share input");if(shareInput)
{var value=shareInput.value.split("/");value.pop();value.push(params.bookmark_id);shareInput.value=value.join("/");}
var boxElem=$_(".box[data-bookmark='"+params.old_id+"']");if(boxElem){boxElem.dataset.bookmark=params.bookmark_id;}}
function closeCollectionsMenu(){var popoverButton=document.querySelector('.popover-button.active');var popoverContent=document.querySelector('.popover-content.show-menu');if(popoverButton){popoverButton.classList.remove('active');}
if(popoverContent){popoverContent.classList.remove('show-menu');}}
function callback_handler(data){if(data.namespace){var q=data.namespace.split(".");if(typeof window[q[0]][q[1]]==="function"){delete data.namespace;window[q[0]][q[1]](data);}}
window.loading=false;}
Collection.emit=function(event,data){if(gr.auth.me.id){data=(data instanceof(Object))?data:{};if(data.bookmark_id=='tour_demo_collection')return;gr.request.post('/collections/'+event,data);}}
Collection.limitReached=function(){var collectionLimitBox=$_(".max-collections-content"),tpl=Handlebars.tag("collection-limit-box"),library=db.queryAll("list",{query:{status:1}}),counter=(Collection.limit.collections)?library.length-Collection.limit.collections:0;if(counter<1)return;$_("#max-collections").classList.add('visible');collectionLimitBox.innerHTML='';library.forEach(function(collection){collection.icons=db.queryAll(collection.bookmark_id,{limit:10,sort:[["created","DESC"]]});collection.count=db.rowCount(collection.bookmark_id);collectionLimitBox.insertAdjacentHTML('beforeend',tpl(collection));});for(var i=0;i<5;i++){collectionLimitBox.insertAdjacentHTML('beforeend','<article class="box box--fake"></article>')}}
Collection.set=function(bookmark_id,new_values){var collectionElem=$_(".collection[data-bookmark='"+bookmark_id+"']");var force=new_values.force;var old_color=new_values.old_color;for(var i in new_values){if(["name","bookmark_id","source","color"].indexOf(i)==-1)delete new_values[i];}
var keys=Object.keys(new_values);if(!keys.length)return;new_values.updated=getTimestamp();db.update("list",{bookmark_id:bookmark_id},function(collection){if('name'in new_values)
{collectionElem.get(".collection-name").innerHTML=new_values.name;}
if('bookmark_id'in new_values)
{collectionElem.dataset.bookmark=new_values.bookmark_id;}
var data={bookmark_id:bookmark_id,force:force,old_color:old_color};for(var i in new_values){collection[i]=new_values[i];data[i]=new_values[i];}
Collection.emit('set',data);return collection;});db.commit();}
Collection.editName=function(){var inputTxt=$_(".collections [data-order='0'] .collection-header .edit-name");inputTxt.classList.add("active");inputTxt.get("input").select();}
Collection.list=function(){var collectionHolder=$_('#collections-holder');[].forEach.call(document.find('#collections .collection'),function(item){if(item.getAttribute('data-order')==0&&item.classList.contains('expanded')){item.classList.remove('expanded');ga('send','event','Collection','List','Hide');}else{if(item.getAttribute('data-order')==0)item.classList.add('expanded');ga('send','event','Collection','List','Show');}});collectionHolder.classList.toggle('overflow');collectionHolder.classList.toggle('scrollable');}
Collection.expandCollapse=function(){var collections=$_('#collections');var viewport=$_('#viewport');collections.classList.toggle('expanded');viewport.classList.toggle('collections-expanded');}
Collection.setActive=function(bookmark_id,lock_collection_holder){if(!bookmark_id){bookmark_id=Collection.getActive().bookmark_id;}
var list=db.queryAll("list",{sort:[["order","ASC"]]});var order=[bookmark_id];if(!lock_collection_holder){var holder=$_("#collections-holder");holder.scrollTop=0;holder.classList.add('overflow');holder.classList.remove('scrollable');}
var collectionHeight=list.length>1?(list.length>2?'collection-height-2':'collection-height-1'):'';list.forEach(function(collection){if(collection.bookmark_id!=bookmark_id)order.push(collection.bookmark_id);var elem=$_('.collection[data-bookmark="'+collection.bookmark_id+'"]');if(elem.length>1){for(var n=1,l=elem.length;n<l.length;n++)
{elem[n].parentNode.removeChild(n);}}
collection.order=order.indexOf(collection.bookmark_id);elem.dataset.order=collection.order;if(collection.bookmark_id==bookmark_id){collection.active=1;elem.classList.remove('collection-height-1','collection-height-2');if(!lock_collection_holder){elem.classList.add('expanded');}
if(collectionHeight.length){elem.classList.add(collectionHeight);}}
db.update("list",{bookmark_id:collection.bookmark_id},function(row){row.order=collection.order;row.active=collection.active;return row;});db.commit();if(gr.auth.me.status){show_feedback_collection(collection.bookmark_id);}});if(typeof History_Collection!='undefined')History_Collection.set_collection();Widget.limitsCollection(bookmark_id);Widget.update(null,lock_collection_holder);}
Widget.limitsCollection=function(bookmark_id)
{if(!bookmark_id)return false;var toggle=$_('#collections-toggle');var count=db.rowCount(bookmark_id);var elem=$_(".collection[data-bookmark='"+bookmark_id+"']");if(elem)
{var max_icons=elem.querySelector('.max-icons-collection');if(count>=Collection.limit.icons){if(gr.auth.me.id)
{if(max_icons)
{max_icons.style.display='block';UserAlerts.danger('Ooop!',messages.limit.collection);}}else{elem.get('.icons-collection-noregister').style.display='block';UserAlerts.danger('Ooop!',messages.limit.guest);}
toggle.classList.add('limit-reached');elem.classList.add("limit-reached");}else{if(max_icons)
{max_icons.style.display='none';}
var collections_no_register=elem.querySelector('.icons-collection-noregister');if(collections_no_register)
{collections_no_register.style.display='none';}
toggle.classList.remove('limit-reached');elem.classList.remove("limit-reached");}}}
Collection.getActive=function(){if(!db)return;if(!db.rowCount("list"))throw"No collections stored";var collection=db.queryAll("list",{query:{active:1}});if(collection.length)collection=collection[0];else collection=db.queryAll("list")[0];return collection;}
Collection.clear=function(bookmark_id){db.truncate(bookmark_id);Widget.clear();Collection.emit('clear',{bookmark_id:bookmark_id});if(typeof History_Collection!='undefined')History_Collection.collection_delete(bookmark_id);var element=document.get(".collection[data-order='0'] .collection-header .edit-name input");if(element)
{element.value='My icons collection';element.classList.remove("limit-reached");Collection.rename();}
Widget.updateToggle();Widget.markSelectedIcons();ga('send','event','Collection','Clear');}
Collection.duplicate=function(){ga('send','event','Collection','Duplicate');var original=Collection.getActive();var duplicate={};var ts=getTimestamp();var duplicate_files=false;duplicate.name=original.name+" 2";duplicate.status=1;duplicate.color=original.color;duplicate.created=ts;duplicate.updated=ts;duplicate.source='local';duplicate.icons=db.queryAll(original.bookmark_id);if(duplicate.icons.length)
{duplicate.icons.forEach(function(icon){if(icon.premium==4)
{duplicate_files=true;}})}
if(duplicate_files)
{this.duplicate_files(duplicate);}
else
{new Collection(duplicate,false,true);}}
Collection.duplicate_files=function(collection)
{var data=new FormData();data.append('collection',JSON.stringify(collection));$.ajax({url:APP_URL+'Collections/duplicate',type:'POST',data:data,cache:false,processData:false,contentType:false,success:function(response){response=JSON.parse(response);new Collection(response.data.data,false,true);}});}
Collection.del=function(id,prevent){if(id instanceof Object){prevent=true,id=id.id;}
if(!id){id=$_(".collection[data-order='0']").dataset.bookmark;}
var collection=db.queryAll("list",{query:{bookmark_id:id}});if(!collection.length){if(db.tableExists(id)){db.dropTable(id);}
db.commit();return false;}
collection=collection[0];if(db.rowCount("list")==1&&collection.bookmark_id!="tour_demo_collection"){Collection.clear(collection.bookmark_id);return;};db.deleteRows("list",{bookmark_id:collection.bookmark_id});db.commit();if(db.tableExists(collection.bookmark_id)){db.dropTable(collection.bookmark_id);}
if(typeof History_Collection!='undefined')History_Collection.collection_delete(collection.bookmark_id);db.update("list",function(col){return col.order>collection.order;},function(col){col.order=parseInt(col.order,10)-1;});db.commit();var col_elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");if(!col_elem){return false;}
col_elem.parentElement.removeChild(col_elem);$_("#new_collection_btn").disabled=(Collection.limit.collections&&db.rowCount('list')>=Collection.limit.collections);if(!db.rowCount("list")){Collection.new();}
if(!prevent){Collection.emit('del',{bookmark_id:collection.bookmark_id});ga('send','event','Collection','Delete');}
Collection.setActive(null,db.rowCount("list")>1);}
Collection.new=function(options){if(Collection.limit.collections&&db.rowCount('list')>=Collection.limit.collections){return;}
if(typeof options=="undefined"||!options instanceof(Object))options={};ga('send','event','Collection','Create');options.name=(typeof options.name=="undefined"||!options.name.length)?'My icons collection':options.name;new Collection(options);if(typeof History_Collection!='undefined'){History_Collection.set_collection();History_Collection._toogle_cursors();}
if(Collection.getActive()){var active_collection=document.querySelector('section.collection[data-bookmark="'+Collection.getActive().bookmark_id+'"]');active_collection.querySelector('div.edit-name').classList.add('active')
active_collection.querySelector('div.edit-name input.collection-name-input').select();}}
Collection.push=function(id){var query=(id&&typeof id=='number')?{query:{bookmark_id:id}}:{sort:[["order","DESC"]]};var collections=db.queryAll("list",query);collections.forEach(function(collection){['ID','order','active'].forEach(function(index){delete collection[index];});collection.icons=db.queryAll(collection.bookmark_id,{sort:[["sort","DESC"]]});});Collection.emit('push',{data:collections});}
Collection.enqueue=function(queue){var saveState=false;var keys=Object.keys(queue);if(keys.length){saveState=true;var i=0;for(var ev in queue){++i;if(typeof window[queue[ev].namespace][queue[ev].callback]=='function'){if(queue[ev].data)
{queue[ev].data.prevent=(i!=keys.length);}
window[queue[ev].namespace][queue[ev].callback](queue[ev].data);}}}
if(localStorage.getItem('fi_0')){saveState=true;Collection.merge();}
Widget.update();Collection.setActive()}
Collection.load=function(collections){if(!Array.isArray(collections)&&typeof collections=="object"){var collections=Object.keys(collections).map(function(k){return collections[k];});}
collections.forEach(function(collection){if($_(".collection[data-bookmark='"+collection.bookmark_id+"']")){return false;}
collection.source='remote';if(db.tableExists(collection.bookmark_id))
{db.dropTable(collection.bookmark_id);}
if(collection.icons.length)
{db.createTableWithData(collection.bookmark_id,collection.icons);}
else
{db.createTable(collection.bookmark_id,Icon.properties);}
db.insertOrUpdate("list",{bookmark_id:collection.bookmark_id},collection);});window.firstColorChange=true;}
Collection.rename=function(elem){if(!elem)elem=$_(".collection[data-order='0'] .collection-header .edit-name input");var parent=elem.parent('.collection'),inputTxt=parent.get(".collection-header .edit-name"),name=inputTxt.get("input").value,name=(name.length)?name:'My icons collection';inputTxt.classList.remove('active');if(elem.dataset.original==name)return;parent.get('.collection-name').innerHTML=name;elem.dataset.original=name;Collection.set(parent.dataset.bookmark,{name:name});ga('send','event','Collection','Rename');}
Collection.getCollectionData=function(bookmark_id){var collection=db.queryAll("list",{query:{bookmark_id:bookmark_id}});if(!collection.length){return;}
collection=collection[0];collection.icons=db.queryAll(bookmark_id).map(function(i){return{id:i.id,team:i.author,name:i.name,color:"#"+i.color,premium:i.premium,sort:i.sort}});if(!collection.icons.length){return;}
return collection;}
Collection.download=function(bookmark_id,format,size){var collection_section=document.querySelector('.collection[data-bookmark="'+bookmark_id+'"]');Widget.reorderIcons(collection_section,false);prepare_modal_download('collection');var collection=Collection.getCollectionData(bookmark_id);if(format=='iconfont'){if(db.queryAll(bookmark_id,{query:{color:'XXXXXX'}}).length){UserAlerts.warning(messages.collection.aware,messages.collection.iconfont_colors);}}
if(db.queryAll(bookmark_id,{query:{premium:4}}).length){UserAlerts.warning(messages.collection.aware,messages.collection.download_personal);}
size=size||512;$('#download-collection-form').attr('action','/download-collection');document.getElementById('downC_format').value=format||'font';document.getElementById('downC_size').value=size||512;document.getElementById('downC_user_id').value=gr.auth.me.id||0;document.getElementById('downC_bookmark_id').value=collection.bookmark_id;document.getElementById('downC_bookmark_name').value=collection.name;document.getElementById('downC_icons').value=JSON.stringify(collection.icons);document.getElementById('downC_backup').value=JSON.stringify(collection);$_(".modal-collection .collection_name").innerHTML=collection.name;update_download_counter(3000);Widget.downloading();if(gr.auth.me.premium){$("#download-collection-form").submit();}else{$_("#modal-collection-pack").checked=true;}
ga('send','event','Collection','Download',document.getElementById('downC_format').value.toUpperCase(),collection.icons.length,{'metric2':collection.icons.length});};Collection.downloadBackup=function(e)
{e.preventDefault();var collection=Collection.getCollectionData(Collection.getActive().bookmark_id);var col={'ID':collection.ID,'active':collection.active,'bookmark_id':collection.bookmark_id,'color':collection.color,'created':collection.created,'name':collection.name,'order':collection.order,'source':collection.source,'status':collection.status,'updated':collection.updated};var colId=collection.ID;var colBookmarkId=collection.bookmark_id;var icons=collection.icons;var backup={colId:col,colBookmarkId:icons};var content=encodeURIComponent(btoa(JSON.stringify(backup)));var file_name=collection.name.split(' ').join('_')+'_backup.txt';if(window.navigator.msSaveOrOpenBlob&&window.Blob){console.log('Backup 1');var blob=new Blob([content],{type:"text/plain"});navigator.msSaveOrOpenBlob(blob,file_name);}else{console.log('Backup 2');var element=document.createElement('a');element.setAttribute('download',file_name);element.setAttribute('href','data:text/plain;charset=utf-8,'+content);element.style.display='none';document.body.appendChild(element);element.click();document.body.removeChild(element);document.querySelector('div.collection-backup.visible').classList.remove('visible');}};Collection.ninja=function(data){Widget.delIcon(data.icon);UserAlerts.danger('Ninja!',data.message);}
Collection.share=function(type){var shareImageUrl='Blablabla.com';var active=Collection.getActive();var url=window.location.protocol+"//"+window.location.hostname+"/"+messages.common.collections+active.bookmark_id;var title="I present to the world my favorite collection '%s' I created with the icons at Flaticon. Aren't they amazing?".replace("%s",active.name);var data={url:url,title:title,image:shareImageUrl,pathname:window.location.pathname};if(type=='google')
{glpopup(data);}
else if(type=='facebook')
{fbpopup(data);}
else if(type=='twitter')
{tweet(new Event("click"),data);}}
Collection.upload_icon=function(file,isColor,sort,id,color,name,update){if(!file)return false;var data=new FormData();data.append('iconCollection',file);data.append('isColor',isColor);data.append('sort',sort);data.append('bookmark_id',Collection.getActive().bookmark_id);data.append('update',update===true);if(typeof name!='undefined')data.append('name',name);if(typeof color!='undefined')data.append('color',color);if(typeof id!='undefined')data.append('id',id);$.ajax({url:APP_URL+'Collections/upload_icon',type:'POST',data:data,cache:false,processData:false,contentType:false,success:function(response){ga('send','event','Collection','Upload Icon','No Error');response=JSON.parse(response);callback_handler(response.data)}});}
Collection.delete_files=function(icons)
{if(!gr.auth.me.id)return false;var data=new FormData();data.append('icons',JSON.stringify(icons));$.ajax({url:APP_URL+'Collections/delete_files',type:'POST',data:data,cache:false,processData:false,contentType:false,success:function(response){}});}
Collection.dragOver=function(event)
{event.preventDefault();if(detectBrowser()=='IE')return false;if(document.querySelectorAll('.collection .sort-mode, .collections .edit-mode').length)return false;var collection=Collection.getActive();document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"] .overlay-drop').style.display='block';return;}
Collection.dragEnd=function(event)
{event.preventDefault();if(detectBrowser()=='IE')return false;if(document.querySelectorAll('.collection .sort-mode, .collections .edit-mode').length)return false;var collection=Collection.getActive();document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"] .overlay-drop').style.display='none';return;}
Collection.drop=function(event)
{event.stopPropagation();event.preventDefault();if(detectBrowser()=='IE')return false;if(document.querySelectorAll('.collection .sort-mode, .collections .edit-mode').length)return false;var collection=Collection.getActive();document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"] .overlay-drop').style.display='none';document.querySelector('.overlay-drop').classList.remove('show');if(!this.checkUploadLimits(event))return false;event.dataTransfer.dropEffect='copy';var files=event.dataTransfer.files;if(files.length){for(var i=0;i<files.length;i++)
{Icon.checkUploadSvg(files[i]);}
document.getElementById('fileCollection-'+collection.bookmark_id).value='';}
return false;}
Collection.checkUploadLimits=function(e)
{var limit_personal_icons=(gr.auth.me.premium)?256:3;var collection=Collection.getActive();var n_personal=db.queryAll(collection.bookmark_id,{query:{premium:4}}).length;var total_files=(typeof e.dataTransfer!='undefined')?e.dataTransfer.files.length:e.target.files.length;var limit_files_uploads=limit_personal_icons-(total_files+n_personal);var collection_div=document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"]');if(!gr.auth.me.id){collection_div.querySelector('.overlay-drop').style.display='block';collection_div.querySelector('.overlay-drop').classList.add('register');return false;}
if(limit_files_uploads<0)
{collection_div.querySelector('.overlay-drop').style.display='block';collection_div.querySelector('.overlay-drop').classList.add('upgrade');var message=messages.limit.personal_limit.replace('{0}',total_files).replace('{1}',limit_personal_icons);UserAlerts.danger('Ooops!',message);return false;}
return true;}
Collection.updateReorder=function(bookmark_id,icons)
{Collection.emit('reorder',{bookmark_id:bookmark_id,icons:icons});}
Collection.FirstIconOrder=function(type)
{var collection=Collection.getActive();if(type=='add')
{document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"] ul.collection_icons_list .icon-fill').insertAdjacentHTML('beforebegin','<li class="collectionIcon first-icon" data-id="0" data-sort="0"></li>');}
else
{var ico=document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"] ul.collection_icons_list .first-icon');if(ico)ico.parentNode.removeChild(ico);}}
Collection.test=function(data)
{console.log('TEST ',data);}
Collection.restore_backup=function(backup_content){Widget.restoring=true;backup_content=JSON.parse(backup_content);var count_inserts=0;var count_skiped=0;var icons_backup=[];var comparation_array=[];var collection_items=db.query(Collection.getActive().bookmark_id);for(var j=collection_items.length-1;j>=0;j--)
{comparation_array.push(collection_items[j].id);}
for(var i in backup_content)
{if(Array.isArray(backup_content[i]))
{icons_backup=backup_content[i];}}
if(db.rowCount(Collection.getActive().bookmark_id)>=Collection.limit.icons)
{UserAlerts.danger('Ooops!',messages.limit.collection);}
else
{if(db.rowCount(Collection.getActive().bookmark_id)+icons_backup.length>Collection.limit.icons)
{var max_inserts=Collection.limit.icons-db.rowCount(Collection.getActive().bookmark_id);var merge_backup=true;loop1:for(var i=icons_backup.length-1;i>=0;i--)
{if(count_inserts<=max_inserts)
{if(comparation_array.indexOf(icons_backup[i].id)===-1&&count_inserts<max_inserts)
{count_inserts++;}
else
{merge_backup=false;break loop1;}}
else
{merge_backup=false;break loop1;}}
if(merge_backup)
{icons_backup.forEach(function(icon)
{if(icon.id<999999999)
{Widget.addIcon(icon.id,slug(icon.name),null,icon.color.replace("#",''),icon.premium,icon.color.replace("#",''))}
else
{UserAlerts.warning('Ooops!',messages.collection.fetch_personal);}});}
else
{UserAlerts.warning('Ooops!',messages.limit.backup_max_size);}}
else
{icons_backup.forEach(function(icon)
{if(icon.id<999999999)
{if(comparation_array.indexOf(icon.id)===-1)
{count_inserts++;Widget.addIcon(icon.id,slug(icon.name),null,icon.color.replace("#",''),icon.premium,icon.color.replace("#",''))}else{count_skiped++;}}
else
{UserAlerts.warning('Ooops!',messages.collection.fetch_personal);}});}
if(count_skiped!=icons_backup.length)
{var message=messages.collection.success_restore.replace('{0}',count_inserts).replace('{1}',icons_backup.length);UserAlerts.success('Great!',message);}
if(count_skiped>0)
{var message=messages.collection.icons_skiped.replace('{0}',count_skiped).replace('{1}',icons_backup.length);UserAlerts.success('Ooops!',message);}}
Widget.restoring=false;Widget.updateButtons();document.querySelector('div.collection-backup.visible').classList.remove('visible');}
function Widget(){}
Widget._toggleEditPanel=function(download)
{if(download===true)
{$('.edit-icon-content .right .active').removeClass("active");$('.edit-icon-content .right .download-settings').addClass("active");$(".edit-icon-content").removeClass("edit-color").removeClass("edit-settings").addClass("download-settings");return;}
if($('.edit-icon-content').hasClass('download-settings'))
{$(".edit-icon-content").removeClass("download-settings");$('.edit-icon-content .right .download-settings').removeClass("active");this.classList.add('active');$('.edit-icon-content .right .'+this.dataset.panel).addClass("active");$(".edit-icon-content").addClass(this.dataset.panel);return;}
if(this.classList.contains('active'))
{$('.edit-icon-content .right .download-settings').removeClass("active");return;}
$('.edit-icon-content .right .customize').removeClass('active');$(".edit-icon-content").toggleClass("edit-color").toggleClass("edit-settings");$('.edit-icon-content .right header button').toggleClass('active');$('.edit-icon-content .right div:not(.download-settings)').toggleClass('active');$('.edit-icon-content .right .download-settings').removeClass("active");}
Widget._openEditModal=function(open,data,detail,contextMenu)
{console.log('==> Widget._openEditModal open :: ',open);console.log('==> Widget._openEditModal data :: ',data);console.log('==> Widget._openEditModal detail :: ',detail);console.log('==> Widget._openEditModal contextMenu :: ',contextMenu);var icon=document.querySelector('.icon[data-id="'+data.id+'"]');if(open)
{document.querySelector('.only_registered .alert_no_user').classList.remove('zoomOut');if(gr.auth.me.status){document.querySelector('.only_registered').classList.add('hidden');}else{document.querySelector('.only_registered').classList.remove('hidden');document.querySelector('.only_registered .alert_no_user').style='';}
if(['Safari','IE'].indexOf(detectBrowser())!=-1){document.querySelector('.edit-icon-content button[data-panel="edit-settings"]').classList.add('hidden');document.querySelector('.edit-icon-content button[data-panel="edit-color"]').style.width="100%";}
if(['IE'].indexOf(detectBrowser())!=-1){document.querySelector('.grid-selector').classList.add('hidden');}
if(detail&&(document.getElementById('detail-icon-button')&&!document.getElementById('detail-icon-button').classList.contains('btn-danger'))){document.getElementById('save_into_active').innerHTML=document.getElementById('detail-icon-button').innerHTML;document.getElementById('save_into_active').classList.add('btn-gray');document.getElementById('save_into_active').disabled=false;document.querySelector('.edit-icons-user-actions .free_user_warning').classList.add('hidden');}else if(!detail&&contextMenu&&!icon.classList.contains('selected')){document.getElementById('save_into_active').innerHTML=icon.querySelector('.popover .collection_add-remove').innerHTML;document.getElementById('save_into_active').classList.add('btn-gray');document.getElementById('save_into_active').disabled=false;document.querySelector('.edit-icons-user-actions .free_user_warning').classList.add('hidden');}else{document.getElementById('save_into_active').innerHTML="Save";document.getElementById('save_into_active').classList.remove('btn-gray');}
document.body.classList.add('overflow');document.querySelectorAll(".edit-icon-content .right > div").forEach(function(e,i){e.classList.toggle('active',!i);});document.querySelectorAll(".edit-icon-content .right header button").forEach(function(e,i){e.classList.toggle('active',!i);});document.querySelector(".edit-icon-content").className='edit-icon-content edit-color';_SVG_edit.load(data,detail);}
else
{Widget.reset_widget();document.body.classList.remove('overflow');document.querySelectorAll(".icon.collectionIcon .edit input[type=radio]:checked").forEach(function(input){input.checked=false;});}
$('.edit-icon-overlay').toggleClass("loading ready",open);}
Widget.restoring=false;Widget.changeIconColor=function(color,elem,preventSetting,preventEmiting,isLight,fromCollectionSet){var ico=$(elem).parents('.icon')[0];var collection=$(elem).parents('.collection')[0];if(ico){[].forEach.call(ico.querySelectorAll("path, circle, ellipse, polygon, line, rect, polyline"),function(p){if(p.hasAttribute("fill")&&p.getAttribute("fill")=='none'&&(!p.hasAttribute("stroke")||p.hasAttribute("stroke")&&p.getAttribute("stroke")=='none'))
{p.parentNode.removeChild(p);return true;}
if(p.hasAttribute("stroke")&&p.getAttribute("stroke")!='none')
{p.setAttribute('stroke',"#"+color);}else{p.style.fill="#"+color;}});if(isLight){ico.classList.add('whitebg');}else{ico.classList.remove('whitebg');}
Widget.markSelectedColor(color,ico);if(ico.dataset.color!=color){ico.dataset.color=color;if(!preventSetting){var key=['icoChangeColor',ico.dataset.id,collection.dataset.bookmark].join("_");if(collection.dataset.bookmark=='tour_demo_collection')return;clearTimeout(window[key]);window[key]=setTimeout(function(){Icon.set(ico.dataset.id,{color:color},collection.dataset.bookmark,preventEmiting);ga('send','event','Collection','Change Icon Color',color,{'dimension11':color});delete window[key];},500);}}}}
Widget.isLight=function(color){var r=parseInt(color.substr(0,2),16);var g=parseInt(color.substr(2,2),16);var b=parseInt(color.substr(4,2),16);return((r*299)+(g*587)+(b*114))>=225000;}
Widget.changeCollectionColor=function(color,elem){var collection=$_(".collection[data-order='0']"),update=collection.dataset.color!=color,current_color=collection.dataset.color,icons;if(!update)return;collection.dataset.color=color;Widget.markSelectedColor(color,collection);icons=collection.querySelectorAll('.icon:not([data-color="XXXXXX"]) svg');if(icons){var isLight=Widget.isLight(color);[].forEach.call(icons,function(svg){Widget.changeIconColor(color,svg,false,true,isLight,true);});}
if(collection.dataset.bookmark=='tour_demo_collection')return;clearTimeout(window.changeCollectionColorInterval);window.changeCollectionColorInterval=setTimeout(function(){if(!window.firstColorChange){Collection.set(collection.dataset.bookmark,{color:color,force:true,old_color:current_color});ga('send','event','Collection','Change Color',color,{'dimension11':color});}
if(window.firstColorChange){delete window.firstColorChange;}},500);}
Widget.updateButtons=function(){var count=db.queryAll("list",{query:{status:1}}).length;if(db.tableExists('tour_demo_collection')){count--;}
if(count>Collection.limit.collections){Collection.limitReached();}
var collection=Collection.getActive();var countIcons=db.rowCount(collection.bookmark_id);var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");var options=elem.querySelector('.menu-options ul.collection-options');if(options)
{if(countIcons>0){options.querySelector('.flaticon-collection_sort').removeAttribute('disabled');options.querySelector('.flaticon-edit_collection_icons').removeAttribute('disabled');elem.querySelector('.collection-backup-download').classList.remove('disabled');}else{options.querySelector('.flaticon-collection_sort').setAttribute('disabled','disabled');options.querySelector('.flaticon-edit_collection_icons').setAttribute('disabled','disabled');elem.querySelector('.collection-backup-download').classList.add('disabled');}}
if(!gr.auth.me.premium)
{var disable_duplicate_btn=(count>=Collection.limit.collections);var duplicate_collections_buttons=document.querySelectorAll(".collection-options .flaticon-duplicate");if(duplicate_collections_buttons)
{[].forEach.call(duplicate_collections_buttons,function(duplicate_btn){duplicate_btn.disabled=disable_duplicate_btn;});}}
if(!gr.auth.logged)
{[].forEach.call(document.querySelectorAll(".collection .flaticon-share"),function(share_btn){share_btn.parentNode.dataset.tooltip=messages.collection.share_disabled;share_btn.disabled=true;});}
if(count>1){$_("#list_collections_btn").removeAttribute('disabled');}
else
{$_("#list_collections_btn").setAttribute('disabled','disabled');}
$_("#new_collection_btn").disabled=(Collection.limit.collections&&db.queryAll("list").length>=Collection.limit.collections);Collection.fetch(true);}
Widget.updateToggle=function(){var toggle=$_('#collections-toggle');var collection=Collection.getActive();if(!collection)return;var count=db.rowCount(collection.bookmark_id);var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");if(elem)
{elem.querySelector('.badge.badge-gray').innerHTML=count;var onlyColor=db.queryAll(collection.bookmark_id,{query:{color:'XXXXXX'}}).length==count;var onlyPersonalIcons=db.queryAll(collection.bookmark_id,{query:{premium:4}}).length==count;if(collection.status){elem.querySelector('.collection-content .download-holder button').disabled=!Boolean(count);var holder=elem.querySelector(".collection-options .color_btn_holder");if(holder)
{holder.dataset.tooltip=(!Boolean(count)||onlyColor)?messages.collection.color_disabled:messages.filters.color;}
var iconfont_button=elem.querySelector(".collection-download .download-files .download button[data-format='iconfont']");iconfont_button.disabled=onlyColor;iconfont_button.parentNode.dataset.tooltip=(onlyColor)?messages.collection.iconfont_disabled:messages.collection.iconfont_tooltip;var psd_button=elem.querySelector(".collection-download .download-files .download button[data-format='psd']");var eps_button=elem.querySelector(".collection-download .download-files .download button[data-format='eps']");var png_button=elem.querySelector('.collection-download .download-files .download a[data-format="png"]');var iconfont_button=elem.querySelector('.collection-download .download-files .download button[data-format="iconfont"]');psd_button.disabled=onlyPersonalIcons;if(onlyPersonalIcons)
{iconfont_button.classList.add('disabled');}
else
{iconfont_button.classList.remove('disabled');}}
var badge=toggle.querySelector('.badge');if(count)
{badge.classList.remove('hidden')
badge.innerHTML=count;}
else
{badge.innerHTML=0;}
badge.classList.add('animate');var badgeTimeout=setTimeout(function(){clearTimeout(badgeTimeout);badge.classList.remove('animate');Widget.updateIconsColorSvg();toggle.classList.remove('loading');$_("#collections").classList.remove('loading');},500);if(!db.rowCount(collection.bookmark_id))Widget.clear();}
Widget.updateColoringCollectionButton(onlyColor,collection.bookmark_id);}
Widget.updateColoringCollectionButton=function(disable_button,active_collection){if(!document.querySelector('section[data-bookmark="'+active_collection+'"] .toggle-paint')){return false;}
if(disable_button){document.querySelector('section[data-bookmark="'+active_collection+'"] .toggle-paint').setAttribute('disabled',true);}else{document.querySelector('section[data-bookmark="'+active_collection+'"] .toggle-paint').removeAttribute('disabled');}}
Widget.renderIcons=function(icons,collection){if(!window.loading_svg)
{window.loading_svg={};window.loading_svg[collection.dataset.bookmark]=true;}
else
{if(window.loading_svg.hasOwnProperty(collection.dataset.bookmark))
{return false;}}
$_("#collections-toggle").classList.add('loading');var list=collection.get('.icons');if(list.childElementCount>1)return;var tpl=false;var load=false;var orders=[];var reorder=false;icons.forEach(function(icon){var ico=collection.get('.icons .collectionIcon[data-id="'+icon.id+'"]');if(icon.sort<=icons.length&&icon.sort!=0&&icon.sort!=null&&orders.indexOf(parseInt(icon.sort,10))==-1)orders.push(parseInt(icon.sort,10));else reorder=true;if(!ico){if(!tpl){tpl=Handlebars.tag('collection-icon');}
load=true;if(icon.premium!=4){icon.not_personal=true;}
list.querySelector('.icon-upload').insertAdjacentHTML('afterend',tpl(icon));};});if(reorder){Widget.reorderIcons(collection,true);}
if(icons.length){var li_alignment='';var j=30;while(--j)
{li_alignment+='<li class="icon-fill icon"></li>';}
list.insertAdjacentHTML('beforeend',li_alignment);}
if(load){[].forEach.call($_(".collectionIconImage"),function(i){Widget.renderSVG(i);});}
var icons_length=icons.length;if(collection.status){collection.get("button.collection_color_button").disabled=!icons_length;collection.get("button.flaticon-edit_collection_icons").disabled=!icons_length;collection.get('.badge.badge-gray').innerHTML=icons_length;collection.classList.toggle('limit-reached',icons_length>=Collection.limit.icons);}
Widget.markSelectedColor(collection.color,collection);}
Widget.renderCollection=function(data){var count=db.rowCount("list"),collection=$_(".collection[data-bookmark='"+data.bookmark_id+"']");if(!collection){var tpl=Handlebars.tag('collection'),elem=document.getElementById("collections-holder");elem.insertAdjacentHTML('beforeend',tpl(data));collection=$_(".collection[data-bookmark='"+data.bookmark_id+"']");}
if(!data.order){var collectionHeight=count>1?(count.length>2?'collection-height-2':'collection-height-1'):'';if(collectionHeight.length){collection.classList.add(collectionHeight);}
collection.classList.add('expanded');if(data.icons.length){Widget.renderIcons(data.icons,collection);}}else{collection.classList.remove('expanded','collection-height-2','collection-height-1');}
collection.get('.badge.badge-gray').innerHTML=data.icons.length;}
Widget.updateIconsColorSvg=function(){qq('.icon.collectionIcon:not([data-color="XXXXXX"])').forEach(function(icon){var isLight=Widget.isLight(icon.dataset.color);var svg=icon.getElementsByTagName('svg');Widget.changeIconColor(icon.dataset.color,svg,false,true,isLight,true);});}
Widget.update=function(loading,lock_collection_holder){var count=db.rowCount("list");if(!count){Collection.new();return;}
$_(".collection-section-header .collections-number").innerHTML=count;var cssProps=['-webkit-box-ordinal-group','-moz-box-ordinal-group','box-ordinal-group','-webkit-order','-moz-order','order','-ms-flex-order',''];db.queryAll('list',{sort:[["order","ASC"]]}).forEach(function(collection,order,list){if(!loading&&(collection.order!=order||(order&&collection.active))){db.update("list",{bookmark_id:collection.bookmark_id},function(row){row.order=order;row.active=(!order)?1:0;return row;});db.commit();collection.order=order;collection.active=(!order)?1:0;}
var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");collection.icons=db.queryAll(collection.bookmark_id,{sort:[['sort','ASC']]});if(!elem){window.firstColorChange=true;Widget.renderCollection(collection);elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");}
elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");elem.style.cssText=cssProps.join(":"+order+";");elem.dataset.order=order;if(order){elem.classList.remove("expanded");}else{var collectionHeight=list.length>1?(list.length>2?'collection-height-2':'collection-height-1'):'collection-height';if(!lock_collection_holder){elem.classList.add("expanded");}
if(collectionHeight.length&&elem.classList.contains(collectionHeight)){elem.classList.add(collectionHeight);}
if(collection.icons.length){Widget.renderIcons(collection.icons,elem);}}});window.launching=null;Widget.markSelectedIcons();Widget.updateToggle();Widget.updateButtons();}
Widget.setLimits=function(collection){if(!collection)return false;var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");elem.get('.max-icons-collection').style.display='none';elem.get('.icons-collection-noregister').style.display='none';if(collection.icons.length)
{elem.querySelector('.flaticon-edit_collection_icons').removeAttribute('disabled');}
if(collection.icons.length>=Collection.limit.icons){if(gr.auth.me.id){if(!gr.auth.me.premium)
{elem.get('.max-icons-collection').style.display='block';UserAlerts.danger('Ooop!',messages.limit.registered);}
else
{elem.classList.add('limit-reached');}}else{elem.get('.icons-collection-noregister').style.display='block';UserAlerts.danger('Ooop!',messages.limit.guest);}}
else
{elem.classList.remove('limit-reached');}}
Widget.markSelectedColor=function(color,elem){var selector=(elem.classList.contains('icon'))?".color-selector button":".collection-options .color-selector button";var elems=elem.find(selector);if(elems){[].forEach.call(elems,function(btn){if(btn.dataset.color==color){btn.classList.add('selected');}else{btn.classList.remove('selected');}});}}
Widget.show=function(){$_("#collections").classList.add("visible");$_("#viewport").classList.add('collections-visible');localStorage.widget_active=1;}
Widget.toggle=function(){var widget=$_("#collections"),active=Number(widget.classList.toggle("visible")),method=(active)?'add':'remove';$_("#viewport").classList[method]('collections-visible');checkHybriDevices();widget.classList[method]('visible');localStorage.widget_active=active;$(window).resize();ga('send','event','Collection','Toggle',(active)?'Show':'Hide');}
Widget.createIconsCPicker=function(id,bookmark){if(id instanceof(Element)){var cpicker=id.parent(".collectionIcon").get(".icon-cpicker");var items=$(cpicker);}else{var selector=(typeof id!='undefined')?".collection[data-bookmark='"+bookmark+"'] .icon[data-id='"+id+"'] .icon-cpicker":".collection .icon .icon-cpicker";var items=$(selector);}
items.each(function(){var icon=this.parent(".icon"),color=icon.dataset.color.toUpperCase();var picker=$(this);if(!picker.data().hasOwnProperty("colpickId")){this.innerHTML='';picker.colpick({flat:true,layout:'hex',submit:0,color:color,onChange:function(a,hex,b,elem){Widget.changeIconColor(hex.toUpperCase(),elem,false,false,Widget.isLight(hex));}});}
Widget.changeIconColor(color,this,true,true,Widget.isLight(color));});}
Widget.createCollectionCPicker=function(){var color;$(".collection[data-order='0'] .col-cpicker").each(function(){color=this.parent(".collection").dataset.color.toUpperCase();var picker=$(this);if(!picker.data().hasOwnProperty("colpickId")){this.innerHTML='';window.firstColorChange=true;var timeout=undefined;picker.colpick({flat:true,layout:'hex',submit:0,color:color,onChange:function(a,hex,c,elem){Widget.changeCollectionColor(hex.toUpperCase(),elem);}});picker.colpickSetColor(color);delete window.firstColorChange;}});}
Widget.markSelectedIcons=function(bookmark_id){if(!bookmark_id){var active=Collection.getActive();if(!active)return;bookmark_id=active.bookmark_id;}
var icons=$_(".icon:not(.collectionIcon):not(.icon-upload):not(.icon-fill)");if(icons){[].slice.call(icons).forEach(function(ico){ico.classList.remove('selected');var btn=ico.get(".overlay button");btn.classList.add('flaticon-collections_add');btn.classList.remove('flaticon-collections_remove');});}
db.queryAll(bookmark_id).forEach(function(icon){Icon.toggle(icon.id);});}
Widget.addIcon=function(icon,name,author,color,premium,custom_color){if(typeof icon=='undefined')return false;if(!parseInt(icon)&&!parseInt(icon.id)){return false;}
if(window.location.pathname.indexOf('search')==1)
{track_add_collection(window.location.search,icon,premium);}
premium=(icon.premium==1)?1:parseInt(premium,10);if(premium==1&&!gr.auth.me.premium){UserAlerts.warning('Ooops!',messages.collection.add_premium);return false;}
var collection=Collection.getActive();if(!collection.status){console.info('Aadiendo icono');UserAlerts.warning('Ooops!',messages.collection.locked);return false;}
var elem=$_(".collection[data-bookmark='"+collection.bookmark_id+"']");elem.querySelector('.collection_icons_list').classList.remove('empty');var premium_advise=elem.get('.collection-content .premium-advise');if(premium_advise)premium_advise.style.display='none';if(!window.launching&&db.rowCount(collection.bookmark_id)>=Collection.limit.icons){if(gr.auth.me.id)
{elem.get('.max-icons-collection').style.display='block';if(!gr.auth.me.premium)
{UserAlerts.danger('Ooop!',messages.limit.registered);}
else
{UserAlerts.danger('Ooop!',messages.limit.collection);}}
else
{elem.get('.icons-collection-noregister').style.display='block';UserAlerts.danger('Ooop!',messages.limit.guest);}
var badge=$_('#collections-toggle .badge');badge.classList.add('animate');var badgeTimeout=setTimeout(function(){clearTimeout(badgeTimeout);badge.classList.remove('animate');},300);return;}
var sort=1;if(arguments.length>1){var collection=Collection.getActive();sort=parseInt(db.queryAll(collection.bookmark_id).length,10)+1;icon={id:parseInt(icon,10),name:slug(name),color:(color=="2")?'XXXXXX':custom_color?custom_color:collection.color,premium:premium||0,sort:sort};if($_("section #detail .customize.active")&&color=='1'){if(typeof localStorage.color!='undefined'){icon.color=localStorage.color.replace('#','');}else{var input=$_("section #detail #detail_picker .colpick_hex_field input");icon.color=(input)?input.value:collection.color;}}}
if($_("#detail")){saveColor(localStorage.color);}
if(!elem.classList.contains('expanded')&&!window.launching){elem.classList.add('expanded');}
if(gr.auth.me.premium)
{var warning_tit=messages.external_icon.title;var warning_txt=messages.external_icon.message;var located_icon=false;if(typeof document.getElementById('detail')!='undefined'&&document.getElementById('detail')!=null)
{if($_('#download-form #icon_id').value==icon.id)
{located_icon=true;if($_('#download-form #selection').value==0)UserAlerts.warning(warning_tit,warning_txt,0);}}
if(!located_icon&&$_('ul.icons .icon[data-id="'+icon.id+'"]'))
{if(($('ul.icons .icon[data-id="'+icon.id+'"] .flaticon-selection').length==0)&&($('ul.icons .icon[data-id="'+icon.id+'"] .flaticon-premium').length==0))
{if(!Widget.restoring)UserAlerts.warning(warning_tit,warning_txt,0);}}}
var element_svg;if(icon.premium==4||typeof src!='undefined')
{var img=document.createElement('img');if(typeof src!='undefined')
{img.id=icon.id;img.dataset.premium=icon.premium
img.dataset.src=src;}
else
{img.id=icon.icon;img.dataset.premium=4;img.dataset.src=urlUserIcon(icon.icon);}
element_svg=img;$_(".collection[data-order='0'] .collection_icons_list.icons .icon-upload").insertAdjacentHTML('afterend',Handlebars.tag('collection-icon')(icon));}
else
{icon.not_personal=true;if(!elem.get(".icon.collectionIcon[data-id='"+icon.id+"']")){if(!$_(".collection[data-order='0'] .collection_icons_list.icons .icon-upload")){Collection.setActive();}
$_(".collection[data-order='0'] .collection_icons_list.icons .icon-upload").insertAdjacentHTML('afterend',Handlebars.tag('collection-icon')(icon));element_svg=$_(".collection[data-order='0'] .icons .collectionIcon[data-id='"+icon.id+"'] img");}}
if(element_svg){Widget.renderSVG(element_svg);}
if(!db.queryAll(collection.bookmark_id,{query:{id:icon.id}}).length){var date=getTimestamp();var author=icon.author||0;new Icon(icon.id,slug(icon.name),author,icon.color,collection.bookmark_id,icon.premium,icon.sort);Widget.updateToggle();Widget.updateButtons();Icon.toggle(icon.id);var icon_data={};Icon.properties.forEach(function(field){icon_data[field]=icon[field];});icon_data.bookmark_id=collection.bookmark_id;db.update("list",{bookmark_id:collection.bookmark_id},function(collection){collection.updated=date;return collection;});db.commit();icon_data.updated=date;icon_data.created=date;var icon_param=icon;if(typeof icon_param=='number')icon_param={id:icon};var params={icon:icon_param,name:name,author:author,color:color,premium:premium,custom_color:custom_color};if(typeof History_Collection!='undefined')History_Collection.icon_add(icon.id,params);Collection.emit('put_icon',icon_data);ga('send','event','Collection','Add Icon',icon.id);}}
Widget.delIcon=function(id){var date=getTimestamp();var widgetIcon=$_(".collection[data-order='0'] .collectionIcon.selected[data-id='"+id+"']");if(widgetIcon){var col_elem=widgetIcon.parent(".collection"),bookmark_id=col_elem.dataset.bookmark,icoList=widgetIcon.parentElement,premium=widgetIcon.dataset.premium,name=widgetIcon.dataset.name,custom_color=widgetIcon.dataset.color,src=widgetIcon.dataset.src;var color=(custom_color='XXXXXX')?2:1;icoList.removeChild(widgetIcon);if(!icoList.children.length){icoList.innerHTML='';}
Collection.emit('del_icon',{bookmark_id:bookmark_id,id:id,updated:date,premium:premium});}
if(!bookmark_id||!db.tableExists(bookmark_id)){return false;}
var params={icon:{id:id},id:id,name:name,author:0,color:color,premium:premium,custom_color:custom_color,src:src};if(typeof History_Collection!='undefined')History_Collection.icon_del(id,params);db.deleteRows(bookmark_id,{id:id});db.update("list",{bookmark_id:bookmark_id},function(collection){collection.updated=date;return collection;});db.commit();Icon.toggle(id);Widget.updateToggle();Widget.limitsCollection(bookmark_id);ga('send','event','Collection','Remove Icon',id);Widget.updateButtons();}
Widget.replaceSvg=function(data){var index=window.requestedSVG.indexOf(data.id);if(index>-1){window.requestedSVG.splice(index,1);}
var img;var icon=$_(".collection[data-bookmark='"+data.bookmark+"'] .icon[data-id='"+data.id+"']");if(!icon){img=$_(".collection .icon[data-id='"+data.id+"'] img");if(img){icon=$_(".collection .icon[data-id='"+data.id+"']");}else{return;}}
if(!img){img=icon.get('img');}
if(!img){return;}
if(!data.svg){icon.parentElement.removeChild(icon);var date=getTimestamp();Collection.emit('del_icon',{bookmark_id:data.bookmark,icon:data.id,updated:date});db.deleteRows(data.bookmark,{id:data.id});db.update("list",{bookmark_id:data.bookmark},function(collection){collection.updated=date;return collection;});db.commit();return;}
var svg=data.svg.getElementsByTagName('svg')[0];svg.setAttribute("width",48);svg.setAttribute("height",48);svg=typeof ie!=="undefined"?cloneToDoc(svg):svg;if(!svg||!img){return;}
img.parentElement.replaceChild(svg,img);Widget.createIconsCPicker(data.id,data.bookmark);function cloneToDoc(node,doc){if(!doc)doc=document;var clone=doc.createElementNS(node.namespaceURI,node.nodeName);for(var i=0,len=node.attributes.length;i<len;++i){var a=node.attributes[i];if(/^xmlns\b/.test(a.nodeName))continue;clone.setAttributeNS(a.namespaceURI,a.nodeName,a.nodeValue);}
for(var i=0,len=node.childNodes.length;i<len;++i){var c=node.childNodes[i];clone.insertBefore(c.nodeType==1?cloneToDoc(c,doc):doc.createTextNode(c.nodeValue),null)}
return clone;}}
Widget.renderSVG=function(elem){elem.removeAttribute("onload");var collection=elem.parent(".collection");var dbCollection=Collection.getActive();if(!dbCollection.status){elem.src=elem.dataset.src;return false;}
var collection_icons=collection.querySelectorAll('.collection_icons_list.icons li.icon');if(collection_icons.length>0&&collection_icons.length<=2){var li_alignment='';var j=30;while(j--)
{li_alignment+='<li class="icon-fill icon"></li>';}
collection.querySelector('.collection_icons_list.icons').insertAdjacentHTML('beforeend',li_alignment);}
var icon=elem.parent(".icon");if(icon.dataset.premium==4)
{elem.src=(icon.dataset.id)?urlUserIcon(icon.dataset.id):elem.src;}
if(icon.dataset.color=='XXXXXX'||(parseInt(elem.dataset.premium,10)==1&&!gr.auth.me.premium)){if(gr.auth.me.premium==1&&parseInt(elem.dataset.premium,10)==1)
{var img=elem.dataset.src.replace("/static/","/premium-icon/").replace('image.flaticon.com/','www.flaticon.com/premium-icon/');}
else
{var img=elem.dataset.src;}
elem.classList.remove("collectionIconImage");elem.src=img;elem.removeAttribute("data-src");icon.dataset.src=img;return false;}
if(collection!==null&&icon!==null){if(collection.get('.collectionIcon[data-id="'+icon.dataset.id+'"] svg')){return false;}
Widget.getSVGCode({id:icon.dataset.id,bookmark:dbCollection.bookmark_id,src:elem.dataset.src,premium:elem.dataset.premium});}}
Widget.getSVGCode=function(data){data.id=parseInt(data.id,10)||0;if(!window.requestedSVG){window.requestedSVG=[];}
if(window.requestedSVG.indexOf(data.id)===-1){window.requestedSVG.push(data.id);}else{return;}
var req=new XMLHttpRequest();if(!data.bookmark||!data.id||!data.src)return;req.onreadystatechange=function(){if(req.readyState==4&&req.status==200){Widget.replaceSvg({svg:req.responseXML,id:data.id,bookmark:data.bookmark});}
if(req.status==404)
{Widget.delIcon(data.id);return;}}
var parser=document.createElement("a");parser.href=data.src.replace("/static","");if(data.premium==1)req.open("GET",'/premium-icon/'+parser.pathname.substr(1),true);else req.open("GET",data.src,true);req.send();}
Widget.clear=function(){if(document.querySelectorAll(".collection[data-order='0']").length)
{document.querySelectorAll(".collection[data-order='0'] ul.icons li.icon").forEach(function(icon)
{if(!icon.classList.contains('icon-upload'))this.innerHTML='';});$_(".collection[data-order='0'] .collection_icons_list").classList.add('empty');}}
Widget.scroll=function(x,y)
{var css_selector='ul.collection_icons_list'
var element=$(css_selector);var container_top=$(css_selector).offset().top;var scroll_top=element.scrollTop()
var container_height=element.outerHeight()||element.height();var range=80;if(y>container_height-range+container_top)
{setTimeout(function(){element.scrollTop(scroll_top+range)},100);return;}
if(scroll_top>0&&(y<(range)+container_top))
{setTimeout(function(){element.scrollTop(scroll_top-range)},100);return;}}
Widget.reorderIcons=function(collection,send_data)
{var icons=[];var li=document.querySelectorAll('.collection[data-bookmark="'+collection.dataset.bookmark+'"] ul.collection_icons_list li.collectionIcon.icon');var len=li.length;li.forEach(function(li){icons.push({'id':li.dataset.id,'sort':len});li.dataset.sort=len;Icon.set(li.dataset.id,{sort:len},collection.dataset.bookmark,true);len--;});if(send_data)Collection.updateReorder(collection.dataset.bookmark,icons);}
Widget.removeEmptyIcons_old=function()
{document.querySelectorAll('ul.collection_icons_list .empty-icon').forEach(function(ico){ico.parentNode.removeChild(ico);});document.querySelectorAll('ul.collection_icons_list .dragHover').forEach(function(ico){ico.classList.remove('dragHover');});}
Widget.addEmptyIcon_old=function(cloned,move)
{if(cloned.dataset.id==move.dataset.id)return false;Widget.removeEmptyIcons();cloned.classList.add('empty-icon');if(cloned.nodeName=='LI'&&document.querySelectorAll('.collection_icons_list .collectionIcon[data-id="'+move.dataset.id+'"]').length)
{var collection=Collection.getActive();document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"] ul.collection_icons_list').insertBefore(cloned,move);}}
Widget.moveIcon=function(icon,move)
{if(icon.dataset.id==move.dataset.id)return false;if(icon.nodeName=='LI'&&document.querySelectorAll('.collection_icons_list .collectionIcon[data-id="'+move.dataset.id+'"]').length)
{var collection=Collection.getActive();document.querySelector('.collection[data-bookmark="'+collection.bookmark_id+'"] ul.collection_icons_list').insertBefore(icon,move);icon.dataset.sort=parseInt(move.dataset.sort,10)+1;}}
Widget.downloading=function()
{var date=new Date();date.setTime(date.getTime()+(30*1000));var expires="; expires="+date.toGMTString();document.cookie="download_collection=1"+expires+"; path=/";document.getElementById('collections').classList.add('loading');document.querySelector('.collection.expanded .download-holder button').classList.add('disabled');set_download_counter();}
Widget.reset_widget=function(force){document.querySelector('.only_registered').classList.add('hidden');document.querySelector('.only_registered .alert_no_user').classList.remove('hidden');document.querySelector('.only_registered .alert_icon_gradient').classList.add('hidden');document.querySelector('.edit-icons-user-actions .free_user_warning').classList.add('hidden');document.querySelector('.edit-icons-user-actions .collection_limit').classList.add('hidden');document.querySelector(".edit-icon-content .edit-icons-user-actions #download_button").classList.remove('hidden');document.querySelector('.edit-icons-user-actions .collection_locked').classList.add('hidden');document.getElementById('save_into_active').classList.remove('hidden');document.getElementById('save_into_active').disabled='';document.getElementById('duplicate_icon').disabled='';}
var var_set_download_counter;function set_download_counter()
{var_set_download_counter=setInterval('check_downloading()',1500);}
function check_downloading()
{var name="download_collection=";var ca=document.cookie.split(';');for(var i=0;i<ca.length;i++){var c=ca[i];while(c.charAt(0)==' ')c=c.substring(1);if(c.indexOf(name)==0)return;}
document.querySelector('.collection.expanded .download-holder button').classList.remove('disabled');document.getElementById('collections').classList.remove('loading');clearTimeout(var_set_download_counter);}
Handlebars.registerHelper('maxCollectionIcons',function(){return Collection.limit.icons;});Handlebars.registerHelper('iconLocked',function(){return((this.premium==1&&!gr.auth.me.premium))?' locked':(this.premium==4)?' personal-icon':'';});Handlebars.registerHelper('icoImg',function(){var folder=Math.floor(this.id/1000);if(this.premium==4)
{return urlUserIcon(this.id);}
else
{if(this.color!='XXXXXX'){if(this.premium==1&&!gr.auth.me.premium)return STATIC_URL+['icons/png/128',folder,this.id].join("/")+'.png';return STATIC_URL+['icons/svg',folder,this.id].join("/")+'.svg';}else{return STATIC_URL+['icons/png/128',folder,this.id].join("/")+'.png';}}});Handlebars.registerHelper('collectionLimitIcons',function(){var html='';var url,folder;this.icons.forEach(function(ico){if(ico.content_type==4)
{url=urlUserIcon(ico.id);}
else
{folder=Math.floor(ico.id/1000);url=STATIC_URL+['icons/png/128',folder,ico.id].join("/")+'.png';}
html+='<img src="'+url+'" name="'+ico.name+'">';});return html;});Handlebars.registerHelper('loadImg',function(a,b){if('src'in this)return this.src;if(this.premium==4)
{return urlUserIcon(this.id);}
else
{var folder=Math.floor(this.id/1000);return STATIC_URL+['icons/png/128',folder,this.id].join("/")+'.png';}});Handlebars.registerHelper('dataSearch',function(){var word=$_("#words");if(!word)return;word=word.value;return["#term=",word,"&page=",page,"&position=",this.position].join('');});Handlebars.registerHelper('shareUrl',function(){return btoa(this.bookmark_id);});Handlebars.registerHelper('setHeight',function(){return db.rowCount("list")>1?(db.rowCount("list")>2?'collection-height-2':'collection-height-1'):'';});function toggleDetailButton(){if(ModalDetail.id){toggleAxDetailButton();}else{if(typeof toggleSliderDetailButton=='function')toggleSliderDetailButton();}}
function toggleAxDetailButton(){if(window.toggleDetailBtnInterval)clearInterval(window.toggleDetailBtnInterval);var icon_id=document.querySelector('#download-form #icon_id').value,icon_name=document.querySelector('.tags li a').innerHTML,icon_team=document.querySelector('#download-form #team').value,icon_color=document.querySelector('#download-form #colored').value,icon_premium=document.querySelector('#download-form #premium').value;if(db instanceof Object){var method='addIcon';var collection=Collection.getActive();if(db.queryAll(collection.bookmark_id,{query:{id:icon_id}}).length){method='delIcon';}
var btn=$_("#detail-icon-button");var txt_btn;if(method==='delIcon'){btn.addClass('btn-danger');txt_btn=messages.collection.delete_icon;}else{btn.removeClass('btn-danger');txt_btn=messages.collection.add_icon;}
if(typeof btn.querySelector('span')!='undefined')btn.querySelector('span').innerHTML=txt_btn;btn.setAttribute('onclick',"Widget."+method+"("+icon_id+",'"+icon_name+"',"+icon_team+", "+icon_color+", "+icon_premium+")");btn.get('i').classList.toggle('flaticon-collections_remove',method=='delIcon');}else{window.toggleDetailBtnInterval=setInterval(toggleDetailButton,1000);}}
if(window.btoa==undefined)
{window.btoa=function(input){var str=String(input);var map='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';for(var block,charCode,idx=0,output='';str.charAt(idx|0)||(map='=',idx%1);output+=map.charAt(63&block>>8-idx%1*8))
{charCode=str.charCodeAt(idx+=3/4);if(charCode>0xFF){throw new InvalidCharacterError("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");}
block=block<<8|charCode;}
return output;}}
var spacing='24';document.querySelectorAll('.collection_icons_list .popover-button').forEach(function(button){var list=button.closest('.collection_icons_list');var popover=button.nextElementSibling;button.addEventListener('click',function(e){if(popover&&list){setTimeout(function(){var listBound=list.getBoundingClientRect();var popoverBound=popover.getBoundingClientRect();if(popoverBound.left<=listBound.left){var offsetX=(listBound.left-popoverBound.left)+spacing;popover.style.transform='translateX('+offsetX+'px)';}},200);}});});function qq(selector){return Array.prototype.slice.call(document.querySelectorAll(selector));};$(function(){History_Collection.set_collection();$(document).on('click','.collection-content button.flaticon-redo',function(){if(typeof History_Collection!='undefined')History_Collection.next();});$(document).on('click','.collection-content button.flaticon-undo',function(){if(typeof History_Collection!='undefined')History_Collection.prev();});})
var History_Collection={user_id:gr.auth.me.id||0,collection:{},actions:[],pointer:0,key_actions:'',key_pointer:'',executing:false,set_collection:function()
{if(typeof Collection=='undefined')return false;this.collection=Collection.getActive();this.actions=[];this.pointer=0;if((typeof this.collection!='undefined')&&Object.keys(this.collection).length)
{this.key_actions="History_Collection_Actions_"+this.collection.bookmark_id;this.key_pointer="History_Collection_Pointer_"+this.collection.bookmark_id;var storedActions=JSON.parse(sessionStorage.getItem(this.key_actions))||new Array();this.actions=storedActions;var storedPointer=JSON.parse(sessionStorage.getItem(this.key_pointer))||0;this.pointer=storedPointer;}
if(this.collection){this._toogle_cursors();}
this._purgue();},middleware:function()
{if(this.executing)return false;this.set_collection();return(typeof this.collection.bookmark_id!='undefined');},collection_delete:function(bookmark_id)
{if(!this.middleware())return;var collection=Collection.getActive();if(collection.bookmark_id==bookmark_id)
{sessionStorage.removeItem(this.key_actions);sessionStorage.removeItem(this.key_pointer);this.pointer=0;this.actions=new Array();this._toogle_cursors();}},icon_color:function(icon_id,new_color,old_color)
{if(!this.middleware())return;var history={id:icon_id,next:'color',next_value:new_value,prev:'color',prev_value:old_color};this._save(history);},icon_name:function(icon_id,new_name,old_name)
{if(!this.middleware())return;var history={id:icon_id,next:'name',next_value:new_name,prev:'name',prev_value:old_name};this._save(history);},icon_add:function(icon_id,params)
{if(!this.middleware())return;var history={id:icon_id,next:'add',next_value:params,prev:'del',prev_value:icon_id};this._save(history);},icon_del:function(icon_id,params)
{if(!this.middleware())return;var history={id:icon_id,next:'del',next_value:icon_id,prev:'add',prev_value:params};this._save(history);},collection_name:function(bookmark_id,new_name,old_name)
{if(!this.middleware())return;var history={id:bookmark_id,next:'collection_name',next_value:new_name,prev:'collection_name',prev_value:old_name};this._save(history);},collection_color:function(new_color,old_color)
{if(!this.middleware())return;var history={id:icon_id,next:'collection_color',next_value:new_color,prev:'collection_color',prev_value:old_color};this._save(history);},_save:function(history)
{this.actions=JSON.parse(sessionStorage.getItem(this.key_actions))||new Array();if(this.actions.length)this.actions=this.actions.slice(0,this.pointer);this.actions.push(history);this.pointer++;sessionStorage.setItem(this.key_actions,JSON.stringify(this.actions));this._save_pointer();},_save_pointer:function()
{sessionStorage.setItem(this.key_pointer,JSON.stringify(this.pointer));},_toogle_cursors:function()
{var collection=document.querySelector('.collection.expanded .collection-content .collection-options');if(!collection)return false;collection.querySelector('button.flaticon-redo').classList.toggle('disabled',this.pointer>=this.actions.length);collection.querySelector('button.flaticon-undo').classList.toggle('disabled',this.pointer<=0);},_get:function(pointer)
{if(pointer>this.pointer)pointer=this.pointer;var i=pointer||this.pointer;return this.actions.slice(i-1,i)[0];},prev:function()
{if(!this.middleware())return;if(this.pointer>0)
{var history=this._get();this.pointer--;this._execute(history,'prev');this._toogle_cursors();}
else
{return false;}},next:function()
{if(!this.middleware())return;if(this.pointer<this.actions.length)
{this.pointer++;var history=this._get();this._execute(history,'next');this._toogle_cursors();}
else
{return false;}},_execute:function(history,direction)
{if(typeof direction=='undefined')direction='prev';if(typeof history[direction]=='undefined')return false;var action=history[direction];var data=history[direction+'_value'];this.executing=true;this._save_pointer();switch(action)
{case'add':if(data.icon.id>999999999){var icon_color=(data.color)?data.color:data.icon.color;var icon_name=(data.name)?data.name:data.icon.name;var icon_author=gr.auth.me.id;var icon_personal='4'
var color=(data.icon.color=="XXXXXX")?"2":"1";color=(icon_color=="2")?icon_color:color;Widget.addIcon(data.icon.id,icon_name,icon_author,color,icon_personal);}else{Widget.addIcon(data.icon.id,data.name,data.author,data.color,data.premium,data.custom_color);}
break;case'del':Widget.delIcon(history.id);break;case'name':break;case'color':break;case'name_collection':break;case'color_collection':break;case'clear_collection':break;default:}
this.executing=false;},_purgue:function()
{var n=this.actions.length;if(n)
{for(var i=0;i<n;i++)
{if(typeof this.actions[i]=='undefined')break;}
n=this.actions.length;if(n>20)this.actions.splice(0,n-20);sessionStorage.setItem(this.key_actions,JSON.stringify(this.actions));if(this.pointer>n)
{this.pointer=n;this._save_pointer();}}},_debug:function(msg)
{console.log('|====================== DEBUG ====>',msg,'|== POINTER =>',this.pointer,'|== ACTIONS =>',this.actions);}};var _SVG_edit=(function(){Node.prototype.addClass=function(a){this.classList.add(a);}
Node.prototype._one=function(a){return this.querySelector(a);}
Node.prototype._all=function(a){return this.querySelectorAll(a);}
NodeList.prototype.addClass=function(a){this.forEach(function(e){e.classList.add(a);});}
Node.prototype.removeClass=function(a){this.classList.remove(a);}
NodeList.prototype.removeClass=function(a){this.forEach(function(e){e.classList.remove(a);});}
Node.prototype.toggleClass=function(a,b){this.classList.toggle(a,b);}
NodeList.prototype.toggleClass=function(a,b){this.forEach(function(e){e.classList.toggle(a,b);});}
function _id(a){return document.getElementById(a);}
function _one(a){return document.querySelector(a);}
function _all(a){return document.querySelectorAll(a);}
var __SELECTOR__="#icons-holder svg g:not(#grid-wrapper)";var svg_wrapper=_one(".edit-icon-content #icons-holder .icon-holder");var icon_name_input=_one(".edit-icon-content .edit-name input");var picker_element=_id('icon-edit-color-picker');var pickers_wrapper=_one('.pickers-wrapper');var _icon;var svg_element;var g;var _viewBox;var _BBox;var _degrees=0;var _flipX=false;var _flipY=false;var _x=0;var _y=0;var _originalMatrix=null;var _moveFactor=5;var _grid=null;var _gridValue=0;var colors=[];var _detail_icon=false;var _clean_icon=true;var picker_clicked=false;var icon_transformed=false;var _overrideButton=_id("override_icon");var _duplicateButton=_id("duplicate_icon");var _settingButtons=_all(".edit-icon-content .right button");var _undoBtn=_id("_svg_editor_undoBtn");var _redoBtn=_id("_svg_editor_redoBtn");var _resetBtn=_id("_svg_editor_resetBtn");var _gridSelect=_one(".edit-icon-content .icon-edit-grid");var picker=new ColorPicker(picker_element,function(color){_all(__SELECTOR__+" .active-path").forEach(function(p){if(p.getAttribute("style")){var old_color=p.getAttribute("style").replace("fill:",'').replace(';','');if(old_color!=color.toUpperCase()){p.setAttribute('data-old_color',old_color);}}
p.style.fill='';p.setAttribute("style",'');p.setAttribute("style",(p.getAttribute("style")||'')+"fill:"+color.toUpperCase());});});_all(".download-settings button").forEach(function(btn){btn.addEventListener('click',function(){var size=(this.getAttribute('data-size'))?this.getAttribute('data-size'):'512';var format=this.getAttribute('data-format');svg_element.setAttribute("width",size);svg_element.setAttribute("height",size);var svg=document.querySelector('#icons-holder .icon-holder').innerHTML;if(this.classList.contains('png_dropper')){this.parentNode.parentNode.querySelector('.customize').classList.add('active');return;}
switch(format){case'base64':var encoded=btoa(svg);var imgURI="data:image/svg+xml;base64,\n"+encoded;if(format=='svg'){_triggerDownload(imgURI,'svg');}else{fillBase64Form({data:imgURI});}
break;case'svg':case'eps':case'png':case'jpeg':_serverDownload(svg,format,size);break;default:return;break;}
_trackDownload(format,size);function _trackDownload(format,size){var formData=new FormData();if(_detail_icon){track_download();var team=_one("#download-form #team").value;formData.append("team",team);}
else
{var team=~gr.auth.me.id;}
formData.append("id",_icon.id);formData.append("format",format);formData.append("size",size);formData.append("color","#"+_icon.color);var request=new XMLHttpRequest();request.open("POST","/downloads/track-download");request.send(formData);ga('send','event','Download','Icon',format.toUpperCase(),1,{'dimension8':team,'dimension2':team,'dimension3':_icon.id,'dimension4':format.toUpperCase(),'dimension5':"#"+_icon.color,'dimension6':size,'dimension7':_icon.name});}
function _serverDownload(svg,format,size){var svg_code=svg;var form=document.createElement("form");form.method='POST';form.action=APP_URL+'downloads/edited-single-icon';form.style.display='none';for(var k in _icon){form.insertAdjacentHTML("beforeend",'<input type="text" name="{0}" value="{1}">'.format(k,_icon[k]));}
form.insertAdjacentHTML("beforeend",'<input type="text" name="format" value="'+format+'">');form.insertAdjacentHTML("beforeend",'<input type="text" name="size" value="'+size+'">');form.insertAdjacentHTML("beforeend",'<input type="text" name="code" value="'+btoa(svg_code)+'">');document.body.appendChild(form);form.submit();form.parentNode.removeChild(form);}
function _triggerDownload(imgURI,format){var a=document.createElement('a');a.setAttribute('download',_icon.name+'.'+format);a.setAttribute('href',imgURI);a.setAttribute('target','_blank');a.click();if(_detail_icon){track_download();}}
_one(".edit-icon-content .right .active").classList.remove("active");_one('.edit-icon-content .right .customize').classList.remove('active');_one(".edit-icon-content .right .edit-color").classList.add("active");_one(".edit-icon-content .right button[data-panel='edit-color']").classList.add("active");_one(".edit-icon-content").classList.remove("download-settings");_one(".edit-icon-content").classList.add("edit-color");document.querySelector("#svg-icon-colors li.color button").classList.add('active');});});_one(".edit-icon-content").addEventListener("mouseup",function(e){if(picker_clicked)return;e.stopPropagation();if(e.target){if(e.target.parentNode.matches('.edit-color .right .picker-hex')){return false;}
if(e.target.matches('.edit-color .right .colors:not(#svg-icon-colors) li.color button')){if(document.querySelector('#svg-icon-colors button.active'))__selectedColor(document.querySelector('#svg-icon-colors button.active').getAttribute('data-original'))
var path=_one(__SELECTOR__+" .active-path");if(!path)return false;__color(path.getAttribute('data-original'),e.target.getAttribute('data-original'));return false;}
if(e.target.matches(".edit-color .right #svg-icon-colors li.color button, "+__SELECTOR__+" .hovered-path")&&document.querySelector(".edit-icon-content .right button[data-panel='edit-color']").classList.contains('active')){if(!e.target.classList.contains("active")){__selectedColor(e.target.getAttribute('data-original'));var active_color=document.querySelector('#svg-icon-colors button.active').style.backgroundColor;document.querySelector(".picker-hex input").value=__formatColor(active_color).replace("#","");}
return false;}
try{if(e.target.parent("#icon-edit-color-picker")||e.target.matches('li.color button'))return false;}catch(e){}
var svg=_one(".edit-icon-content.edit-color .left .icon-holder svg:not(#grid-wrapper)");popover_render_edit(e,e.target);if(!svg)return false;}});['mouseover','mouseout'].forEach(function(ev){_one(".edit-icon-content").addEventListener(ev,function(e){if(picker_clicked)return;if(document.querySelector('#svg-icon-colors button.active'))if(document.querySelector('#svg-icon-colors button.active'))__selectedColor(document.querySelector('#svg-icon-colors button.active').getAttribute('data-original'))
if(e.target){if(e.target.matches("path, circle, ellipse, rect, polygon, line, polyline")||e.target.matches("#svg-icon-colors li.color button")){e.stopPropagation();if(!e.target.parentNode.parentNode.matches('.picker')){_all(__SELECTOR__+" *.hovered-path").removeClass("hovered-path");_all(".edit-icon-content.edit-color .left .icon-holder svg").toggleClass("hovered-paths",e.type=='mouseover');_all(".edit-icon-content.edit-color .left .icon-holder svg .active-path").removeClass('active-path');__getByFillColor(e.target.getAttribute('data-original')).toggleClass("hovered-path",e.type=='mouseover');}}}});});_id("icon-edit-color-picker").addEventListener("mousedown",function(e){picker_clicked=true;if(e.stopPropagation)e.stopPropagation();if(e.preventDefault)e.preventDefault();e.cancelBubble=true;e.returnValue=false;return false;});document.addEventListener("mousemove",function(e){e.stopPropagation();if(picker_clicked){if(document.querySelector('#svg-icon-colors button.active'))__selectedColor(document.querySelector('#svg-icon-colors button.active').getAttribute('data-original'))
var offsetTop;var offsetLeft;if(e.clientY>document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().bottom){offsetTop=document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().bottom-document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().top-7;document.querySelector('.picker-indicator').style.top=offsetTop+"px"}else if(e.clientY<document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().top){offsetTop=document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().top-document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().top-3;document.querySelector('.picker-indicator').style.top=offsetTop+"px"}else{offsetTop=e.clientY-document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().top-5;document.querySelector('.picker-indicator').style.top=offsetTop+"px"}
if(e.clientX>document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().right){offsetLeft=document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().right-document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().left-7;document.querySelector('.picker-indicator').style.left=offsetLeft+"px"}else if(e.clientX<document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().left){offsetLeft=document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().left-document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().left-3;document.querySelector('.picker-indicator').style.left=offsetLeft+"px"}else{offsetLeft=e.clientX-document.querySelector("#icon-edit-color-picker .picker-wrapper").getBoundingClientRect().left-5;document.querySelector('.picker-indicator').style.left=offsetLeft+"px"}}});$(document,".edit-icon-content","#icon-edit-color-picker").on("mouseup",function(e){if(document.querySelector('#svg-icon-colors button.active'))__selectedColor(document.querySelector('#svg-icon-colors button.active').getAttribute('data-original'))
if(picker_clicked){picker_clicked=false;no_color_shake();e.stopPropagation();setTimeout(function(){var new_color=ColorPicker.hsv2hex(picker).toUpperCase();if(!_all(".edit-icon-content.edit-color .right #last-icon-colors li.color button[data-original='"+new_color+"']").length){if(!_one('#last-icon-colors li button')){_one('#last-icon-colors').innerHTML='';}
_all('#last-icon-colors li:nth-of-type(n+10)').forEach(function(e){e.parentNode.removeChild(e);});__renderColor([new_color],'last-icon-colors',false);}
var path=svg_element.querySelector(".active-path");if(path){var selector_color=path.getAttribute('data-original');__color(selector_color,new_color);}},50);ga('send','event','editor','color','color-change-selector');}});_duplicateButton.addEventListener('click',function(){_save(false);});_overrideButton.addEventListener('click',function(){_save(true);});_gridSelect.addEventListener('change',function(){_gridChange(this.options[this.selectedIndex].value);});_redoBtn.addEventListener('click',function(){historyHandler.redo();});_undoBtn.addEventListener('click',function(){historyHandler.undo();});_resetBtn.addEventListener('click',function(){__reset();});_one(".picker-hex input").addEventListener("input",function(e){no_color_shake();if(this.value.length===parseInt(this.getAttribute('maxlength'))){var path=_one(__SELECTOR__+" .active-path");if(!path)return false;__color(path.getAttribute('data-original'),'#'+this.value);__setActiveColor('#'+this.value);ga('send','event','editor','color','color-change-input');}});[].forEach.call(_settingButtons,function(btn){btn.addEventListener('click',function(){var action=btn.getAttribute('data-action');var values=btn.getAttribute('data-values');if(values){values=values.split(" ");}
if(typeof _SVG_edit[action]=='function'){icon_transformed=true;_SVG_edit[action].apply(null,values);}});});_one("#save_into_active").addEventListener('mouseup',function(e){if(document.querySelector('#save_into_active span')){e.preventDefault();e.stopPropagation();var method=true;history.forEach(function(el,i){if(i>=historyIndex+1){return;}if(el[0]!="color")method=false;});if(_icon.isColor&&!method||_icon.isColor&&history.length>0||!_icon.isColor&&!method){_save(false);}else{var icon_value=this.parents('.edit-icon-wrapper')[0].querySelector('input.collection-icon-rename');if(icon_value&&icon_value.dataset.id){var icon_in_list=document.querySelector('.icon[data-id="'+icon_value.dataset.id+'"]');var values=[icon_in_list.dataset.id,icon_in_list.dataset.name,icon_in_list.dataset.author,icon_in_list.dataset.color,icon_in_list.dataset.premium]}else{var values=document.querySelector("#detail-icon-button").getAttribute('onclick').match(/\(([^)]+)\)/g)[0].replace(/\(|\)/g,'').split(',');}
Widget.addIcon(values[0],values[1],values[2],values[3],values[4],_icon.color);document.getElementById('save_into_active').innerHTML="Save";document.getElementById('save_into_active').classList.remove('btn-gray');document.getElementById('override_icon').style.display='';}}});$(document).keyup(function(e){if(e.keyCode==27){if(document.querySelector('.edit-icon-overlay').classList.contains('ready')){e.preventDefault();e.stopPropagation();Widget._openEditModal(false,false);}}});var _transformProperties={};function __getByFillColor(color){return(color=='#000000'&&!_icon.isColor)?_all(__SELECTOR__+" > *:not(g)"):_all(__SELECTOR__+" > [data-original='"+color+"']");}
function __selectedColor(color){_all(__SELECTOR__+" .active-path").removeClass("active-path");var paths=__getByFillColor(color);paths.addClass("active-path");var setted_color=color;if(paths.length){var p_style=paths[0].getAttribute('style');if(p_style){if(p_style.indexOf('fill')!=-1){var rgb_color;if(p_style.indexOf('%')!=-1){var re=new RegExp("rgb\(.*?\);","gi");var matches=re.exec(p_style);var color=matches[1].replace("(",'').replace(")",'').replace("%",'');var all_parts=[];[].forEach.call(color.split(','),function(part){all_parts.push(Math.round(parseFloat(part)*2.55));});rgb_color='rgb('+all_parts.join(',')+')';}else{rgb_color=p_style.replace("fill:",'').replace(';','');}
setted_color=__formatColor(rgb_color);}else{setted_color=paths[0].getAttribute('data-original');}}else if(paths[0].getAttribute('fill')){setted_color=(paths[0].getAttribute('fill')!=-1)?__formatColor(paths[0].getAttribute('fill')):paths[0].getAttribute('data-original');}}
_all(".edit-icon-content.edit-color .right #svg-icon-colors li.color button.active").removeClass("active");var element=_one(".edit-icon-content.edit-color .right #svg-icon-colors .color button[data-original='"+color+"']");if(element){element.addClass("active");}
picker.setHex(setted_color);}
function _getSVGColors(custom){if(!svg_element)return[];if(custom){var colors=[];}else{colors=[];}
svg_element.querySelectorAll("path, circle, ellipse, polygon, line, rect, polyline").forEach(updateColors);function updateColors(p){var color='#000000';var p_style=p.getAttribute('style');if(p_style){if(p_style.indexOf('fill')!=-1){var rgb_color;if(p_style.indexOf('%')!=-1){var re=new RegExp("rgb\(.*?\);","gi");var matches=re.exec(p_style);var color=matches[1].replace("(",'').replace(")",'').replace("%",'');var all_parts=[];[].forEach.call(color.split(','),function(part){all_parts.push(Math.round(parseFloat(part)*2.55));});rgb_color='rgb('+all_parts.join(',')+')';}else{rgb_color=p_style.replace("fill:",'').replace(';','');}
color=__formatColor(rgb_color);}else{color=p.getAttribute('data-original');}}else if(p.getAttribute('fill')){color=(p.getAttribute('fill')!=-1)?__formatColor(p.getAttribute('fill')):p.getAttribute('data-original');}
if(__formatColor(color)==''){p.parentNode.removeChild(p);}
color=color[0]=='#'?color:__formatColor(color);colors.push(color);if(custom!==true)p.setAttribute("data-original",color);}
colors=colors.reduce(function(accum,cur){if(accum.indexOf(cur)===-1&&cur!='')accum.push(cur);return accum;},[]);if(custom===true)return;if(colors.length==1)
{_icon.color=colors[0].substr(1);}
__renderColor(colors,'svg-icon-colors',true);__renderColor(colors,'original-icon-colors',true);}
function __renderColor(color,selector,clear){var list=_id(selector);if(clear)list.innerHTML='';color.forEach(function(c){var html='<li class="color%LC%">\
            <button data-original="%C%" style="background-color:%C%;" onclick="ga(\'send\', \'editor\', \'color\', \'color-change-last\')"></button>\
            </li>';html=html.replace("%LC%",(__isLight(c)?' color-light':'')).replace(new RegExp('%C%','g'),c);list.insertAdjacentHTML("afterbegin",html);});__setActiveColor(color[0]);}
function __setActiveColor(color){var active_color=document.querySelector('#svg-icon-colors button.active');if(active_color){active_color.style.backgroundColor=color;if(__isLight(color)){active_color.parentNode.classList.add('color-light');}else{active_color.parentNode.classList.remove('color-light');}
document.querySelector(".picker-hex input").value=color.replace("#","");}}
function _gridChange(px){var w=(!_viewBox)?100:_viewBox.width;_gridValue=parseInt(px,10);var gridWidth=w*_gridValue/svg_wrapper.clientWidth;var strokeWidth=w/250;if(!svg_element){var svg=document.createElementNS("http://www.w3.org/2000/svg","svg");svg.setAttribute('width','100');svg.setAttribute('height','100');svg.setAttribute('viewBox','0 0 100 100');svg.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink");svg_wrapper.appendChild(svg);svg_element=svg;}
_grid=svg_element.cloneNode(false);_grid.id="grid-content";_grid.style.width="321px";_grid.style.height="321px";_grid.style.position='absolute';_grid.style.pointerEvents='none';var defs='<defs>\
        <pattern id="smallGrid" width="%gW%" height="%gW%" patternUnits="userSpaceOnUse">\
        <path d="M %gW% 0 L 0 0 0 %gW%" fill="none" stroke="rgba(0,0,0,0.2)" stroke-width="%sW%"/>\
        </pattern>\
        <pattern id="grid" width="%g2W%" height="%g2W%" patternUnits="userSpaceOnUse">\
        <rect width="%g2W%" height="%g2W%" fill="url(#smallGrid)"/>\
        </pattern>\
        </defs>\
        <rect width="100%" height="100%" fill="url(#grid)"/>'.replace(new RegExp('%gW%','g'),gridWidth).replace(new RegExp('%g2W%','g'),gridWidth*4).replace(new RegExp('%sW%','g'),strokeWidth);;_grid.innerHTML=defs;var gridWrapper=_one("#grid-wrapper");document.querySelector('#grid-wrapper svg')
if(document.querySelector('#grid-wrapper svg')){document.querySelector('#grid-wrapper svg').parentNode.removeChild(document.querySelector('#grid-wrapper svg'));}
document.getElementById('grid-wrapper').insertAdjacentHTML('afterbegin',_grid.outerHTML);}
function _getSVGCode(svg){var iframe=document.createElement("iframe");iframe.style.display='none';document.body.appendChild(iframe);iframe.onload=function(){var code=iframe.getSVGDocument();if(!code){_disableButtons();return false;}
svg=code.querySelector("svg");__renderAndCleanSVG(svg,iframe);};iframe.onerror=function(){iframe.parentNode.removeChild(iframe);};iframe.src=url;}
function __renderAndCleanSVG(svg,iframe){if(svg.querySelectorAll('linearGradient').length>0)
{document.querySelector('.only_registered .alert_no_user').classList.add('hidden');document.querySelector('.only_registered .alert_icon_gradient').classList.remove('hidden');document.querySelector('.only_registered').classList.remove('hidden');return;}
g=document.createElementNS("http://www.w3.org/2000/svg","g");g.removeAttribute("xmlns");while(svg.hasChildNodes()){if(svg.firstChild.nodeType==1){g.appendChild(svg.firstChild);}else{svg.removeChild(svg.firstChild);}}
var i=g.childNodes.length;while(i--){if(g.childNodes[i].nodeType==1){g.childNodes[i].removeAttribute("xmlns");if(g.childNodes[i].innerHTML){if(!g.childNodes[i].hasAttributes()&&!g.childNodes[i].innerHTML.trim()){g.childNodes[i].parentNode.removeChild(g.childNodes[i]);}}}}
svg.appendChild(g);svg.innerHTML+=" ";svg.setAttribute("width",512);svg.setAttribute("height",512);svg_element=svg;g=svg_element.childNodes[0];svg_wrapper.appendChild(svg);g.removeAttribute("xmlns");if(iframe){iframe.parentNode.removeChild(iframe);}
_resetValues();history=[];historyIndex=-1;if(_gridValue)_gridChange(_gridValue);_enableButtons();_getSVGColors();}
function _disableButtons(){[].forEach.call(_settingButtons,function(btn){btn.disabled=true});_setUserHistoryButtons();}
function _enableButtons(){[].forEach.call(_settingButtons,function(btn){btn.disabled=false});_setUserHistoryButtons();}
function check_alerts_widget(history_reseted,event){var method=true;history.forEach(function(el,i){if(i>=historyIndex+1){return;}if(el[0]!="color")method=false;});if(!history_reseted)
{if(Collection.getActive().status){if(_icon.isColor!=1){if(!method){if(db.queryAll(Collection.getActive().bookmark_id,{query:{premium:4}}).length>=3&&!gr.auth.me.premium){if(!document.querySelector('#save_into_active span')){document.getElementById('duplicate_icon').disabled=true;document.getElementById('save_into_active').disabled=true;}else{document.getElementById('save_into_active').disabled=true;}
document.querySelector('.edit-icons-user-actions .free_user_warning').classList.remove('hidden');}else if((db.queryAll(Collection.getActive().bookmark_id).length>=256)){document.querySelector('.edit-icons-user-actions .collection_limit').classList.remove('hidden');document.getElementById('save_into_active').disabled=true;}else{document.getElementById('save_into_active').disabled=false;document.querySelector('.edit-icons-user-actions .free_user_warning').classList.add('hidden');}}else{if(db.queryAll(Collection.getActive().bookmark_id,{query:{premium:4}}).length>=3&&!gr.auth.me.premium){if(!document.querySelector('#save_into_active span')){document.getElementById('duplicate_icon').disabled=true;}
document.querySelector('.edit-icons-user-actions .free_user_warning').classList.remove('hidden');}else if((db.queryAll(Collection.getActive().bookmark_id).length>=256)){document.getElementById('duplicate_icon').disabled=true;if(!document.querySelector('#save_into_active span')){document.getElementById('duplicate_icon').disabled=true;}else{document.getElementById('save_into_active').disabled=true;}}else{document.getElementById('save_into_active').disabled=false;document.querySelector('.edit-icons-user-actions .free_user_warning').classList.add('hidden');document.querySelector('.edit-icons-user-actions .collection_limit').classList.add('hidden');}}}}}}
function _setAlertAndDownloadButton(isColor){if(gr.auth.me.status){if(Collection.getActive().status){if(isColor===1){if(db.queryAll(Collection.getActive().bookmark_id,{query:{premium:4}}).length>=3&&!gr.auth.me.premium){if(!_detail_icon&&db.queryAll(Collection.getActive().bookmark_id,{query:{id:_icon.id}})[0].premium==4){document.getElementById('duplicate_icon').disabled=true;}else{document.getElementById('save_into_active').disabled=true;}
document.querySelector('.edit-icons-user-actions .free_user_warning').classList.remove('hidden');}else if(db.queryAll(Collection.getActive().bookmark_id).length>=256){document.querySelector('.edit-icons-user-actions .collection_limit').classList.remove('hidden');document.getElementById('save_into_active').disabled=true;}else{document.getElementById('save_into_active').disabled=false;document.querySelector('.edit-icons-user-actions .free_user_warning').classList.add('hidden');}}else{if(db.queryAll(Collection.getActive().bookmark_id,{query:{premium:4}}).length>=3&&!gr.auth.me.premium){document.getElementById('duplicate_icon').disabled=true;}else if(db.queryAll(Collection.getActive().bookmark_id).length>=256){document.querySelector('.edit-icons-user-actions .collection_limit').classList.remove('hidden');if(!document.querySelector('#save_into_active span')){document.getElementById('duplicate_icon').disabled=true;}else{document.getElementById('save_into_active').disabled=true;}}}}else{document.getElementById('save_into_active').disabled=true;document.querySelector('.edit-icons-user-actions .collection_locked').classList.remove('hidden');}}else{document.querySelector('.only_registered').classList.remove('hidden');document.querySelector(".edit-icon-content .edit-icons-user-actions #download_button").classList.add('hidden');document.getElementById('save_into_active').classList.add('hidden');}}
function _setUserHistoryButtons(event){if(!history.length){_undoBtn.disabled=true;_redoBtn.disabled=true;_resetBtn.disabled=true;}else{_undoBtn.disabled=!Boolean(~historyIndex);_resetBtn.disabled=!Boolean(~historyIndex);_redoBtn.disabled=(historyIndex==history.length-1);check_alerts_widget(!Boolean(~historyIndex),event);}}
function popover_render_edit(ev,element){if(element.classList.contains('popover-content')||element.parentNode.classList.contains('popover-content')||element.parentNode.parentNode.classList.contains('popover-content'))return true;var menu=(element.tagName==="SMALL")?element.parentElement.parentElement.parentElement.get(".popover-content"):element.parentElement.parentElement.get(".popover-content");var button=document.querySelector(".edit-icon-wrapper .popover-button");removeAll();if(element.matches('.popover-button')&&!button.classList.contains("active")){menu.classList.add("show-menu");button.classList.add('active');}else{document.querySelector(".edit-icon-wrapper .popover-content").classList.remove("show-menu");document.querySelector(".edit-icon-wrapper .popover-button").classList.remove('active');}
ev.stopPropagation();function removeAll(){[].forEach.call($_(".edit-icon-wrapper .popover-content"),function(popover){if(popover==menu)return true;popover.classList.remove('show-menu');});[].forEach.call($_(".edit-icon-wrapper .popover-button"),function(btn){btn.classList.remove('active');});}}
function no_color_shake(){if(!document.querySelector('#svg-icon-colors .active')){document.querySelector('.color-tab-palette-replace h6').classList.add('shake');setTimeout(function(){if(document.querySelector('.color-tab-palette-replace h6').classList.contains('shake')){document.querySelector('.color-tab-palette-replace h6').classList.remove('shake');}},2000);return;}}
var load=function(icon,detail){svg_wrapper.innerHTML='';_icon=icon;_icon.id=~~icon.id;_icon.name=icon.name;_icon.color=icon.color=='XXXXXX'||icon.color==2?'XXXXXX':icon.color;_icon.isColor=icon.color!='XXXXXX'?0:1;_icon.premium=~~icon.premium;_detail_icon=detail===true;var _folder=Math.floor(_icon.id/1000);var bookmark=Collection.getActive().bookmark_id;var svg=document.querySelector(".collection[data-bookmark='"+bookmark+"'] .icon[data-id='"+_icon.id+"'] svg");if(svg){svg=svg.outerHTML;}
var urls={0:APP_URL+'static/icons/svg/'+_folder+"/"+_icon.id+'.svg',1:'https://'+location.host+'/premium-icon/icons/svg/'+_folder+"/"+_icon.id+'.svg',4:APP_URL+'static/user_icons/'+Math.floor(gr.auth.me.id/1000)+"/"+gr.auth.me.id+"/"+_icon.id+".svg"};url=urls[_icon.premium];_getSVGCode(svg);icon_name_input.value=_icon.name;icon_name_input.setAttribute('data-original',_icon.name);icon_name_input.setAttribute('data-id',_icon.id);_setAlertAndDownloadButton(_icon.isColor);setTimeout(function(){document.querySelector("#svg-icon-colors li.color button").classList.add('active');__selectedColor(document.querySelector("#svg-icon-colors li.color button").getAttribute('data-original'));},500);}
function _save(overwrite){var svg=document.querySelector('#icons-holder .icon-holder').innerHTML;var order=(overwrite===true)?_icon.sort:(db.rowCount(Collection.getActive().bookmark_id)+1);if(historyIndex>=0){if(overwrite){if(_icon.premium==4){overwrite=false;Collection.upload_icon(svg,_icon.isColor,order,_icon.id,_icon.color,_icon.name,overwrite);Widget.delIcon(_icon.id);}else{if(!_icon.isColor){if(!icon_transformed){var svg=document.querySelector(".collection[data-bookmark='"+Collection.getActive().bookmark_id+"'] .icon[data-id='"+_icon.id+"'] svg")
var isLight=Widget.isLight(_icon.color);Widget.changeIconColor(_icon.color,svg,false,true,isLight,true);}else{overwrite=false;Collection.upload_icon(svg,_icon.isColor,order,_icon.id,_icon.color,_icon.name,overwrite);Widget.delIcon(_icon.id);}}else{Collection.upload_icon(svg,_icon.isColor,order,_icon.id,_icon.color,_icon.name,overwrite);document.querySelector("#collections-holder section.expanded ul li.icon[data-id='"+_icon.id+"']").classList.add('personal-icon');}}}else{Collection.upload_icon(svg,_icon.isColor,order,_icon.id,_icon.color,_icon.name,overwrite);track_add_collection(document.location.search,_icon.id,_icon.premium);}}
Widget.show();setTimeout(function(){Widget._openEditModal(false,false);},500);}
var __color=function(selector_color,new_color,old_color_attr,preventHistory){if(_icon.color!='XXXXXX'){_icon.color=new_color.substr(1);}
old_color_attr='';__getByFillColor(selector_color).forEach(function(e){old_color=e.getAttribute("style").replace("fill:",'').replace(';','');if(old_color!=new_color.toUpperCase()){e.setAttribute('data-old_color',old_color);}
old_color=e.getAttribute('data-old_color');e.style.fill='';e.setAttribute("style",'');e.setAttribute("style","fill:"+new_color);});if(!preventHistory){historyHandler.push('color',[selector_color,new_color,old_color]);}
picker.setHex(new_color);__setActiveColor(new_color);_getSVGColors(true);}
var __flipX=function(preventHistory){_transformProperties.flipX=true;_transformProperties.translate=[-(_viewBox.width+_viewBox.x),0];_flipX=!_flipX;if(!preventHistory){historyHandler.push('flipX',[]);}
__consolidate();}
var __flipY=function(preventHistory){_transformProperties.flipY=true;_transformProperties.translate=[0,-(_viewBox.height+_viewBox.y)];_flipY=!_flipY;if(!preventHistory){historyHandler.push('flipY',[]);}
__consolidate();}
var __rotate=function(deg,preventHistory){_fixRotationPoint(true);_transformProperties.rotate=(_flipX^_flipY)?-~~deg:~~deg;if(!preventHistory){historyHandler.push('rotate',[_transformProperties.rotate]);}
__consolidate();_fixRotationPoint();_degrees+=~~deg;if(Math.abs(_degrees)==360)_degrees=0;if(_degrees<0)_degrees=360+_degrees;}
var __skew=function(x,y){_transformProperties.skewX=~~a
_transformProperties.skewY=~~b;__consolidate();}
var __translate=function(x,y,preventHistory,skip){if(skip===true){_transformProperties.translate=[x,y];__consolidate();return;}
if(!preventHistory){historyHandler.push('translate',[x,y]);}
var x1=x,y1=y;if(_flipX||_flipY){x=(_flipY)?(!y1)?y1:-y1:y1;y=(_flipX)?(!x1)?x1:-x1:x1;if(_flipX&&_flipY){x1=x,y1=y;x=y1;y=x1;}}
var _factor={0:[x,y],90:[y,-x],180:[-x,-y],270:[-y,x]};_transformProperties.translate=(_flipX^_flipY)?_factor[_degrees].reverse():_factor[_degrees];__consolidate();}
var __scale=function(x,y,preventHistory){_fixRotationPoint(true);if(typeof y=='undefined'){y=x;}
_transformProperties.scale=[x,y];if(!preventHistory){historyHandler.push('scale',_transformProperties.scale);}
__consolidate();_fixRotationPoint();}
var __align=function(position){var gBBox=g.getBBox();var viewBox=svg_element.viewBox.baseVal;var x=0,y=0;var matrix=(g.transform.baseVal.length)?g.transform.baseVal.getItem(0).matrix:{a:1,d:1,e:0,f:0};var factor={'top':-1,'bottom':1,'left':-1,'right':1};switch(position){case'top':y=(viewBox.height-gBBox.height-gBBox.y)-matrix.f/matrix.d;break;case'bottom':y=(viewBox.height-gBBox.height-gBBox.y)-matrix.f/matrix.d;break;case'left':x=(viewBox.width-gBBox.width-gBBox.x)-matrix.e/matrix.a;break;case'right':x=(viewBox.width-gBBox.width-gBBox.x)-matrix.e/matrix.a;break;case'center':x=((viewBox.width-gBBox.width)/2)-gBBox.x-matrix.e;y=((viewBox.height-gBBox.height)/2)-gBBox.y-matrix.f;break;}
__translate(x,y);}
var __fitToCanvas=function(preventHistory){var gBCR=g.getBoundingClientRect();var ratio=(gBCR.width>=gBCR.height)?_BBox.width/gBCR.width:_BBox.height/gBCR.height;__scale(ratio,ratio,true);}
var __reset=function(){icon_transformed=false;document.querySelector('#svg-icon-colors').innerHTML=document.querySelector('#original-icon-colors').innerHTML;if(g.transform.baseVal.length){var matrix=svg_element.createSVGMatrix();__matrix(matrix);}
__resetColors();_resetValues();_setUserHistoryButtons();if(Collection.getActive().status){if(_icon.isColor!=1){document.getElementById('save_into_active').disabled=false;document.querySelector('.edit-icons-user-actions .free_user_warning').classList.add('hidden');document.querySelector('.edit-icons-user-actions .collection_limit').classList.add('hidden');}}}
var __resetColors=function(){_all(__SELECTOR__+" > *:not(g)").forEach(function(p){p.setAttribute('style','fill:'+p.getAttribute('data-original'));});colorHistoryIndex=-1;colorHistory=[];document.querySelector("#svg-icon-colors li.color button").classList.add('active');__selectedColor(document.querySelector("#svg-icon-colors li.color button").getAttribute('data-original'));}
var __matrix=function(matrix,preventHistory){if(!preventHistory){historyHandler.push('matrix',[matrix]);}
__consolidate(matrix);}
var __consolidate=function(matrix){if(typeof matrix=='undefined'){matrix=(!g.transform.baseVal.numberOfItems)?svg_element.createSVGMatrix():g.transform.baseVal.getItem(0).matrix;}
for(var i in _transformProperties){var method=(_transformProperties[i]instanceof Array)?'apply':'call';matrix=matrix[i][method](matrix,_transformProperties[i]);}
if(g.transform.baseVal.numberOfItems==0){g.transform.baseVal.appendItem(svg_element.transform.baseVal.createSVGTransformFromMatrix(matrix));}else{g.transform.baseVal.getItem(0).setMatrix(matrix);}
g.transform.baseVal.consolidate();_transformProperties={};}
var _resetValues=function(){if(detectBrowser()!='IE')_viewBox=svg_element.viewBox.baseVal;_BBox=svg_element.getBoundingClientRect();_degrees=0;_flipX=false;_flipY=false;_x=0;_y=0;history=[];historyIndex=-1;_clean_icon=true;colorHistory=[];colorHistoryIndex=-1;}
function _fixRotationPoint(change){var x=_viewBox.width/2+_viewBox.x;var y=_viewBox.height/2+_viewBox.y;if(change===true){__translate(x,y,false,true);}else{__translate(-x,-y,false,true);}}
function _round(value,decimals){return Math.round(value*Math.pow(10,decimals))/Math.pow(10,decimals);}
function __isLight(color){if(!color)return false;var r=parseInt(color.substr(1,2),16);var g=parseInt(color.substr(3,2),16);var b=parseInt(color.substr(5,2),16);return((r*299)+(g*587)+(b*114))>=225000;}
function __formatColor(c){if(c.substr(0,1)!="#"&&c.substr(0,3)!="rgb")return'';if(c.indexOf("rgb")!=-1){c=rgbToHex(c.split(",").map(function(c){return~~c.replace(/\D+/g,'');}));}
c=c.toUpperCase();return c;function componentToHex(c){var hex=c.toString(16);return hex.length==1?"0"+hex:hex;}
function rgbToHex(c){return"#"+componentToHex(c[0])+componentToHex(c[1])+componentToHex(c[2]);}}
var history=[];var historyIndex=-1;var colorHistory=[];var colorHistoryIndex=-1;var historyHandler={push:function(event,data){if(historyIndex<history.length-1){history.splice(historyIndex);}
history.push([event,data]);historyIndex=history.length-1;_setUserHistoryButtons();},undo:function(){_all('.active-path').forEach(function(e){e.classList.remove('active-path');});var method=history[historyIndex][0];var values=history[historyIndex][1];if(values&&values.length){if(values[0].toString()=='[object SVGMatrix]'){values[0]=values[0].inverse();}else{if(method=='scale'){values=values.map(function(v){return 1-(v-1);});}else if(method!='color'){values=values.map(function(v){return-v;});}}}
if(typeof this.call[method]=='function'){if(values[values.length-1]!==true){values.push(true);}
if(method=='color'){if(document.querySelector('#svg-icon-colors .active')!=document.querySelector('#svg-icon-colors button[data-original="'+values[0]+'"]')){document.querySelector('#svg-icon-colors .active').classList.remove('active');document.querySelector('#svg-icon-colors button[data-original="'+values[0]+'"]').classList.add('active');}
document.querySelector('#svg-icon-colors button[data-original="'+values[0]+'"]').style.backgroundColor=values[2];values=[values[0],values[2],values[1],values[3]];}
this.call[method].apply(null,values);historyIndex--;_setUserHistoryButtons();}},redo:function(){historyIndex++;if(typeof history[historyIndex]=='undefined'){console.info("REDO",history,historyIndex);}
var method=history[historyIndex][0];var values=history[historyIndex][1];if(values[values.length-1]!==true){values.push(true);}
if(method=='color'){document.querySelector('#svg-icon-colors button[data-original="'+values[0]+'"]').style.backgroundColor=values[1];}
this.call[method].apply(null,values);_setUserHistoryButtons();},push_old:function(event,data){historyIndex++;if(historyIndex<history.length-1){history.splice(historyIndex);historyIndex=history.length-1;history[historyIndex]=[event,data];}else{history.push([event,data]);}
if(event=='color'){if(!~colorHistoryIndex){colorHistoryIndex++;colorHistory[colorHistoryIndex]=[data[0],data[0],true];}
if(colorHistoryIndex<colorHistory.length-1){colorHistory.splice(colorHistoryIndex);colorHistory[colorHistoryIndex]=[data[0],data[1],true];}else{data.push(true);colorHistory.push(data);}
colorHistoryIndex=colorHistory.length-1;}
_setUserHistoryButtons();},undo_old:function(){var method=history[historyIndex][0];var values=history[historyIndex][1];if(values&&values.length){if(values[0].toString()=='[object SVGMatrix]'){values[0]=values[0].inverse();}else{if(method=='scale'){values=values.map(function(v){return 1-(v-1);});}else if(method=='color'){colorHistoryIndex--;values=colorHistory[colorHistoryIndex];}else{values=values.map(function(v){return-v;});}}}
if(typeof this.call[method]=='function'){if(values[values.length-1]!==true){values.push(true);}
if(method=='color'){document.querySelector('#svg-icon-colors button[data-original="'+values[0]+'"]').style.backgroundColor=values[1];}
this.call[method].apply(null,values);historyIndex--;_setUserHistoryButtons();}},redo_old:function(){historyIndex++;if(typeof history[historyIndex]=='undefined'){console.info("REDO",history,historyIndex);}
var method=history[historyIndex][0];var values=history[historyIndex][1];if(method=='color'){colorHistoryIndex++;values=colorHistory[colorHistoryIndex];}
if(values[values.length-1]!==true){values.push(true);}
if(method=='color'){document.querySelector('#svg-icon-colors button[data-original="'+values[0]+'"]').style.backgroundColor=values[1];}
this.call[method].apply(null,values);_setUserHistoryButtons();},call:{flipX:__flipX,flipY:__flipY,scale:__scale,translate:__translate,matrix:__matrix,rotate:__rotate,color:__color}}
return{load:load,getInfo:function(){return{id:_icon.id,name:_icon.name,color:_icon.color,isColor:_icon.isColor,url:url,premium:_icon.premium}},rotate:function(degrees){__rotate(degrees);},horizontalFlip:function(){(!_degrees||_degrees==180)?__flipX():__flipY();},verticalFlip:function(){(!_degrees||_degrees==180)?__flipY():__flipX();},skew:function(x,y){__skew(x,y);},move:function(top,right,bottom,left){var x=((~~left)*-1+(~~right))*_moveFactor;var y=((~~top)*-1+(~~bottom))*_moveFactor;__translate(x,y);},scale:function(value){value=1+parseFloat((value/100).toFixed(2));__scale(value);},fitToCanvas:function(){__fitToCanvas();},reset:function(){__reset();},align:function(position){__align(position);},getDegrees:function(){return _degrees;},getViewBox:function(){return _viewBox;},getBBox:function(){return _BBox;},getMatrix:function(){return(!g.transform.baseVal.numberOfItems)?svg_element.createSVGMatrix():g.transform.baseVal.getItem(0).matrix;},getActions:function(){return[history,historyIndex];}}})();;(function(){var _=function(input,o){var me=this;this.input=$(input);this.input.setAttribute("autocomplete","off");o=o||{};configure(this,{minChars:2,maxItems:10,autoFirst:false,filter:_.FILTER_CONTAINS,sort:_.SORT_BYLENGTH,item:_.ITEM,replace:_.REPLACE},o);this.index=-1;this.container=$.create("div",{className:"awesomplete",around:input});this.ul=$.create("ul",{hidden:"hidden",inside:this.container});this.status=$.create("span",{className:"visually-hidden",role:"status","aria-live":"assertive","aria-relevant":"additions",inside:this.container});$.bind(this.input,{"input":this.evaluate.bind(this),"blur":this.close.bind(this),"keydown":function(evt){var c=evt.keyCode;if(me.opened){if(c===13&&me.selected){evt.preventDefault();me.select();}
else if(c===27){me.close();}
else if(c===38||c===40){evt.preventDefault();me[c===38?"previous":"next"]();}}}});$.bind(this.input.form,{"submit":this.close.bind(this)});$.bind(this.ul,{"mousedown":function(evt){var li=evt.target;if(li!==this){while(li&&!/li/i.test(li.nodeName)){li=li.parentNode;}
if(li&&evt.button===0){me.select(li,evt.target);}}}});if(this.input.hasAttribute("list")){this.list="#"+this.input.getAttribute("list");this.input.removeAttribute("list");}
else{this.list=this.input.getAttribute("data-list")||o.list||[];}
_.all.push(this);};_.prototype={set list(list){if(Array.isArray(list)){this._list=list;}
else if(typeof list==="string"&&list.indexOf(",")>-1){this._list=list.split(/\s*,\s*/);}
else{list=$(list);if(list&&list.children){this._list=slice.apply(list.children).map(function(el){return el.textContent.trim();});}}
if(document.activeElement===this.input){this.evaluate();}},get selected(){return this.index>-1;},get opened(){return!this.ul.hasAttribute("hidden");},close:function(){this.ul.setAttribute("hidden","");this.index=-1;$.fire(this.input,"awesomplete-close");},open:function(){this.ul.removeAttribute("hidden");if(this.autoFirst&&this.index===-1){this.goto(0);}
$.fire(this.input,"awesomplete-open");},next:function(){var count=this.ul.children.length;this.goto(this.index<count-1?this.index+1:-1);},previous:function(){var count=this.ul.children.length;this.goto(this.selected?this.index-1:count-1);},goto:function(i){var lis=this.ul.children;if(this.selected){lis[this.index].setAttribute("aria-selected","false");}
this.index=i;if(i>-1&&lis.length>0){lis[i].setAttribute("aria-selected","true");this.status.textContent=lis[i].textContent;}
$.fire(this.input,"awesomplete-highlight");},select:function(selected,originalTarget){selected=selected||this.ul.children[this.index];if(selected.parentElement.classList.contains('autocomplete-icons'))
{selected=selected.parentElement.parent('li');originalTarget=selected;}
if(selected){var allowed=$.fire(this.input,"awesomplete-select",{text:selected.textContent,data:this.suggestions[$.siblingIndex(selected)],originalTarget:originalTarget||selected});if(allowed){this.replace(selected.textContent);this.close();$.fire(this.input,"awesomplete-selectcomplete");}}},evaluate:function(){var me=this;var value=this.input.value;if(value.length>=this.minChars&&this._list.length>0){this.index=-1;this.ul.innerHTML="";this.suggestions=this._list.filter(function(item){return me.filter(item,value);}).slice(0,this.maxItems);this.suggestions.forEach(function(text){me.ul.appendChild(me.item(text,value));});if(this.ul.children.length===0){this.close();}else{this.open();}}
else{this.close();}}};_.all=[];_.FILTER_CONTAINS=function(text,input){return RegExp($.regExpEscape(input.trim()),"i").test(text);};_.FILTER_STARTSWITH=function(text,input){return RegExp("^"+$.regExpEscape(input),"i").test(text);};_.SORT_BYLENGTH=function(a,b){if(a.length!==b.length){return a.length-b.length;}
return a<b?-1:1;};_.ITEM=function(text,input){var html=input===''?text:text.replace(RegExp($.regExpEscape(input.toLowerCase().trim()),"gi"),"<mark>$&</mark>");return $.create("li",{innerHTML:html,"aria-selected":"false"});};_.REPLACE=function(text){this.input.value=text.toLowerCase();};function configure(instance,properties,o){for(var i in properties){var initial=properties[i],attrValue=instance.input.getAttribute("data-"+i.toLowerCase());if(typeof initial==="number"){instance[i]=parseInt(attrValue);}
else if(initial===false){instance[i]=attrValue!==null;}
else if(initial instanceof Function){instance[i]=null;}
else{instance[i]=attrValue;}
if(!instance[i]&&instance[i]!==0){instance[i]=(i in o)?o[i]:initial;}}}
var slice=Array.prototype.slice;function $(expr,con){return typeof expr==="string"?(con||document).querySelector(expr):expr||null;}
function $$(expr,con){return slice.call((con||document).querySelectorAll(expr));}
$.create=function(tag,o){var element=document.createElement(tag);for(var i in o){var val=o[i];if(i==="inside"){$(val).appendChild(element);}
else if(i==="around"){var ref=$(val);ref.parentNode.insertBefore(element,ref);element.appendChild(ref);}
else if(i in element){element[i]=val;}
else{element.setAttribute(i,val);}}
return element;};$.bind=function(element,o){if(element){for(var event in o){var callback=o[event];event.split(/\s+/).forEach(function(event){element.addEventListener(event,callback);});}}};$.fire=function(target,type,properties){var evt=document.createEvent("HTMLEvents");evt.initEvent(type,true,true);for(var j in properties){evt[j]=properties[j];}
return target.dispatchEvent(evt);};$.regExpEscape=function(s){return s.replace(/[-\\^$*+?.()|[\]{}]/g,"\\$&");};$.siblingIndex=function(el){for(var i=0;el=el.previousElementSibling;i++);return i;};function init(){$$("input.awesomplete").forEach(function(input){new _(input);});}
if(typeof Document!=="undefined"){if(document.readyState!=="loading"){init();}
else{document.addEventListener("DOMContentLoaded",init);}}
_.$=$;_.$$=$$;if(typeof self!=="undefined"){self.Awesomplete=_;}
if(typeof module==="object"&&module.exports){module.exports=_;}
return _;}());;$(function(){$(document).on("click",'#download-free',function(e){download_final();});$(document).on('click','#download-premium',function(){document.getElementById('modal-download').checked=false;});$(document).on('click','#detail .download li a',function(e){e.preventDefault();document.getElementById('modal-base64').checked=false;var format=$(this).attr('data-format');$('#format').val(format);var colored=document.getElementById('colored').value;if( format=='psd'||format=='eps'||
((format=='svg'||format=='base64')&&(colored==2)))
{check_user_licence_and_download();}});$(document).on('click','#detail ul.size button',function(){var format=$('#format').val();var size=$(this).attr('data-size');$('#size').val(size);if(format=='png'||format=='svg'||format=="base64"){check_user_licence_and_download();}});$(document).on('change','#modal-collection-pack',function(){if(document.getElementById('modal-collection-pack').checked==false){clean_download_form_and_modal();}});});function check_user_licence_and_download()
{if(gr.auth.me.premium){download_final();}else{document.getElementById('modal-download').checked=true;}}
function direct_check_user_licence_and_download(icon)
{if(gr.auth.me.premium){download_final();}else{prepare_direct_download_licence_modal(icon);}}
function prepare_direct_download_licence_modal(icon)
{fill_direct_download_licence_modal(icon);toggle_direct_download_licence_modal(true);}
function fill_direct_download_licence_modal(icon)
{var modal=document.querySelector('.modal-download.modal-collection-pack');modal.querySelector('p.filename img').setAttribute('src',icon.querySelector('img').getAttribute('src'));modal.querySelector('p.filename span.description').innerHTML=icon.dataset.name;modal.querySelector('p.author span.description').innerHTML='By '+icon.dataset.author_name;modal.querySelector('p.author img').setAttribute('src',icon.dataset.author_avatar);var licence='<div>Icons made by <a href="'+icon.dataset.author_website+'" title="'+icon.dataset.name+'">'+icon.dataset.name+'</a> from <a href="'+APP_URL+'" \
    title="Flaticon">www.flaticon.com</a> is licensed by <a href="http://creativecommons.org/licenses/by/3.0/" \
    title="Creative Commons BY 3.0" target="_blank">CC 3.0 BY</a></div>';modal.querySelector('input.licence-container').setAttribute('value',licence);}
function toggle_direct_download_licence_modal(show)
{var modal=document.querySelector('.modal-download.modal-collection-pack');var hidden_elements=['h3.modal-icon','p.filename','p.author','a.modal-icon','button.download-free','p.copy','input.licence-container'];var showed_elements=['h3.modal-collection','h3.modal-pack','a.modal-collection','a.modal-pack','button.modal-collection','button.modal-pack'];if(show){hidden_elements.forEach(function(element){modal.querySelector(element).classList.remove('hidden');});showed_elements.forEach(function(element){modal.querySelector(element).classList.add('hidden');});}else{hidden_elements.forEach(function(element){modal.querySelector(element).classList.add('hidden');});showed_elements.forEach(function(element){modal.querySelector(element).classList.remove('hidden');});modal.querySelector('section.modal-body').classList.remove('nopremium');}
modal.querySelector('#modal-collection-pack').checked=show;}
function download_final()
{saveColor(localStorage.color);if($("#download-form #format").val()!="base64"){download_icon_post();}else{download_b64_post();}
if(document.getElementById('modal-download')){document.getElementById('modal-download').checked=false;}}
function normalizeFields(){document.getElementById('author').value=document.getElementById('author').value||'0';document.getElementById('team').value=document.getElementById('team').value||'0';document.getElementById('pack').value=document.getElementById('pack').value||'0';document.getElementById('icon_id').value=document.getElementById('icon_id').value||'0';document.getElementById('format').value=document.getElementById('format').value||'png';document.getElementById('color').value=document.getElementById('color').value||'#000000';document.getElementById('colored').value=document.getElementById('colored').value||'1';document.getElementById('size').value=document.getElementById('size').value||'512';document.getElementById('style').value=document.getElementById('style').value||'Unknown';document.getElementById('keyword').value=document.getElementById('keyword').value||'icon';}
function trackDownload(){track_download();update_download_counter(3000);normalizeFields();ga('send','event','Download','Icon',document.getElementById('format').value.toUpperCase(),1,{'dimension8':document.getElementById('author').value,'dimension2':document.getElementById('team').value,'dimension10':document.getElementById('pack').value,'dimension3':document.getElementById('icon_id').value,'dimension4':document.getElementById('format').value,'dimension5':document.getElementById('color').value,'dimension6':document.getElementById('size').value,'dimension12':document.getElementById('style').value,'dimension7':document.getElementById('keyword').value,});}
function track_download(){if(LANGUAGE=="english"){var tr_search='';var item_id=document.getElementById('icon_id').value;var user_id=0;var exclusive_file=document.getElementById('selection').value;if(window.location.href.indexOf('#')!='-1'){var hash=window.location.href.split('#');if(typeof(hash[1])!=="undefined")tr_search=hash[1]+"&";}
if((typeof gr!=='undefined')&&gr.auth.logged)user_id=gr.auth.me.id;if(typeof item_id!='undefined')
{var new_image=new Image();new_image.src="https://trk.flaticon.com/download.gif?"+tr_search+"pg=detalle-english&id="+item_id+"&userid="+gr.auth.me.id+"&exclusive="+exclusive_file+"&r="+Math.random();}}}
function download_b64_post(){var serializeArray=$(this).serializeArray();var data={};$("#download-form").serializeArray().forEach(function(field){data[field.name]=field.value;});$.post('/download-icon',data,fillBase64Form);trackDownload();}
function fillBase64Form(response){var img='<img src="'+response.data+'" />';$('#b64Image').val(img);var css='<style type="text/css">';css+='div.image {';css+='max-width: 256px;';css+='max-height: 256px;';css+='background-image: url('+response.data+')';css+='}';css+='</style>';$('#b64css').val(css);document.getElementById('modal-base64').checked=true;}
function download_icon_post(){normalizeFields();var form=document.getElementById('download-form');if(document.getElementById('modal-base64')){document.getElementById('modal-base64').checked=false;}
if(document.getElementById('modal-download')){document.getElementById('modal-download').checked=false;}
if(document.getElementById('modal-collection-pack')&&document.getElementById('modal-collection-pack').checked==true){document.getElementById('modal-collection-pack').checked=false;setTimeout(clean_download_form_and_modal,2000);}
form.submit();trackDownload();}
function direct_download_icon_post(e,format)
{e.preventDefault();var icon=e.target.parents('.icon')[0];prepare_forms_to_direct_download(icon,format);direct_check_user_licence_and_download(icon)}
function prepare_forms_to_direct_download(icon,format)
{if(check_if_download_form_exists()){bypass_download_form_and_create_new_form(icon,format);}else{create_temporal_download_form(icon,format);}}
function remove_download_form_if_exists()
{if(check_if_download_form_exists())
{return remove_form();}
return false;}
function bypass_download_form_and_create_new_form(icon,format)
{document.getElementById('download-form').setAttribute('id','detail-download-form');create_temporal_download_form(icon,format);}
function clean_download_form_and_modal()
{if(remove_download_form_if_exists()){toggle_direct_download_licence_modal(false);}
if(document.getElementById('detail-download-form')){document.getElementById('detail-download-form').setAttribute('id','download-form');}}
function create_temporal_download_form(icon,format_type)
{var values={icon_id:icon.dataset.id,author:icon.dataset.author,team:icon.dataset.author,keyword:icon.dataset.name,pack:icon.dataset.pack,style:icon.dataset.style,format:format_type,color:'',colored:icon.dataset.color,size:'512',selection:icon.dataset.selection,premium:icon.dataset.premium}
var form=document.createElement("form");form.setAttribute('id',"download-form");form.setAttribute('method',"POST");form.setAttribute('action',"/download-icon");Object.keys(values).map(function(objectKey,index){var value=values[objectKey];var input=document.createElement("input");input.setAttribute("type","hidden");input.setAttribute("name",objectKey);input.setAttribute("id",objectKey);input.setAttribute("value",value);form.appendChild(input);});if(values.premium=="0"&&values.selection=="0"){document.querySelector('.modal-download.modal-collection-pack section.modal-body').classList.add('nopremium')}
icon.appendChild(form);}
function remove_form()
{if(document.querySelector('.icon form#download-form')){document.querySelector('.icon form#download-form').parentNode.removeChild(document.querySelector('.icon form#download-form'));return true;}
return false}
function check_if_download_form_exists()
{if(document.getElementById('download-form')){return true;}else{return false;}}
function track_add_collection(path,item_id,selection)
{if(LANGUAGE=="english"){var tr_search;if(typeof path=='string')
{tr_search=decodeURIComponent(window.location.search.replace(/\?word=/i,'').replace(/^(.*)\//i,'').replace(/[-_]+/gi,' '));}
else
{tr_search='';}
if(typeof item_id!='undefined')
{var new_image=new Image();new_image.src="https://trk.flaticon.com/download.gif?"+tr_search+"&pg=detalle-english&id="+item_id+"&userid="+gr.auth.me.id+"&exclusive="+selection+"&r="+Math.random();}}};var touch,last_event;var isMobile;var detailModal=null;var detailFullWeb=null;var scrollPosition=0;var launchGAScroll=false;$(function(){var userAgent=navigator.userAgent.toLowerCase();var isMobileAgent=(/android|webos|iphone|ipad|ipod|blackberry|iemobile|opera mini/i.test(userAgent));var isNarrowScreen=(window.innerWidth<=768&&window.innerHeight<=600);var isMobile=isMobileAgent||isNarrowScreen;if(isMobile){reset_all_tags();}
detailModal=(document.getElementById('detail-overlay').classList.contains('hidden'))?null:document.getElementById('detail-wrapper');detailFullWeb=document.getElementById('detail');launchGAScroll=false;scrollPosition=getDetailScrollPosition(detailModal,detailFullWeb);var requestAnimationFrame=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||window.oRequestAnimationFrame||function(){return 0}).bind(window);(function checkScrollPosition(){var scrollPositionCurrent=getDetailScrollPosition(detailModal,detailFullWeb);if(scrollPosition!==scrollPositionCurrent){scroll(scrollPositionCurrent);scrollPosition=scrollPositionCurrent;}
requestAnimationFrame(checkScrollPosition);})();function scroll(scrollPosition){if(!launchGAScroll){if(scrollPosition>=(document.body.clientHeight)){ga('send','event','Detail View','Scroll','Down');launchGAScroll=true;}}}
$(document).on("click",".detail_equivalent_icons .link-icon-detail",function(e){if(window.iconsSlider instanceof(Function))return true;ga('send','event','Detail-modal','Toggle-icon-style');e.preventDefault();var id=~~this.dataset.id;var folder=Math.floor(id/1000);var premium=~~this.dataset.premium;var selection=~~this.dataset.selection;var color=~~this.dataset.color;var active=document.querySelector(".detail_equivalent_icons .link-icon-detail.active");if(active)
{active.classList.remove("active");}
this.classList.add("active");var images=document.querySelectorAll(".gallery .main-icon");[].forEach.call(images,function(i){var path=premium?APP_URL+'premium-icon/':STATIC_URL;if(color==1)
{var url="{0}icons/svg/{1}/{2}.svg".format(path,folder,id);i.innerHTML='<img src="{0}">'.format(url);if(!premium||(gr.auth.me.premium&&premium))
{getSVG($(i),url);document.querySelector(".svg-version").classList.remove('active');}}
else
{i.innerHTML='<img src="{0}icons/png/512/{1}/{2}.png">'.format(path,folder,id);}});if(document.querySelector(".customize.active")&&this.dataset.color==1)
{document.querySelector(".gallery .svg-version").classList.add("active");}
document.querySelector('section.customize ul.color-selector').previousElementSibling.classList.toggle('hidden',color==2);document.querySelector('section.customize ul.color-selector').classList.toggle('hidden',color==2);var form=document.getElementById("download-form");form.querySelector("#icon_id").value=id;form.querySelector("#colored").value=color;form.querySelector("#premium").value=premium;form.querySelector("#selection").value=selection;toggleAxDetailButton();var h1=document.querySelector(".detail-header h1");var i=h1.querySelector("span:not(.title)");if(i)
{i.parentNode.removeChild(i);}
if(premium||selection)
{var html='<span class="simptip-position-right simptip-movable" data-tooltip="Flaticon {0}"><i class="flaticon-{1}"></i></span>';i=premium?html.format("Premium","premium premium"):html.format("Selection","selection");h1.querySelector(".title").insertAdjacentHTML("beforebegin",i);}
Premium.init()
var link=APP_URL+this.dataset.pack_slug;[].forEach.call(document.querySelectorAll(".related-packs .related-header a:not(:first-child), #detail-header-more .group-pack a"),function(anchor){anchor.href=link;});var related_icons=document.querySelectorAll(".related.related-packs .icons .icon");if(related_icons.length)
{var tpl_icon=Handlebars.tag('icon');$.getJSON('/ajax/pack/'+this.dataset.pack_id,function(result){related_icons.forEach(function(icon,index){icon.outerHTML=tpl_icon(result.items[index]);});});}});$(document).on('mouseleave','.icon',function(e){var popover=this.querySelector('.popover');if(popover&&popover.querySelector('button.popover-button.active')){popover.classList.remove('popover-left');popover.classList.remove('popover-right');popover.querySelector('button.popover-button.active').classList.remove('active');popover.querySelector('div.popover-content.show-menu').classList.remove('show-menu');}});$(document).on("click","button.btn-share",function(){this.parentNode.querySelector('input.input-share-url').value=document.location.href;});$(".modal-collection-pack #download-pack-free").on("click",function(e){e.stopPropagation();$("#form-download-pack").submit();$_("#modal-collection-pack").checked=false;});$("#didyoumean a").on('click',function(e){ga('send','event','Search','Icon','Did you mean',{'dimension9':this.dataset.word,'dimension16':this.dataset.suggested});});$(".grid_selector input[name=grid]").change(function(){var wrapper=document.querySelector('.search-result .icons');if(wrapper)
{localStorage.setItem('grid_size',this.value);wrapper.classList.toggle("big",this.value=='big');$(window).trigger("resize");var size=(this.value=='big')?128:64;[].forEach.call(wrapper.querySelectorAll(".icon img"),function(icon){icon.width=size;icon.height=size;});}});var slug_icon_packs=(typeof messages.common.icon_packs!='undefined')?messages.common.icon_packs:'icon-packs';var slug_url_search=(typeof messages.url.search!='undefined')?messages.url.search:'/search';$('#header').on('change','input[type=radio][name=search-type]',function(e){var popoverButton=this.parentNode.parentNode.parentNode.parentNode.parentNode.querySelector('.popover-button');if(document.querySelector('form #main-search-current_section')&&document.querySelector('form #main-search-current_section').value){popover_render(e,popoverButton)
return true;}
localStorage.setItem('search-type',this.value);if(this.value=='packs')
{document.querySelector('.search-holder form.main_search_bar').action=window.location.protocol+'//'+window.location.host+'/'+slug_icon_packs;}
else
{document.querySelector('.search-holder form.main_search_bar').action=window.location.protocol+'//'+window.location.host+slug_url_search;}
popoverButton.innerHTML=this.value.charAt(0).toUpperCase()+this.value.slice(1);});if(localStorage.getItem('search-type'))
{var radio=document.querySelector('input[type=radio][name=search-type][value='+localStorage.getItem('search-type')+']');if(radio)
{radio.checked=true;if(this.value=='packs')
{document.querySelector('.search-holder form.main_search_bar').action=window.location.protocol+'//'+window.location.host+'/'+slug_icon_packs;}
else
{if(document.getElementById('main-search-current_section')!=null){if(document.getElementById('main-search-current_section').value){var section_search="/"+document.getElementById('main-search-current_section').value;document.querySelector('.search-holder form.main_search_bar').action=window.location.protocol+'//'+window.location.host+section_search+slug_url_search;}}else{document.querySelector('.search-holder form.main_search_bar').action=window.location.protocol+'//'+window.location.host+slug_url_search;}}}}
if((window.location.pathname=='/packs'&&!isMobile)||window.location.pathname.search(messages.common.icon_packs)!=-1){document.querySelector(".search-holder .type-selector .popover-button").innerHTML="Packs";document.querySelector(".search-holder .type-selector input[name=search-type][value='packs']").checked=true;}
if(detectBrowser()=='IE')$('body').addClass('isIE');$('body').addClass('price-dollar');touch=(('ontouchstart'in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0));if(touch){$(window).on('touchstart mousemove',onMouseMove);$(document).on('click','.icons .icon',iconHover);collectionHeaderHover();}else{document.body.classList.add('notouch');}
checkLicense();$(document).on("click",".icon .overlay a",function(e){if(typeof gr.sponsor!='undefined'&&gr.sponsor!=null)
{if(!touch&&typeof gr.sponsor.popup!="undefined"&&!~~gr.auth.me.premium)gr.sponsor.popup.launch();if(document.querySelector('#detail.loaded')||(!this.classList.contains('link-icon-detail')||detectBrowser()=='IE'))
{window.location.href=this.href;}
e.preventDefault();e.stopPropagation();}});if(/Android [4-6]\.[0-9]/.test(navigator.appVersion)){window.addEventListener("resize",function(){if(document.activeElement.tagName=="INPUT"){document.activeElement.scrollIntoViewIfNeeded();}})}
$(document).on('click','.modal-trigger',function(e){document.getElementById(this.dataset.modal).checked=true;e.preventDefault();});$(document).on('click','.modal-close',function(e){$(this).parents('div.modal')[0].get('.modal-state').checked=false;e.preventDefault();});$(".modal-inner").on("click",function(e){e.stopPropagation();});$(".modal-fade-screen").on("click",function(){[].forEach.call(document.find('.modal-state'),function(checkbox){closeModal(checkbox);});});$(document).on('contextmenu','.icon:not(.icon-upload)',function(ev){var popover=this.querySelector('div.popover');popover.querySelector('button.popover-button').classList.add('active');popover.querySelector('div.popover-content').classList.add('show-menu');var menuW=230;renderPopoverWithHorizonalPossitionContext(popover,menuW);ev.preventDefault();});$(document).on('click','.icon .popover .popover-content li',function(e){sendGaFromContextMenu(this);})
$(document).on('click','.alert .close-alert',function(e){$(this).parent().removeClass('zoomIn').addClass('zoomOut').slideUp(300);e.preventDefault();});$(document).mouseup(function(e){var c=e.target;if(!c.parentNode)return;if(e.button===2)return;if(c.classList.length===0||c.classList.contains('active')||c.parentNode.classList.contains('active'))return;if(c.classList.contains('popover-container')||[].some.call(c.parents(),function(p){return p.classList.contains('popover-container')}))return;[].forEach.call(document.find(".popover-content"),function(e){e.classList.remove('show-menu');});[].forEach.call($_(".popover-button"),function(btn){btn.classList.remove('active');});});$(document).on("click",".popover-button",function(e){popover_render(e,this);});$('.track_download_pack').on('click',function(e){if(!this.dataset.pack)return;if(typeof gr.auth.logged!='undefined'){if(!gr.auth.me.premium&&this.dataset.premium==1)
{location.href=ACCOUNTS_BASE_URL+"premium/"+this.dataset.pack;return;}
document.querySelector('#form-download-pack #user_id').value=gr.auth.me.id;document.querySelector('#form-download-pack #pack_id').value=this.dataset.pack;update_download_counter(3000);if(gr.auth.me.premium)
{document.getElementById('form-download-pack').submit();}
else
{prepare_modal_download('pack');$_("#modal-collection-pack").checked=true;}}});var video=$('#video');var videoBtn=$('#fullscreenvid');if(video.length){videoBtn.on('click',function(){var vid=video[0];if(vid.requestFullscreen)
vid.requestFullscreen();else if(vid.mozRequestFullScreen)
vid.mozRequestFullScreen();else if(vid.webkitRequestFullscreen)
vid.webkitRequestFullscreen();else if(vid.msRequestFullscreen)
vid.msRequestFullscreen();});}
fullscreen();$("#msform").submit(function(e){e.preventDefault();if(!validate_join_the_team("1")||!validate_join_the_team("2"))return;var data={};$(this).serializeArray().forEach(function(field){data[field.name]=field.value;});$.post('/ajax/join-the-team',data,function(){$_("#msform fieldset")[2].style.display='none';$_("#msform .resul").style.display='block';setTimeout(function(){$_("#modal-form").checked=false;$_("#msform fieldset")[0].style.display='block';$_("#msform .resul").style.display='none';},3000);});});document.body.click();$(window).scroll(function(){var header=document.getElementById('header');var scrollBtn=document.getElementById('toTop');if(window.scrollY>=50)scrollBtn.classList.add('show');else scrollBtn.classList.remove('show');var body_scrollTop=document.body.scrollTop;if(document.body.classList.contains('home')){var searchBarHeight=document.querySelector('#hero .search-holder').offsetTop;if(window.scrollY>=searchBarHeight)
{header.classList.add('fixed','show');}
else
{header.classList.remove('fixed','show');}}else{if(body_scrollTop>header.clientHeight)
{header.classList.add('slim-version');}
else
{header.classList.remove('slim-version');}}});$(window).on("scroll",function(){var filter=$('.list-options');if(filter.length===0)return;var scrollTop=$(window).scrollTop(),header=$('#header').outerHeight(true);if(scrollTop<filter.outerHeight(true)+header&&filter.hasClass("fixed")){filter.removeClass('fixed');}else if(scrollTop>=filter.offset().top-header){filter.addClass('fixed');}});$("#toTop").on('click',function(e){$('html, body').animate({scrollTop:0},250);e.preventDefault();});try{var time_valuation=parseInt(localStorage.time_valuation);if(!time_valuation||isNaN(time_valuation))time_valuation=0;var form_valuation=$_("#form_valuation");if(form_valuation){if(parseInt(localStorage.time_valuation,10)%70==0){form_valuation.style.left="";$_("#form_valuation #button_panel").innerHTML="-";}else{form_valuation.style.left="-200px";$_("#form_valuation #button_panel").innerHTML="+";}}
localStorage.time_valuation=++time_valuation;}catch(e){}
$("#open_panel").click(function(){var parent=this.parent('#form_valuation');var left=parseInt(parent.style.left);if(isNaN(left)){parent.style.left="-200px";this.get('#button_panel').innerHTML="+";}else{parent.style.left="";this.get('#button_panel').innerHTML="-";}});$("#form_valuation").submit(function(e){e.preventDefault();var id=$_("#id_last_valuation");var comment=$_("#valuation_text");if(comment.value.trim().length){gr.request.post('valuations/send_user_comment',{id:id.value,comment:comment.value});}
$_("#valuation_comment_panel").style.display="none";$_("#valuation_congrat").style.display="block";setTimeout(function(){close_valuation();},3000);});$("#no_thanks").click(close_valuation);function close_valuation(){$_("#valuation_text").value='';$_("#id_last_valuation").value='';$_("#valuation_comment_panel").style.display="none";$_("#form_valuation").style.left="-200px";$_('#form_valuation #button_panel').innerHTML="+";$_("#valuation_congrat").style.display="none";$_("#valuation_panel").style.display="block";}
$(".valuation_response").click(function(e){var N=navigator.appName,UA=navigator.userAgent,temp,browser=[],browserVersion=UA.match(/(opera|chrome|safari|firefox|msie|maxthon|lunascape)\/?\s*(\.?\d+(\.\d+)*)/i);if(browserVersion&&(temp=UA.match(/version\/([\.\d]+)/i))!==null)browserVersion[2]=temp[1];browser["name"]=browserVersion[1];browser["version"]=browserVersion[2];gr.request.post('valuations/send_valuation',{value:this.dataset.value,question:$_("#valuation_question_id").value,browser:browser['name'],browser_version:browser['version'],language:LANGUAGE_SHORT,});});$(document).on("keyup focus","#msform #dribbble",function(){var value=this.value.trim();if(value.indexOf('https://dribbble.com/')!=0){this.value='https://dribbble.com/';}});$(document).on("keyup focus","#msform #behance",function(){var value=this.value.trim();if(value.indexOf('https://behance.net/')!=0){this.value='https://behance.net/';}});$(document).on("keyup focus","#msform #other-portfolio, #msform #personal-portfolio",function(){var value=this.value.trim();if(value.indexOf('https')!=0&&value.indexOf('http')!=0){this.value='http://';}});var current_fs,next_fs,previous_fs;var left,opacity,scale;var animating;$(".modal-form .next").click(function(){if(!validate_join_the_team(this.dataset.fieldset))return;if(animating)return false;animating=true;current_fs=$(this).parent();next_fs=$(this).parent().next();$(".modal-form #progressbar li").eq($("fieldset").index(next_fs)).addClass("active");next_fs.show();next_fs_height=$(this).parent().next().height();$('.modal-form #msform').animate({'height':next_fs_height+80});current_fs.animate({opacity:0},{step:function(now,mx){scale=1-(1-now)*0.2;left=(now*50)+"%";opacity=1-now;current_fs.css({'transform':'scale('+scale+')'});next_fs.css({'left':left,'opacity':opacity});},duration:400,complete:function(){current_fs.hide();animating=false;}});});$(".modal-form .previous").click(function(){if(!validate_join_the_team(this.dataset.fieldset))return;if(animating)return false;animating=true;current_fs=$(this).parent();previous_fs=$(this).parent().prev();$(".modal-form #progressbar li").eq($("fieldset").index(current_fs)).removeClass("active");previous_fs.show();previous_fs_height=$(this).parent().prev().height();$('.modal-form #msform').animate({'height':previous_fs_height+80});current_fs.animate({opacity:0},{step:function(now,mx){scale=0.8+(1-now)*0.2;left=((1-now)*50)+"%";opacity=1-now;current_fs.css({'left':left});previous_fs.css({'transform':'scale('+scale+')','opacity':opacity});},duration:400,complete:function(){current_fs.hide();animating=false;}});});if($("#designs-number").length){var designTotal=1402155;var designTotalDate=148720600;var designG2293rowthPek=700;var usrWeeerTotal=422972;var userTotalDate=1426033809133;var userGrowthPerWeek=4850;var downloadsTotal=617705841;var downloadsTotalDate=1446017641500;var downloadsGrowthPerWeek=3000000;var designGrowthPerWeek=1000;var userTotal=422972;(function drawDesignCount(){var newDesignTotal=designTotal;var designGrowthPerMilli=designGrowthPerWeek/7/24/60/60/1000;newDesignTotal+=Math.floor((Date.now()-designTotalDate)*designGrowthPerMilli);var newDesignTotalString=newDesignTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');$_('#designsCreated .number').innerText=newDesignTotalString;setTimeout(drawDesignCount,Math.random()*12500);})();(function drawUserCount(){var newUserTotal=userTotal;var userGrowthPerMilli=userGrowthPerWeek/7/24/60/60/1000;newUserTotal+=Math.floor((Date.now()-userTotalDate)*userGrowthPerMilli);var newUserTotalString=newUserTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');$_('#usersCreated .number').innerText=newUserTotalString;setTimeout(drawUserCount,Math.random()*6500);})();(function drawDownloadsCount(){var newDownloadsTotal=downloadsTotal;var downloadsGrowthPerMilli=downloadsGrowthPerWeek/7/24/60/60/1000;newDownloadsTotal+=Math.floor((Date.now()-downloadsTotalDate)*downloadsGrowthPerMilli);var newDownloadsTotalString=newDownloadsTotal.toString().replace(/\B(?=(\d{3})+(?!\d))/g,',');$_('#downloadsCreated .number').innerText=newDownloadsTotalString;setTimeout(drawDownloadsCount,Math.random()*1500);})();}
$("#designs-number").on("keyup change",function(){var minEarnings=(this.value*1).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");var maxEarnings=(this.value*7).toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");document.getElementById('earnings').innerHTML='$'+minEarnings+' ~ $'+maxEarnings;});var macApp=$('#mac-app'),macAppInterval=false;if(macApp.length){macApp.waypoints({view:50,viewOut:true,oneTime:false,inView:function(){if(!macAppInterval)macApp[0].classList.add('animate');if(!macAppInterval)macAppInterval=setInterval(function(){macApp[0].classList.remove('animate');setTimeout(function(){macApp[0].classList.add('animate');},300);},22700);},outView:function(){macApp[0].classList.remove('animate');clearInterval(macAppInterval);macAppInterval=false;}});}
if(!Cookie.get('cookie_policy')){$_("#cookies-alert").style.display='block';setTimeout(function(){insertCookiePolicy();},5000);}
$('#cookies-alert .close-cookies').on('click',function(){insertCookiePolicy();});$(document).on("keyup",function(e){e.preventDefault();if(e.which==27){[].forEach.call(document.find(".popover-content"),function(e){e.classList.remove('show-menu')});}});$('.reset-input').unbind();$(document).on("click",'.reset-input',function(){if($(this).siblings('input').val()!=='')
$(this).siblings('input').val('').focus();else if(($(this).siblings('input').attr('id')!='username')&&($(this).siblings('input').attr('id')!='email'))
$(this).siblings('input').attr('placeholder','');$(this).siblings('input').removeClass('error').parent().next('span.error').remove();return false;});$(document).on("click",'.reset-textarea',function(){if($(this).siblings('textarea').val()!=='')
$(this).siblings('textarea').val('').focus();$(this).siblings('textarea').removeClass('error').parent().next('span.error').remove();return false;});$('.input-group input, .textarea-group textarea').unbind();$('.input-group input, .textarea-group textarea').on('blur',function(){if(!$(this).val()){$(this).removeClass('hascontent');if($(this).attr('placeholder'))this.addClass('hascontent');}else
$(this).addClass('hascontent');});$('.input-group input, .textarea-group textarea').on('keyup',function(){$(this).removeClass('error').parent().next('span.error').remove();if(($(this).attr('id')=='password')||($(this).attr('id')=='repeat_password')){$('#password').removeClass('error').parent().next('span.error').remove();$('#repeat_password').removeClass('error').parent().next('span.error').remove();}});$('.input-group input, .textarea-group textarea').each(function(){if(!$(this).val()){$(this).removeClass('hascontent');if($(this).attr('placeholder'))this.addClass('hascontent');}else
$(this).addClass('hascontent');});if($_(".tabs")){tabs();}
$('.flaticon-magnifier').on('click',function(e){if(typeof gr.sponsor!='undefined'&&gr.sponsor!=null)
{try{if(!touch&&typeof gr.sponsor.popup.launch=="function"&&!~~gr.auth.me.premium){gr.sponsor.popup.launch();}}
catch(e){}}});$('.search-holder form').on('submit',function(e){e.preventDefault();var value=$(this).find('input[name="word"]').val().trim();value=filterSpecialChars(value);$(this).find('input[name="word"]').val(value);var hidden_values=false;this.querySelectorAll('input[type="hidden"]').forEach(function(x){hidden_values=hidden_values||(x.value.length>0);});if(value.length<2&&!hidden_values){UserAlerts.warning(messages.search.search,messages.search.minimal_characters,0);return false;}
track_search(value,this);});$('.reset-textarea').on('click',function(){if($(this).siblings('textarea').val()!=='')
$(this).siblings('textarea').val('').focus();$(this).siblings('textarea').removeClass('error').parent().next('span.error').remove();return false;});$(document).on("click",'.selectInput',function(){this.select();});$("#home_more_packs").click(function(){var page=parseInt(this.getAttribute("data-page"),10)+1;if(!window.packs_new){window.packs_new=[].map.call(document.querySelectorAll(".packs-new article"),function(pack){return parseInt(pack.getAttribute("data-id"),10);});}
var tpl=Handlebars.tag('pack-box');$.getJSON('/ajax/popular_packs/'+page,{not:window.packs_new},function(data){html='';data.forEach(function(pack){html+=tpl(pack);});document.querySelector('.packs-popular .box-container .box.emptybox').insertAdjacentHTML("beforebegin",html);});this.setAttribute("data-page",page);});get_currency();store_url();});function get_currency(){;var selectorCurrency='.js-currency';var currencies=document.querySelectorAll(selectorCurrency);var currency='DOLLAR';if(currencies.length){if(!Cookie.get('currency')){$.ajax({cache:false,type:'post',url:APP_URL+'usercur',success:function(result)
{if(result=='EURO'){Cookie.set('currency','EURO',2);currencies.forEach(function(text){var link=text.innerHTML.replace('$','').replace('','');text.innerHTML=link+'';});currency='EURO';$('body').removeClass('price-dollar');$('body').addClass('price-euro');}else{Cookie.set('currency','DOLLAR',2);$('body').removeClass('price-euro');$('body').addClass('price-dollar');}}});}else{currency=Cookie.get('currency');currencies.forEach(function(text){if(currency=='EURO'){var link=text.innerHTML.replace('$','').replace('','');text.innerHTML=link+'';}});$('body').removeClass('price-dollar');$('body').addClass('price-euro');}}}
function getDetailScrollPosition(detailModal,detailFullWeb){if(detailModal){return detailModal.pageYOffset||detailModal.scrollTop||detailModal.scrollTop;}
if(detailFullWeb){return window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop;}}
function onMouseMove(e){if(e.type=='touchstart'&&this.touchstart&&!document.body.classList.contains('notouch')){return;}
if(e.type=='touchstart')this.touchstart=true;if(e.type=='mousemove'&&!this.touchstart&&document.body.classList.contains('notouch')){return;}
if(this.touchstart){document.body.classList.remove('notouch');}else{document.body.classList.add('notouch');}
if(e.type=='mousemove')this.touchstart=false;}
function fullscreen(){var element=$('.fullscreen'),windowW=window.innerWidth,windowH=window.innerHeight;if(element.length===0)return;if(windowW<=768)return;function onResize(e){var condition=e.type==='resize'?windowW!==window.innerWidth&&windowH!==window.innerHeight:true,minWidth=element.data('fullscreen'),minWidth=minWidth?minWidth:8640,minHeight=element.find('> *').outerHeight(true);if(window.innerWidth<=minWidth&&window.innerHeight>minHeight){if(condition||!_touch)element.css('height',window.innerHeight-56);}else{element.removeAttr('style');}
windowW=window.innerWidth,windowH=window.innerHeight;};$(document).on('ready load',onResize);$(window).on('resize',onResize);};function track_search(value,form){if(value.length){var trk_image=new Image();trk_image.src="https://trk.flaticon.com/search.gif?search-"+language+"&term="+value+"&k="+Date.now();{exec_search(value,form);};trk_image.onerror=function(){exec_search(value,form);};}
exec_search(value,form);}
function string_to_slug(str){str=str.replace(/^\s+|\s+$/g,'');str=str.toLowerCase();var from="/_,:;";var to="aaaaeeeeiiiioooouuuunc------";for(var i=0,l=from.length;i<l;i++){str=str.replace(new RegExp(from.charAt(i),'g'),to.charAt(i));}
str=str.replace(/[^a-z0-9 -]/g,'').replace(/\s+/g,'-').replace(/-+/g,'-').replace(' ','-').replace('%20','-');return str;}
function exec_search(value,form){if(typeof gr.sponsor!='undefined'&&gr.sponsor!=null)
{if(!touch&&typeof gr.sponsor.popup.launch=="function"&&!~~gr.auth.me.premium){gr.sponsor.popup.launch();}}
if(value.length){$.ajax({cache:false,type:'post',url:APP_URL+'stats/search/'+value,success:function(result)
{continue_exec_search(value,form);},error:function(XMLHttpRequest,textStatus,errorThrown)
{continue_exec_search(value,form);}});}else{continue_exec_search(value,form);}}
function continue_exec_search(value,form)
{var home_search=false;if(form.classList.contains("home_search_input"))
{home_search=true;document.querySelector(".search-holder .type-selector input[name=search-type][data-type='icons']").click();}
var params=document.querySelectorAll('.search-holder form input');var qs=[];var querystring='';if(typeof params!='undefined')
{params.forEach(function(p){if(typeof p.name!='undefined'&&typeof p.value!='undefined'&&p.name!=''&&p.value!=''&&p.name.indexOf('-')==-1)qs.push(p.name+'='+p.value);})}
if(qs.length)querystring='?'+qs.join('&');if(document.querySelector('form #main-search-current_section')&&document.querySelector('form #main-search-current_section').value){window.location.href=document.querySelector('.main_search_bar').action+querystring;return;}
var checked=document.querySelector(".search-holder .type-selector input[name=search-type]:checked");if(checked.getAttribute('data-type')=='packs'&&!home_search)
{value=string_to_slug(value);var replaceSearchValue='word='+value+'&';replaceSearchValue=new RegExp(replaceSearchValue,"g");if(querystring.search(replaceSearchValue)==-1){replaceSearchValue='word='+value;replaceSearchValue=new RegExp(replaceSearchValue,"g");}
querystring=querystring.replace(replaceSearchValue,'');if(querystring.length<=1){querystring='';}
window.location.href=checked.getAttribute("data-url")+"/"+value+querystring;}
else
{window.location.href=checked.getAttribute("data-url")+querystring;}}
function valuation_request_comment(data){$_("#id_last_valuation").value=data.id;$_("#valuation_panel").style.display='none';$_("#valuation_comment_panel").style.display='block';}
var tabs=function(){var $tab=$('.tabs');function onClick(e){$this=$($(this).attr('href'));$this.parents('.tabs').find('.tabs-panel').removeClass('active');$this.addClass('active');e.preventDefault();};function onEvent(){for(i=0;i<$tab.length;i++){if($tab.eq(i).find('.tabs-nav').length===0)return;var btnH=$tab.eq(i).find('a:first').outerHeight(true);var tabH=$tab.eq(i).find('.tabs-nav').height();if(tabH>btnH){$tab.eq(i).addClass('tabs-accordion').find('.tabs-nav')
if($('.tabs-nav-wrapper').length===0)$tab.eq(i).find('.tabs-nav').wrap('<div class="tabs-nav-wrapper"></div>');}else $tab.eq(i).removeClass('tabs-accordion');}};$tab.find('.tabs-nav a, .tabs-panel a.tab-heading').click(onClick);$(window).bind('ready load resize',onEvent);};function insertCookiePolicy(){var date=new Date();date.setFullYear(date.getFullYear()+1);var domain=window.location.host.replace(/[^.]+\./,'');document.cookie="cookie_policy=true; expires="+date+"; path=/; domain=."+domain;$("#cookies-alert").slideUp();}
function validate_join_the_team(step){var errors=0;if(step=="1"){var name_input=$_("#msform #fullname");if(!name_input.value.trim().length){name_input.classList.add("error");errors++;}else{name_input.classList.remove("error");}
var email_input=$_("#msform #email");if(!validateEmail(email_input.value)){email_input.classList.add("error");errors++;}else{email_input.classList.remove("error");}
var contact_method_input=$_("#msform #contact-method");var selected=contact_method_input[contact_method_input.selectedIndex].value;if(!selected.length){contact_method_input.classList.add("error");errors++;}else{contact_method_input.classList.remove("error");}
var contact_user_input=$_("#msform #contact-user");if(!contact_user_input.value.trim().length&&selected!='email'){contact_user_input.classList.add("error");errors++;}else{contact_user_input.classList.remove("error");}}else{var domains={'dribbble':'https://dribbble.com/','behance':'https://behance.net/','personal-portfolio':[],'other-portfolio':[]};var filled=4;for(var i in domains){var domain_input=$_("#msform #"+i);var value=domain_input.value.trim();if(!domain_input.classList.contains('hascontent')){domain_input.classList.remove('error');filled--;continue;}
if(Array.isArray(domains[i])){if(value.indexOf('http://')!=0&&value.indexOf('https://')!=0||(!validateUrl(value)&&value!='http://')){errors++;domain_input.classList.add("error");}else{domain_input.classList.remove("error");if(value=='http://'||value=='https://')filled--;}}else{if(value.indexOf(domains[i])!=0||!validateUrl(value)){domain_input.classList.add("error");errors++;}else{domain_input.classList.remove("error");if(!value.split(domains[i])[1].length)filled--;}}}
if(!filled){for(var i in domains){$_("#msform #"+i).classList.add("error");}
errors++;}}
return(!errors)?true:false;}
function validateUrl(url){var myRegExp=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!10(?:\.\d{1,3}){3})(?!127(?:\.\d{1,3}){3})(?!169\.254(?:\.\d{1,3}){2})(?!192\.168(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]+-?)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/[^\s]*)?$/i;return myRegExp.test(url);}
function validateEmail(email){var re=/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;return re.test(email);}
function iconHover(e){var icons=document.querySelectorAll('ul.icons li.icon.hover');if(icons){[].forEach.call(icons,function(icon){icon.classList.remove('hover');});}
this.classList.add('hover');e.preventDefault();e.stopPropagation();}
function collectionHeaderHover(){touch=(('ontouchstart'in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0));if(!touch){return true;}
var headers=document.querySelectorAll('.collection .collection-header');document.body.classList.add('notouch');[].forEach.call(headers,function(header){header.classList.add('hover');});}
function checkLicense()
{var html_license=document.querySelector('.detail-footer .license');if(html_license)
{if(gr.auth.me.premium&&document.querySelector('#download-form #selection').value==1)
{html_license.classList.add('hidden');}
else
{html_license.classList.remove('hidden');}}}
function urlUserIcon(icon_id,user_id)
{user_id=(!user_id)?gr.auth.me.id:user_id;if(user_id&&icon_id)
{var folder=Math.floor(user_id/1000);return STATIC_URL+'user_icons/'+folder+'/'+user_id+'/'+icon_id+'.svg';}
return;}
function prepare_modal_download(type)
{document.querySelectorAll('.modal-collection-pack .modal-collection').forEach(function(elem){elem.classList.toggle('hidden',type=='pack');});document.querySelectorAll('.modal-collection-pack .modal-pack').forEach(function(elem){elem.classList.toggle('hidden',type=='collection');});}
function update_download_counter(delay)
{setTimeout(function(){if(gr.auth.me.id)
{$.ajax({cache:false,dataType:'json',url:'/ajax/download/user-stats',success:function(result)
{if(typeof result!='undefined')
{var badge=document.getElementById('icons_downloaded_counters');if(typeof badge!='undefined'&&typeof result!='undefined'&&result.max)
{badge.classList.remove('hidden');badge.innerHTML=number_format(result.now)+'/'+number_format(result.max);}
var perc=(gr.auth.me.premium)?0.8:0.5;var counter=Cookie.get('download_counter');if(!~~counter)
{if((result.now/result.max)>=perc)
{var url_support='http://support.flaticon.com/hc/en-us/articles/213303205-How-many-resources-can-I-download-';var msg=messages.limit.downloaded_icons_perc.replace('{0}',(perc*100))+'. <a href="'+url_support+'" target="_blank">'+messages.common.more_info+'</a>';var domain=window.location.host.replace(/[^.]+\./,'')||window.location.host;UserAlerts.warning(messages.common.download,msg,1);var tomorrow=new Date(new Date().getTime()+(12*60*60*1000));var expires="; expires="+tomorrow.toGMTString();var domain=window.location.host.replace(/[^.]+\./,'');document.cookie="download_counter=1"+expires+"; path=/; domain=."+domain;}}}}});}},delay);}
function number_format(num)
{var n=parseInt(num,10).toString();return n.replace(/\B(?=(\d{3})+(?!\d))/g,",");}
function popover_render(ev,element){var menu=element.parentElement.parentElement.get(".popover-content");var popoverContainer=menu.parentElement.parentElement;function removeAll(){[].forEach.call($_(".popover-content"),function(popover){if(popover==menu)return true;popover.classList.remove('show-menu');});[].forEach.call($_(".popover-button"),function(btn){btn.classList.remove('active');});[].forEach.call($_(".popover"),function(popover){if(popover==menu)return true;if(popover.classList.contains("hToggleRender")){popover.classList.remove('popover-right');}
if(popover.classList.contains("vToggleRender")){popover.classList.remove('popover-top');popover.classList.remove('popover-button');}});}
if(!element.classList.contains("active")){removeAll();menu.classList.add("show-menu");element.classList.add('active');}else{menu.classList.remove("show-menu");element.classList.remove('active');}
if(popoverContainer.classList.contains("hToggleRender")){renderPopoverWithHorizonalPossitionContext(popoverContainer,230);}
if(popoverContainer.classList.contains("vToggleRender")){renderPopoverWithVerticalPossitionContext(popoverContainer,100);}
ev.stopPropagation();}
function renderPopoverWithHorizonalPossitionContext(popover,menuW){if(popover.classList.contains("collectionIcon")){menuW=180+document.getElementById('collections-holder').getBoundingClientRect().left}
if(popover.querySelector('button.popover-button').getBoundingClientRect().left<menuW){popover.classList.add('popover-right');}else{popover.classList.add('popover-left');}}
function renderPopoverWithVerticalPossitionContext(popover,menuH){if(popover.querySelector('button.popover-button').getBoundingClientRect().bottom>window.innerHeight-menuH){popover.classList.add('popover-top');}else{popover.classList.add('popover-bottom');}}
function store_url(url)
{var not=['downloads-abuse','downloads-limit','limite-descargas','abuso-descargas'];if(!url)url=window.location.href;var ok=true;not.forEach(function(url_not){if(url.indexOf(url_not)!=-1)ok=false;});if(ok)
{var date=new Date();date.setTime(date.getTime()+(60*60*1000));var expires="; expires="+date.toGMTString();var cookie_text="CB_URL="+url+expires+";path=/;domain="+window.location.host.replace(/[^.]+\./,'');document.cookie=cookie_text}}
function checkHybriDevices(){touch=(('ontouchstart'in window)||(navigator.MaxTouchPoints>0)||(navigator.msMaxTouchPoints>0));if(touch){document.body.classList.add('notouch');}}
function copyLinkInInput(input){input.select();document.execCommand("Copy");UserAlerts.success(messages.link.copied,messages.link.success,0);}
function sendGaFromContextMenu(element){var arrayPos=searchStringInArray("GA_CM_",element.classList);if(arrayPos===-1)return false;var gaData=element.dataset.ga_params.split(",");ga('send','event',gaData[0],gaData[1],gaData[2]);}
function searchStringInArray(str,strArray){for(var j=0;j<strArray.length;j++){if(strArray[j].match(str))return j;}
return-1;}
function showCarbonBanner(script_id,div_id,code){var show=(typeof gr!='undefined'&&gr.auth.me.premium==1)?false:true;var codesAvailables=['CK7DK2JM','CK7D5K3W','CK7D5K3J'];if(show){if(document.getElementById(script_id)){if(document.getElementById(div_id)){_carbonads.reload(document.getElementById(div_id));}}else{var carbonScriptDetail=document.createElement('script');var carbonWrapperDetail=document.getElementById(div_id);carbonScriptDetail.async=true;carbonScriptDetail.id=script_id;carbonScriptDetail.src="//cdn.carbonads.com/carbon.js?serve="+code+"&placement=flaticoncom";if(carbonWrapperDetail){carbonWrapperDetail.appendChild(carbonScriptDetail);}}}};if(!Element.prototype.hasOwnProperty("parent")){Element.prototype.parent=function(s){var list=this.parents(s);if(typeof s=="undefined")list.reverse();return(list&&list.length)?list[0]:null;};}
$(function(){window.awesompletes=[];[].forEach.call(document.querySelectorAll(".autocomplete"),function(e){var home_search=e.classList.contains('home_search_input');var awesomplete=new Awesomplete(e,{minChars:2,item:function(text,input){var tag={icons:0,items:[],tag_id:0,tag:''};for(var i in window.autocompleteTags){if(window.autocompleteTags[i].tag==text){tag=window.autocompleteTags[i];break;}}
if(tag.hasOwnProperty("packs"))
{tag.icons=tag.packs;}
var html='<div class="text-container">\
    <div class="text">$$<span class="total-items"> ('+tag.icons+')</span></div></div>';var search_radio=document.querySelector(".search-holder .type-selector input[name=search-type]:checked");var packs=false;if(search_radio&&!home_search)
{packs=search_radio.getAttribute("data-type")=='packs';}
if(!packs)
{html+='<ul class="autocomplete-icons">';tag.items.forEach(function(icon){var folder=Math.floor(icon.id/1000);html+='<li><img src="'+STATIC_URL+['icons/png/128',folder,icon.id].join("/")+'.png" style="width: 24px"></li>';});}
html+="</ul>";html=html.replace("$$",text.toLowerCase().replace(new RegExp((input.toLowerCase()),"g"),"<mark>"+input.toLowerCase()+"</mark>"));return Awesomplete.$.create("li",{innerHTML:html,"aria-selected":"false"});},sort:function(){}});window.awesompletes.push(awesomplete);$(e).on("awesomplete-selectcomplete",function(ev){e.value=e.value.trim().split("(")[0].trim();var form=e.parent("form");if(typeof track_search!='undefined')
{track_search(e.value,form);}
else
{form.submit();}}).on('blur',function(e){e.value='';});});$('.autocomplete').keyup(function(e){var home_search=this.classList.contains('home_search_input');if([27,13,37,38,39,40,106,191].indexOf(e.keyCode)==-1){var value=this.value.replace(/[^a-z0-9\s]+/gi,'');if(value!==this.value){this.value=value;}
var value=(typeof filterSpecialChars=='function')?filterSpecialChars(this.value):this.value;var text=encodeURIComponent(this.value);var search_radio=document.querySelector(".search-holder .type-selector input[name=search-type]:checked");var packs=false;if(search_radio&&!home_search)
{packs=(search_radio.getAttribute("data-type")=='packs');}
var url=(packs)?APP_URL+'ajax/autocomplete_packs?term='+text:APP_URL+'ajax/autocomplete/'+text;if(text&&text.length>1){$.ajax({url:encodeURI(url),type:'GET',success:function(response){var json=JSON.parse(response);parser_autocomplete(json);}});}}});function parser_autocomplete(data,packs){window.autocomplete=[];window.autocompleteTags=data;for(var tag in data){window.autocomplete.push(data[tag].tag);}
window.awesompletes.forEach(function(element){element.list=window.autocomplete;});}});;function load_data_share(){var elem_share_url=document.querySelector("meta[property='og:url']");var elem_share_img=document.querySelector("meta[property='og:image']");var elem_share_tit=document.querySelector("meta[name='twitter:title']");var elem_share_des=document.querySelector("meta[property='og:description']");var url_qs=(document.location.search)?document.location.search:'';var url_full=document.location.protocol+'//'+document.location.host+document.location.pathname+url_qs;var url=url_full;var image=(elem_share_img)?elem_share_img.content:'';var title=(elem_share_tit)?elem_share_tit.content:document.title;var desc=(elem_share_des)?elem_share_des.content:document.title;var pathname=window.location.pathname;return{url:url,image:image,title:title,desc:desc,pathname:pathname};}
function fbpopup(data){if(typeof data=='undefined'){data=load_data_share();}
var openUrl='http://www.facebook.com/sharer.php?u='+data.url;window.open(openUrl,"fbshare","height=380,width=660,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0");ga('send','event','Social','Facebook',data.pathname);}
function pinpopup(data){if(typeof data=='undefined'){data=load_data_share();}
var openUrl='http://pinterest.com/pin/create/button/?url='+data.url+'&description='+data.title+'&media='+data.image;window.open(openUrl,"pinshare","height=270,width=630,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0");ga('send','event','Social','Pinterest',data.pathname);}
function glpopup(data){if(typeof data=='undefined'){data=load_data_share();}
var openUrl='https://plus.google.com/share?url='+data.url;window.open(openUrl,"glshare","height=270,width=630,resizable=0,toolbar=0,menubar=0,status=0,location=0,scrollbars=0");ga('send','event','Social','Google+',data.pathname);}
function tweet(e,data){if(e.hasOwnProperty("preventDefault"))
{e.preventDefault();}
if(typeof data=='undefined'){data=load_data_share();}
var openUrl='http://twitter.com/share?url='+data.url+'&text='+data.title+'&';window.open(openUrl,'Flaticon Twitter Share','height=450,width=550,top='+($(window).height()/2-225)+',left='+$(window).width()/2+',toolbar=0,location=0,menubar=0,directories=0,scrollbars=0');ga('send','event','Social','Twitter',data.pathname);};function _position(children,item){var position=this;var el;function setSelectors(){el={wrapper:document.querySelector(".search-result .icons"),children:children,item:item[0]};};function itemPosition(element){if(!element){return;}
var display=el.children.length>80;var rowElements=calculateIconsInRow();position.values.children.rows=Math.ceil((el.children.length/10)/position.values.children.max);position.values.children.ideal=position.values.children.rows*rowElements;position.current=el.children[--position.values.children.ideal];if(position.current&&display)
{position.current.bound=position.current.getBoundingClientRect();var iconMargin=parseInt(getComputedStyle(position.current).marginBottom,10);if(iconMargin>16){var marginCounts=iconMargin*position.values.children.rows;}else{var marginCounts=iconMargin*2*position.values.children.rows;}
position.current.style.marginBottom=(element.outerHeight(true)+position.values.children.margin)+iconMargin*2+'px';element.style.top=position.current.bound.height*position.values.children.rows+iconMargin+marginCounts+"px";}
element.style.visibility='visible';element.style.display=display?'block':'none';}
function resetPosition(){[].forEach.call(el.children,function(element){element.removeAttribute('style');});if(el.item){el.item.removeAttribute('style');}}
function calculateIconsInRow(){var iconsInRow=1;var length=el.children.length;for(var i=1;i<length;i++){if(i>0)
{if(el.children[i].getBoundingClientRect().top!=el.children[i-1].getBoundingClientRect().top)break;iconsInRow++;}}
return iconsInRow;}
this.set=function(){if(position.timer)clearTimeout(position.timer);if(el.children[0])
{position.timer=setTimeout(function(){position.values={children:{}};position.values.children.width=el.children[0].outerWidth(true);position.values.children.height=el.children[0].outerHeight(true);position.values.children.margin=parseInt(getComputedStyle(el.children[0]).marginBottom);position.values.children.max=Math.floor(el.wrapper.outerWidth(true)/position.values.children.width);resetPosition();itemPosition(el.item);},100);}}
this.start=function(){setSelectors();position.set();if(typeof Premium=='object')Premium.bannerSearch();}};if(!~~gr.auth.me.premium&&window.matchMedia("(min-width: 740px)").matches)
{if(document.querySelector('.edge-content-icon-list'))
{var iconsWrapper=document.querySelector(".search-result .icons");var sponsorPosition=new _position(iconsWrapper.getElementsByClassName('icon'),document.getElementsByClassName('edge-content-icon-list'))
$(window).on('resize',sponsorPosition.set);$(document).on('ready',sponsorPosition.start);}}
else
{checkPremiumBanners();}
function checkPremiumBanners()
{[].forEach.call(document.querySelectorAll("div.edge-content, li.edge-content, iframe.edge-content-iframe"),function(e){e.parentNode.removeChild(e);});};if(typeof gr.sponsor!=='undefined')gr.log('gr.sponsor ya est definido');gr.sponsor={base_url:SPONSOR_BASE_URL,popup:{cookie_name:'launcher_popup',url:(typeof pu_url!='undefined')?pu_url:'',launch:function(){if(gr.auth.me.premium=="1")return false;if(gr.sponsor.popup.url==='')return false;if(!gr.cookie(gr.sponsor.popup.cookie_name))
{var url=gr.sponsor.popup.url;if(typeof clientId!=="undefined"&&clientId){url+='&track_sub_id4='+clientId}
pu(url);if(typeof appf!=="undefined")language=(appf==='')?"_english":appf;if(typeof ga!=="undefined")ga('send','event','busquedas','show-popup',language,{'dimension15':'true'});var exdate=new Date();exdate.setHours(exdate.getHours()+12);document.cookie=gr.sponsor.popup.cookie_name+"="+"1"+(";expires="+exdate.toUTCString())+(";domain="+document.domain)+";path=/";}}},coupon:{cookie_name:'sponsor_coupon',coupon_url:(typeof(SPONSOR_BASE_URL)!="undefined"&&typeof(LANGUAGE)!="undefined")?SPONSOR_BASE_URL+'coupons/popup?lang='+LANGUAGE+'&k='+new Date().toISOString().substr(0,10):'http://ads.freepik.com/coupons/popup?lang=&k='+new Date().toISOString().substr(0,10),launch:function(){if(gr.auth.me.premium=="1"||typeof(disallow_coupon)!="undefined")return false;var pages=12;var cookie_days=2;if((Math.floor(Math.random()*pages)+1)<=1)
{counted=1;if(gr.cookie(gr.sponsor.coupon.cookie_name))counted=parseInt(gr.cookie(gr.sponsor.coupon.cookie_name))+1;if(!gr.cookie(gr.sponsor.coupon.cookie_name)||counted<2)
{$.get(gr.sponsor.coupon.coupon_url,function(data)
{$('#footer').after(data);if(typeof ga!=="undefined")ga('send','event','coupon','view','');var fecha_hoy=new Date();fecha_hoy.setDate(fecha_hoy.getDate()+cookie_days);var expires="; expires="+fecha_hoy.toGMTString();document.cookie=gr.sponsor.coupon.cookie_name+"="+counted+expires+"; path=/";});}}}},get:function(params)
{if(typeof params=='undefined')params={};if(typeof params.container=='undefined')return false;gr.request.get(gr.sponsor.base_url+'banner/ajax_search',params);}};function gr_sponsor_callback(data)
{if(data.container=='undefined')
{console.log('ERROR: no container defined');return;}
console.log(data);if(typeof data.js_files!='undefined')
{for(i=0;i<data.js_files.length;i++)
{var e=document.createElement('script');e.type='text/javascript';e.src=data.js_files[i];var s=document.getElementsByTagName('script')[0];s.parentNode.insertBefore(e,s);}}
if($(data.container).length===0)
{console.log('ERROR: no container exists');return;}
$(data.container).html(data.html);if(typeof data.google_analytics_id!='undefined')
{(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create',data.google_analytics_id,'auto');ga('send','pageview');}
if((typeof data.statcounter_id!='undefined')||(typeof data.statcounter_sc!='undefined'))
{sc_project=data.statcounter_id;sc_invisible=1;sc_security=data.statcounter_sc;sc_https=1;var sc=document.createElement('script');sc.type='text/javascript';sc.async=true;sc.src=('https:'==document.location.protocol?'https://secure':'http://www')+'.statcounter.com/counter/counter.js';var ssc=document.getElementsByTagName('script')[0];ssc.parentNode.insertBefore(sc,ssc);}
callbackFn=window[data.post_callback];if(typeof callbackFn==='function')callbackFn(data);};$(function(){if(detectBrowser()!='IE')
{$('#detail-overlay').click(function(e){if(e.target.parentNode.classList.contains('loading'))
{ModalDetail.close();ModalDetail.pushState({page:'pagination'},document.title,ModalDetail.prev_url);}});$('#detail-close').on('click',function(e){e.preventDefault();ModalDetail.pushState({page:'pagination'},document.title,ModalDetail.prev_url);ModalDetail.close();});$(document).on('click','#detail-overlay #detail-prev',function(e){e.preventDefault();ModalDetail.goPrev();});$(document).on('click','#detail-overlay #detail-next',function(e){e.preventDefault();ModalDetail.goNext();});$(document).on('click','.collectionIcon .link-icon-detail',function(e){e.preventDefault();e.stopPropagation();document.location=this.href;});$(document).on('click','.link-icon-detail',function(e){if(!document.querySelector('#detail.loaded'))
{e.preventDefault();var url=this.href;var id=this.dataset.id;if(!ModalDetail.id)
{ModalDetail.prev_url=document.location.href;ModalDetail.saveOGData();}
if(id&&url)
{var container=document.getElementById('detail-overlay');container.classList.remove('hidden');container.classList.add('loading');document.getElementById('detail-spinner').classList.remove('hidden');if(ModalDetail.id)
{ModalDetail.hideNavigation();}
ModalDetail.id=id;ModalDetail.getDetail(url);ModalDetail.pushState({page:'icon'},document.title,url);$('#detail-wrapper').animate({scrollTop:0},'slow');return;}}});}});var ModalDetail={id:0,navigation:1,prev_url:document.location.href,icons_view:0,og_keys:['twitter:title','twitter:description','twitter:image','og:title','og:url','og:description','og:image'],og_data:{},checkNavigation:function(direction,url)
{if(direction=='next')
{document.getElementById('detail-next').classList.toggle('hidden',!url);}
if(direction=='prev')
{document.getElementById('detail-prev').classList.toggle('hidden',!url);}},hideNavigation:function()
{document.getElementById('detail-next').classList.add('hidden');document.getElementById('detail-prev').classList.add('hidden');this.navigation=0;},showNavigation:function()
{document.getElementById('detail-next').classList.remove('hidden');document.getElementById('detail-prev').classList.remove('hidden');this.navigation=1;},getPrev:function(id)
{if(id)
{var element=document.querySelector('.search-result li[data-id="'+id+'"]');if(!element)return{id:null,url:null};var elem_prev=element.previousElementSibling;if(elem_prev)
{var id_prev=elem_prev.dataset.id;var prev=elem_prev.querySelector('a');if(prev&&id){return{id:id_prev,url:prev.href};}}}
return{id:null,url:null};},getNext:function(id)
{if(id)
{var element=document.querySelector('.search-result li[data-id="'+id+'"]');if(!element)return{id:null,url:null};var elem_next=element.nextElementSibling;if(elem_next)
{var id_next=elem_next.dataset.id;var next=elem_next.querySelector('a');if(next&&id){return{id:id_next,url:next.href};}}}
return{id:null,url:null};},goNext:function()
{ga('send','event','Detail View','Move','Next');this.go_to('next');},goPrev:function()
{ga('send','event','Detail View','Move','Previous');this.go_to('prev');},go_to:function(direction)
{var data=(direction=='prev')?this.getPrev(this.id):this.getNext(this.id);var url=data.url||null;var id=data.id||null;if(url&&id)
{if(!this.prev_url)this.prev_url=document.location.href;this.pushState({page:'icon'},document.title,url);this.id=id;this.getDetail(url);}},go:function(url)
{if(url)
{if(!document.querySelector('#detail.loaded'))
{var id=this.getId(url);if(id){if(!this.prev_url)this.prev_url=document.location.href;this.pushState({page:'icon'},document.title,url);this.id=id;this.getDetail(url);return;}}
else
{document.location.href=url;}}
this.close();},close:function()
{document.querySelector('body').classList.remove('unscrollable');var container=document.getElementById('detail-overlay');container.classList.remove('loading','ready');container.classList.remove('hidden');container.querySelector('.content').innerHTML='';this.restoreOGData();this.icons_view=0;this.id=0;},getDetail:function(url)
{if(url!='')
{var that=this;$.ajax({type:'GET',url:url,data:{'ax':1},success:function(resp){detailModal=document.getElementById('detail-wrapper');scrollPosition=getDetailScrollPosition(detailModal,null);var url_path=url.replace(APP_URL,'');ga('send','pageview','/'+url_path);var container=document.getElementById('detail-overlay');container.classList.remove('hidden');container.classList.add('loading','ready');document.querySelector('body').classList.add('unscrollable');container.querySelector('.content').innerHTML=resp;document.getElementById('detail-spinner').classList.add('hidden');if(gr.auth.me.premium||window.matchMedia("(max-width: 740px)").matches)
{checkPremiumBanners();}
var checked_grid=document.querySelector(".grid_selector input[name=grid]:checked");if(checked_grid)
{if(checked_grid.value=='big')
{[].forEach.call(document.querySelectorAll("#detail-content .icons"),function(grid){grid.classList.add('big');});}}
Premium.check();ModalDetail.icons_view++;var dataNext=ModalDetail.getNext(ModalDetail.id);ModalDetail.checkNavigation('next',dataNext.url);var dataPrev=ModalDetail.getPrev(ModalDetail.id);ModalDetail.checkNavigation('prev',dataPrev.url);var premium=~~document.querySelector("#download-form #premium").value;var overlay=document.getElementById("detail-overlay");if(overlay)
{if(premium&&!gr.auth.me.premium)
{overlay.classList.add("premium-lock");}
else
{overlay.classList.remove("premium-lock");}}
that.updateOGData(premium);$('#detail_picker').colpick({layout:'hex',submit:0,flat:true,onChange:function(hsb,hex,rgb,el,bySetColor){$(el).css('border-color','#'+hex);if(!bySetColor)
$(el).val(hex);ls.color='#'+hex;changeSVGcolor();}});if(typeof toggleDetailButton=='function')
{toggleDetailButton();}
if(typeof checkLicense=='function')
{checkLicense();}
if(typeof Premium=='object')
{Premium.check();}
var container=document.getElementById('detail-overlay');container.classList.remove('hidden');container.classList.add('ready');document.getElementById('detail-spinner').classList.add('hidden');get_currency();showCarbonBanner('_carbonads_js','carbon728x90','CK7DK2JM');},error:function(){ModalDetail.close();}});}},getId:function(url)
{var a=document.querySelector('a[href="'+url+'"]');var id=(a)?parseInt(a.parentNode.parentNode.dataset.id,10):null;return id;},pushState:function(state,title,url)
{if(typeof window.history=='object')
{window.history.pushState(state,title,url);}
else
{History.pushState(state,title,url);}},replaceState:function(state,title,url)
{History.replaceState(state,title,url);},saveOGData:function()
{var attribute;this.og_data.title=document.title;var data=this.og_data;this.og_keys.forEach(function(key){var attribute=(key.indexOf("twitter")!=-1)?'name':'property';data[key]=document.querySelector('meta['+attribute+'="'+key+'"]').content;});this.og_data=data;},restoreOGData:function()
{var value;for(var key in this.og_data){value=this.og_data[key];if(key=='title'){document.title=value;continue;}
var attribute=(key.indexOf('twitter')!==-1)?'name':'property';document.querySelector('meta['+attribute+'="'+key+'"]').content=value;}},updateOGData:function(premium)
{var is_premium=(premium==1);var _search=is_premium?messages.common.free+" ":"premium ";var _replace=is_premium?"premium ":messages.common.free+" ";var description=$_(".detail-header h1 span.title").innerHTML;description=description.charAt(0).toUpperCase()+description.slice(1);var author=$_(".detail-header .author a.avatar").title;var category=$_(".detail-header .category-icon").innerHTML;var team=$_("#download-form #team").value;var id=parseInt($_("#download-form #icon_id").value,10);var title=messages.og.webtitle.format(description,category);document.title=title.replace(new RegExp("("+_search+")",'gi'),capitalize(_replace));this.og_keys.forEach(function(key){var splitted=key.split(":");var type=key.split(":")[1];var attribute=(splitted[0]=='twitter')?'name':'property';switch(type){case'description':var desc=messages.og.desc;document.querySelector('meta['+attribute+'="'+key+'"]').content=messages.og.desc.replace(new RegExp("("+_search+")",'gi'),_replace);break;case'title':document.querySelector('meta['+attribute+'="'+key+'"]').content=messages.og.title.format(description,author).replace(new RegExp("("+_search+")",'gi'),_replace);break;case'url':document.querySelector('meta['+attribute+'="'+key+'"]').content=document.location.href;break;}});var keywords=document.querySelector('meta[name="keywords"]');if(keywords)keywords.content=keywords.content.replace(new RegExp("("+_search+")",'gi'),_replace);var imageog="https://image.flaticon.com/{0}/png/512/{1}/{2}.png?size=1200x630f&pad=10,10,10,10&ext=png&bg=FFFFFFFF".format(team,Math.floor(id/1000),id);document.querySelector('meta[property="og:image"]').content=imageog;document.querySelector('meta[name="twitter:image"]').content=imageog;}};$(document).ready(function(){INFINITY.init();INFINITY.is_search();if(document.getElementById('pagination-form'))
{INFINITY.currentPage=INFINITY.initPage;var totalPages=Math.ceil(INFINITY.total/INFINITY.count,10);document.getElementById('pagination-total').innerHTML=totalPages;document.getElementById('pagination-page').value=INFINITY.currentPage;INFINITY.check_pagination_buttons();$('#pagination-form').on('submit',function(e){e.preventDefault();INFINITY.infinityLoaderBtn(INFINITY.axScript,'go');return false;});$('a.pagination-next').on('click',function(e){e.preventDefault();e.stopPropagation;document.getElementById('pagination-spinner').classList.remove('hidden');INFINITY.infinityLoaderBtn(INFINITY.axScript,'next');return;});$('a.pagination-prev').on('click',function(e){e.preventDefault();e.stopPropagation;document.getElementById('pagination-spinner').classList.remove('hidden');INFINITY.infinityLoaderBtn(INFINITY.axScript,'prev');return;});}
if(typeof'hideBox'=='function')
{hideBox();if(INFINITY.total_found_packs)
{$(window).on('resize',function(){hideBox();});}}
$(".pagination ul li a").on("click",function(){if(typeof gr.sponsor!='undefined'&&gr.sponsor!=null)
{if(typeof(gr.sponsor.popup)!="undefined"&&!gr.auth.me.premium)gr.sponsor.popup.launch();}});var empty_search_element=$_('.empty-search');if(empty_search_element)
{if(INFINITY.total==0)
{$('.edge-content-iframe').hide();empty_search_element.classList.toggle("hidden",INFINITY.total>0);if(document.getElementById('pagination-more')){document.getElementById('pagination-more').classList.add('hidden');}}
else
{$('.edge-content-iframe').show();empty_search_element.classList.toggle("hidden",INFINITY.total>0);if(document.getElementById('pagination-more')){document.getElementById('pagination-more').classList.remove('hidden');}}
if(typeof document.querySelector(".main_search_bar input[name='word']")!='undefined')
{var word=document.querySelector(".main_search_bar input[name='word']").value;if(document.querySelector('.empty-search').className.indexOf('hidden')==-1&&word.length)
{var type=localStorage['search-type'];type=(['icons','packs'].indexOf(type)!=-1)?type:'icons';ga('send','event','Search',type,'Empty',{'dimension9':word});}}}
if((document.getElementById('pagination-total')==null)||(parseInt(document.getElementById('pagination-total').innerHTML,10)<=1))
{if(document.getElementById('pagination-more')){document.getElementById('pagination-more').classList.add('hidden');}}});var INFINITY={infinityLoading:0,activatedInfinity:0,initPage:1,topPage:1,currentPage:1,bottomPage:1,count:0,total:0,total_icons:0,total_premium:0,axScript:'',css_selector:'',functionParser:'',cache_items:[],lastPage:this.currentPage,preLoad:true,setUrl:true,infinityCallback:'',fi_sponsor:{},total_found_packs:0,word:'',init:function()
{if(typeof INFINITY_CONFIG!="undefined")
{for(var i in INFINITY_CONFIG)
{INFINITY[i]=INFINITY_CONFIG[i];}}},infinity:function(script,force_page){if(typeof force_page!=='undefined')
{this.axLoadItems(script,force_page,true);}
else
{this.infinityLoading=1;this.bottomPage=this.bottomPage+1;this.axLoadItems(script,this.bottomPage,true);}},is_in_cache:function(page)
{if(this.cache_items.length>10)this.cache_items.shift();for(var i=0;i<this.cache_items.length;i++)
{if(this.cache_items[i].page==page)
return this.cache_items[i];}
return false;},pagination_update:function()
{if(document.getElementById('pagination-total'))
{document.getElementById('pagination-total').innerHTML=Math.ceil(this.total/this.count,10);document.getElementById('pagination-page').value=this.currentPage;}
if(document.getElementById('pagination-more')){document.getElementById('pagination-more').classList.toggle("hidden",this.currentPage==Math.ceil(this.total/this.count,10))}
var badge=document.getElementById('total_icon_badge');if(badge)
{var txt_icons='';if(badge.innerHTML.indexOf('icon')!=-1)txt_icons=(LANGUAGE=='spanish')?'iconos':'icons';badge.innerHTML=this.total.toLocaleString('en-US')+' '+txt_icons;}
var badge_pack=document.querySelector('.pack-header .list-header-title .badge');if(badge_pack)
{var txt_icons='';if(badge_pack.innerHTML.indexOf('icon')!=-1)txt_icons=(LANGUAGE=='spanish')?'iconos':'icons';badge_pack.innerHTML=this.total.toLocaleString('en-US')+' '+txt_icons;}
var empty_search_element=$_('.empty-search');var cache=this.is_in_cache(this.currentPage);if(empty_search_element&&cache){empty_search_element.classList.toggle("hidden",cache.items.length>0);if(this.total==0)$('.edge-content-iframe').hide();}
$show_carrousel=this.currentPage==1;var packs_related=document.querySelector(".search-pack-result:not(.similar-packs)");var packs_related_text=document.querySelector(".search-pack-result-text");if(packs_related)
{packs_related.style.display=$show_carrousel?'':'none';}
if(packs_related_text)
{packs_related_text.style.display=$show_carrousel?'none':'';}
$(window).trigger("resize");},axLoadItems:function(script,page,render)
{var url=script;if(page>1){url=url+'/'+page;}
var pos=window.location.href.lastIndexOf('?');if(pos!=-1){url=url+'?'+window.location.href.substring(pos+1,window.location.href.length);}
if(url.indexOf('undefined')!=-1)return false;var cache=this.is_in_cache(page);if(cache&&render)
{this.tplLoadItem(cache.items,page);this.pagination_update();}
if(!cache)
{if(typeof script!=='undefined'&&script!=''){var group_id=parseInt(document.getElementById('group_id').value,10)||0;if(script=='/ajax/packs/search'&&group_id)
{url=addVarQueryString(url,'group_id',group_id);}
var self=this;$.ajax({url:url,type:'get',dataType:'json',success:function(json){var arrItems=json.items||[];var t=parseInt(json.total,10)||0;var btn_patterns=document.querySelector(".btn-pattern");if(btn_patterns)
{var href=btn_patterns.href.split("#");href.pop();if(arrItems[0])
{if(typeof arrItems[0].pack_slug!='undefined')
{var slug=arrItems[0].pack_slug.split("/");slug=slug.pop();href.push("pack="+slug);btn_patterns.href=href.join("#");}}}
self.cache_items.push({'page':page,'items':arrItems,'total':t});if(render)
{self.currentPage=page;self.total=t;self.tplLoadItem(arrItems,page);self.pagination_update();self.check_pagination_buttons();}},error:function(jqXHR,textStatus,errorThrown){document.getElementById('pagination-spinner').classList.add('hidden');self.infinityLoading=0;}});}}},infinityLoaderBtn:function(script,next_prev)
{var banner=$_(".edge-content-icon-list");if(banner)
{banner.style.display='none';}
this.lastPage=this.currentPage;if(next_prev=='go')
{var p=parseInt(document.getElementById('pagination-page').value,10);this.infinityLoading=1;this.currentPage=(!isNaN(p)&&p>0&&p<=Math.ceil(this.total/this.count))?p:1;this.bottomPage=this.currentPage;this.initPage=this.currentPage;this.axLoadItems(script,this.currentPage,true);if(this.preLoad)
{if((this.total>((this.currentPage)*this.count)))this.axLoadItems(script,this.currentPage+1,false);}}
if(next_prev=='clear')
{this.infinityLoading=1;this.currentPage=1;this.initPage=this.currentPage;this.bottomPage=this.currentPage;this.axLoadItems(script,this.currentPage,true);if(this.preLoad)
{if((this.total>((this.currentPage)*this.count)))this.axLoadItems(script,this.currentPage+1,false);}}
if(next_prev=='next')
{this.currentPage++;if((this.total>((this.currentPage-1)*this.count))){this.infinityLoading=1;this.bottomPage=this.currentPage;this.axLoadItems(script,this.currentPage,true);if(this.preLoad)
{if((this.total>((this.currentPage)*this.count)))this.axLoadItems(script,this.currentPage+1,false);}}else{this.infinityLoading=0;this.currentPage--;}}
if(next_prev=='prev')
{this.currentPage--;if(this.currentPage>=1){this.topPage=this.currentPage;this.infinityLoading=1;this.axLoadItems(script,this.currentPage,true);if(this.preLoad)
{if(this.currentPage>1)this.axLoadItems(script,this.currentPage-1,false);}}else{this.infinityLoading=0;this.currentPage=1;}}
this.check_pagination_buttons();window.scrollTo(0,0);},check_pagination_buttons:function()
{var pagination_more=document.getElementById('pagination-more');var pagination_less=document.getElementById('pagination-less');var n_pags=0;var self=this;if(document.getElementById('pagination-total'))
n_pags=parseInt(document.getElementById('pagination-total').innerHTML,10);if(document.querySelector('.list-options .pagination-simple'))
document.querySelector('.list-options .pagination-simple').classList.toggle('hidden',n_pags==1);document.querySelectorAll('.pagination-prev').forEach(function(link){link.classList.toggle('disabled',self.currentPage==1);if(pagination_less){pagination_less.classList.toggle('hidden',self.currentPage==1);}});document.querySelectorAll('.pagination-next').forEach(function(link){link.classList.toggle('disabled',(self.currentPage==n_pags)||(n_pags==0));});var exist_pag_next=document.querySelectorAll('.pagination-next').length;var exist_pag_prev=document.querySelectorAll('.pagination-prev').length;if(document.get('#pagination-form .pagination-next')&&document.get('#pagination-form .pagination-prev'))
{if(document.get('#pagination-form .pagination-next').classList.contains('disabled')&&document.get('#pagination-form .pagination-prev').classList.contains('disabled'))
{if(document.querySelector('.pagination-next').classList.contains('disabled'))
{if(pagination_more){pagination_more.classList.add("hidden");pagination_less.classList.remove("hidden");}}
else
{if(pagination_more){pagination_more.classList.remove('hidden');pagination_less.classList.add("hidden");}}}}
if(exist_pag_next&&exist_pag_prev)
{if(document.get('#pagination-form .pagination-next').classList.contains('disabled')&&document.get('#pagination-form .pagination-prev').classList.contains('disabled'))
{document.get('#pagination-form').style.display='none';if(pagination_more){pagination_more.classList.add("hidden");pagination_less.classList.remove("hidden");}}
else
{document.get('#pagination-form').style.display='block';}}
if(document.getElementById('didyoumean'))
document.getElementById('didyoumean').classList.toggle('hidden',self.currentPage>1);},tplLoadItem:function(json,page)
{this.css_selector=(this.css_selector==''||typeof this.css_selector===undefined)?'ul.icons:not(.collection_icons_list)':this.css_selector;$(this.css_selector).empty();var element=document.get(this.css_selector);if(typeof this.fi_sponsor.freepik!='undefined'&&!~~gr.auth.me.premium&&window.matchMedia("(min-width: 740px)").matches)
{page_sponsor=page%14;if(page>=14)page_sponsor++;this.fi_sponsor.freepik.page=page_sponsor;this.fi_sponsor.partner.page=page_sponsor;var li_carbon=document.createElement("li");if(li_carbon)
{li_carbon.id='banner-icon-list';li_carbon.className='edge-content edge-content-icon-list edge-content-first  edge--carbon show';li_carbon.style.display='none';var div_carbon=document.createElement("div");div_carbon.id="carbon728x90_search";div_carbon.className='carbon--large carbon-wrapper edge-content-iframe';li_carbon.appendChild(div_carbon);}
var freepik=document.querySelector('section.search-result ul.icons');if(freepik)
{freepik.appendChild(li_carbon);}
var div_sponsor=document.createElement("div");if(div_sponsor)
{div_sponsor.className='edge-content edge-content-first show last-edge-content';div_sponsor.innerHTML=this.fi_sponsor.partner.url.replace('---PAGE---',this.fi_sponsor.partner.page);}
var sponsor=document.querySelector('.last-edge-content');if(sponsor)
{sponsor.innerHTML='';sponsor.appendChild(div_sponsor);}}
if(document.getElementById('pagination-spinner'))
document.getElementById('pagination-spinner').classList.add('hidden');if(document.getElementById('filters-spinner'))
document.getElementById('filters-spinner').classList.add('hidden');if(element&&!isNaN(this.topPage)&&!isNaN(this.bottomPage)&&json.length>0){var page=this.currentPage;var tpl=Handlebars.tag(this.templateTag);var total_counter=$('.total-items');if(typeof total_counter!='undefined'&&total_counter!=null)
{$('.total-items').html(this.total.toLocaleString('en-US'));}
json.forEach(function(item,index){item.selection=Boolean(Number(item.selection));if(index==1){item.page=page;}
element.insertAdjacentHTML('beforeend',tpl(item));if(index==100)return false;});if(this.setUrl)
{var url_end=getUrlNavigation(urlWithoutPag(window.location.href),this.currentPage,window.location.search);if(typeof window.history=='object')
window.history.pushState({page:'pagination'},document.title,url_end);else
History.pushState({page:'pagination'},document.title,url_end);store_url(url_end);var urlClean=urlWithoutPag(window.location.href);window.url=urlClean;var urlCleanPage=getUrlNavigation(urlClean,page)
var url_path=urlCleanPage.replace(APP_URL,'');ga('send','pageview','/'+url_path);ga('send','pageview',url_path,{'metric1':page,'dimension9':parseQueryString(decodeURIComponent(window.location.search))['word'],});}
this.setUrl=true;if(document.getElementById('carbon728x90_search')){document.getElementById('carbon728x90_search').innerHTML='';showCarbonBanner('_carbonads_js','carbon728x90_search','CK7D5K3W');}
if(typeof Widget!='undefined'&&Widget!=null)Widget.markSelectedIcons();$(window).resize();}
if(typeof this.infinityCallback!='undefined')
{if(typeof this.infinityCallback=='string')
{this.infinityCallback=this.infinityCallback.split(".");}
if(typeof this.infinityCallback!='undefined')
{if(this.infinityCallback instanceof(Array))
{var method;this.infinityCallback.forEach(function(segment){method=(!method)?window[segment]:method[segment];if(typeof method=='function')method();});}}
this.infinityLoading=0;}
Premium.init();this.addFakeIconsToList();},is_search:function()
{var no_filters=(window.location.search.replace('?word=','').indexOf('=')==-1);if(['/resultados','/search'].indexOf(window.location.pathname)!=-1&&no_filters)
{var i={};i.a='numResults';i.premium=parseInt(this.total_premium);i.selection=0;i.total=parseInt(this.total);i.term=this.word;i.k=Date.now();var trk_image=new Image();trk_image.src="https://trk.flaticon.com/search_positions.gif?search-"+language+"&"+this.serialize(i);}},serialize:function(o){var s=[];for(var p in o)
{if(o.hasOwnProperty(p)){s.push(encodeURIComponent(p)+"="+encodeURIComponent(o[p]));}}
return s.join("&");},addFakeIconsToList:function(){var container=document.querySelector('section.search-result ul.icons');if(container){var fakeIcon='<li class="icon icon-fill"></li>';for(var i=20;i>=0;i--){container.insertAdjacentHTML('beforeend',fakeIcon);}}}};(function(){$(document).on("click",".tag-field__items .remove",function(e){remove_tag_and_reset_tag_value(this);});})();function remove_tag_and_reset_tag_value(remove_button)
{clear_tag(remove_button.parentNode);remove_button.parentNode.remove(remove_button);}
function reset_all_tags(){var close_button_tags=document.querySelectorAll('.tag-field__items .remove');if(close_button_tags.length){close_button_tags.forEach(function(btn){remove_tag_and_reset_tag_value(btn)});}
var input_values=document.querySelectorAll('input[id*="main-search"]');if(input_values.length){input_values.forEach(function(i){i.value='';i.parentNode.removeChild(i);});}}
function clear_tag(tag){var section=tag.dataset.section;var id_prefix='_id';if(section==='main_search_current_section'){id_prefix='';}
section=section.replace(/main_search_/,'main-search-')+id_prefix;document.getElementById(section).value='';};var ls=localStorage;var favColors=['#91DC5A','#006DF0','#933EC5','#FFDA44','#D80027','#FFFFFF','#000000'];var maxCustomColor=5;$(document).ready(function(){initCustomColors();$('#detail_picker').colpick({layout:'hex',submit:0,flat:true,onChange:function(hsb,hex,rgb,el,bySetColor){$(el).css('border-color','#'+hex);if(!bySetColor)$(el).val(hex);ls.color='#'+hex;changeSVGcolor();}});$(document).on("click",'#detail .color-selector li button',function(){var color=$(this).data('color');if(!color)return;$(this).parents('ul').find('li button').removeClass('selected');$(this).addClass('selected');$('#detail_picker').colpickSetColor(color);ls.color=color;changeSVGcolor();});$(document).on('click','#detail ul.size button',function(){var size=$(this).attr('data-size');$('#download-form #size').val(size);if($('#colored').length>0&&$('#colored').is(':checked'))
{$('#download-form #svg_content').val($('svg#img-main-icon').html());}});$(document).on('click','.detail-footer .download li a',function(e){var all=$('.detail-footer .download li a'),curr=$(this),currAct=curr.hasClass('active'),format=curr.data('format'),formats=['png','svg','base64'],icon_colored=parseInt(document.getElementById('colored').value,10),editable=($.inArray(format,formats)>=0&&icon_colored==1||(icon_colored==2&&format=='png')),svgVersion=$('#detail .svg-version'),customize=$('#detail .customize'),customizeAct=customize.hasClass('active'),customizeTimer=customizeAct?300:0;all.removeClass('active');svgVersion.removeClass('active');customize.removeClass('active');if(editable){if(!currAct){curr.addClass('active');if(icon_colored==1)
{svgVersion.addClass('active');}
else
{document.querySelector('section.customize ul.color-selector').previousElementSibling.classList.add('hidden');document.querySelector('section.customize ul.color-selector').classList.add('hidden');}
setTimeout(function(){customize.addClass('active');},customizeTimer);}
if(!customizeAct&&icon_colored==1){svgInline();}}
$('#id').val(icon_id);$('#format').val(format);if(format=='svg')
{document.querySelector('section.customize ul.size .btn-big').classList.remove('hidden');document.querySelector('section.customize ul.size').previousElementSibling.classList.add('hidden');[].forEach.call(document.querySelectorAll('section.customize ul.size .btn-small'),function(li){li.classList.add('hidden');});}
if(format=='png')
{document.querySelector('section.customize ul.size .btn-big').classList.add('hidden');document.querySelector('section.customize ul.size').previousElementSibling.classList.remove('hidden');[].forEach.call(document.querySelectorAll('section.customize ul.size .btn-small'),function(li){li.classList.remove('hidden');});}
return false;});});function generateSvgInline()
{svgInline();changeSVGcolor();}
function svgInline()
{var svgVersion=$('#detail .svg-version div'),imgVersion=$('#detail .img-version img'),svgArray=[];for(var i=0;i<imgVersion.length;i++){svgArray.push($.get(imgVersion[i].getAttribute('src')));}
$.when(svgArray).done(function(){svgArray.forEach(function(response,index){response.success(function(data){if(typeof data=='object')
{var svg=$(data).find('svg');svg.removeAttr('xmlns:a');svgVersion.eq(index).html(svg);}
else
{svgVersion.eq(index).html(imgVersion[index]);}});});});};function getSVG(item,url){$.get(url,function(data){if(typeof data=='object')
{var svg=$(data).find('svg');svg.removeAttr('xmlns:a');item.html(svg);changeSVGcolor();}
else
{item.html('<img src="{0}">'.format(url));}});}
function changeSVGcolor()
{var color=ls.color;if(!color)return;$('#download-form #color').val(color);var detail_icons=document.querySelectorAll("#detail .svg-version svg");[].forEach.call(detail_icons,function(img){[].forEach.call(img.querySelectorAll("path, circle, ellipse, polygon, line, rect, polyline"),function(p)
{p.style.fill=color;});});var section=$('#detail .svg-version');var colorNum=color.substring(1);if(isLightColor(colorNum))
section.addClass('light-icons');else
section.removeClass('light-icons');};function addFavColors()
{var gridCustomFav=$("ul.color-selector");var colors=new Array();var n=0;if(typeof ls.favColors!=='undefined'&&ls.favColors!='')
{colors=JSON.parse(ls.favColors);n=colors.length;if(n>0)
{var keys=Object.keys(colors);for(id in keys)
{var colorCustomFavDiv=document.createElement("div");colorCustomFavDiv.className="colorBox";colorCustomFavDiv.style.backgroundColor=colors[id];colorCustomFavDiv.id=colors[id].substr(1,colors[id].length);gridCustomFav.append(colorCustomFavDiv);}}}}
function saveColor(color)
{if(typeof color=='undefined'){return;}
var colors=new Array();var n=0;if(color.charAt(0)!="#")color="#"+color;if($('#detail .color-selector button[data-color="'+color+'"]').length)return;if(typeof ls.customColors!=='undefined'&&ls.customColors!='')
{colors=JSON.parse(ls.customColors);n=colors.length;}
if(colors.indexOf(color)==-1){if(n>=maxCustomColor)
{var key=Object.keys(colors);var index=key[0];var c=colors[index];colors.splice(index,1);$('#detail ul.color-selector .custom-color[data-color="'+c+'"]').parent().remove();}
colors.push(color);paintCustomColor(color);ls.customColors=JSON.stringify(colors);}}
function initCustomColors()
{if(typeof ls.customColors!=='undefined'&&ls.customColors!='')
{colors=JSON.parse(ls.customColors);n=colors.length;for(i=0;i<n;i++)
{paintCustomColor(colors[i]);}}}
function paintCustomColor(color)
{var gridCustomFav=$("#detail ul.color-selector");var colorFavLi=document.createElement("li");var btn=document.createElement('button');btn.dataset.color=color;btn.className="custom-color";btn.style.backgroundColor=color;btn.addEventListener('click',changeSVGcolor);colorFavLi.appendChild(btn);gridCustomFav.append(colorFavLi);}
function isLightColor(color)
{var r=parseInt(color.substr(0,2),16);var g=parseInt(color.substr(2,2),16);var b=parseInt(color.substr(4,2),16);return((r*299)+(g*587)+(b*114))>=225000;};$(function(){var premium_feedbackform_1_check=false;var premium_feedbackform_2_check=false;var feedback_feedbackform_check=false;var download_feedbackform_check=false;var empty_search_feedbackform_check=false;var search_feedbackform_check=false;var styles_feedbackform_check=false;var packs_feedbackform_1_check=false;var packs_feedbackform_2_check=false;var categories_feedbackform_check=false;var detail_feedbackform_1_check=false;var detail_feedbackform_2_check=false;var collections_feedbackform_1_check=false;var collections_feedbackform_2_check=false;$(document).on('click','.feedbackform-handler-link',function(e){e.preventDefault();e.stopPropagation();var answer_value='';var question_id='';switch(this.dataset.answer){case'Yes':answer_value=2;break;case'No':answer_value=1;break;case'Neutral':answer_value=0;break;default:answer_value=0;break;}
var feedback_form=this.dataset.form;switch(feedback_form){case'premium-feedbackform-1':if(premium_feedbackform_1_check)return;premium_feedbackform_1_check=true;question_id=10;break;case'premium-feedbackform-2':if(premium_feedbackform_2_check)return;premium_feedbackform_2_check=true;question_id=11;break;case'feedback-feedbackform':if(feedback_feedbackform_check)return;feedback_feedbackform_check=true;$('#trigger-feedback-typeform').trigger("click");question_id=12;break;case'download-feedbackform':if(download_feedbackform_check)return;download_feedbackform_check=true;question_id=13;break;case'empty_search-feedbackform':if(empty_search_feedbackform_check)return;empty_search_feedbackform_check=true;question_id=14;answer_value=0;break;case'search-feedbackform':if(search_feedbackform_check)return;search_feedbackform_check=true;question_id=15;break;case'styles-feedbackform':if(styles_feedbackform_check)return;styles_feedbackform_check=true;question_id=16;setcookie('styles_feedback','true',7);break;case'packs-feedbackform-1':if(packs_feedbackform_1_check)return;packs_feedbackform_1_check=true;question_id=17;break;case'packs-feedbackform-2':if(packs_feedbackform_2_check)return;packs_feedbackform_2_check=true;question_id=18;answer_value=0;break;case'categories-feedbackform':if(categories_feedbackform_check)return;categories_feedbackform_check=true;question_id=19;setcookie('categories_feedback','true',7);break;case'detail-feedbackform-1':if(detail_feedbackform_1_check)return;detail_feedbackform_1_check=true;question_id=20;setcookie('detail_feedback','true',7);break;case'detail-feedbackform-2':if(detail_feedbackform_2_check)return;detail_feedbackform_2_check=true;question_id=21;setcookie('detail_feedback','true',7);break;case'collections-feedbackform-1':if(collections_feedbackform_1_check)return;collections_feedbackform_1_check=true;question_id=22;setcookie('collections_feedback','true',7);break;case'collections-feedbackform-2':if(collections_feedbackform_2_check)return;collections_feedbackform_2_check=true;question_id=23;answer_value=0;setcookie('collections_feedback','true',7);break;default:question_id=10;answer_value=0;break;}
send_feedback_forms(question_id,answer_value);});$(document).on('click','.response_buttons .send_feedback',function(e){var popover=this.parentNode.parentNode;var comment=popover.querySelector('textarea').value;var id=popover.dataset.qid;if(comment)send_feedback_comment(comment,id);});$(document).on('click','.response_buttons button:not(.send_feedback)',function(e){close_feedback();});show_feedback();});function setcookie(cookieName,cookieValue,nDays){var today=new Date();var expire=new Date();if(nDays==null||nDays==0)nDays=1;expire.setTime(today.getTime()+3600000*24*nDays);document.cookie=cookieName+"="+escape(cookieValue)+";expires="+expire.toGMTString();}
function show_feedback(forms){var forms_feedback=[];if(forms){forms_feedback=forms;}else{forms_feedback=document.querySelectorAll('.form-feedback');}
var forms_by_type={};forms_feedback.forEach(function(form){if("collections-feedbackform"===form.dataset.form&&!gr.auth.me.status)return;if(forms_by_type[form.dataset.form]){forms_by_type[form.dataset.form].push(form);}else{forms_by_type[form.dataset.form]=[];forms_by_type[form.dataset.form].push(form);}});for(forms in forms_by_type){var cookie_exists=(document.cookie.indexOf(forms_by_type[forms][0].querySelector('button').dataset.form.split('-')[0]+'_feedback='));if(cookie_exists==-1){if(forms_by_type[forms].length>1){var x=Math.floor((Math.random()*forms_by_type[forms].length));}else{var x=0;}
forms_by_type[forms].forEach(function(e){e.classList.add('hidden')});forms_by_type[forms][x].classList.remove('hidden');}}}
function show_feedback_collection(bookmark_id){var forms=document.querySelectorAll('section[data-bookmark="'+bookmark_id+'"] .form-feedback[data-form="collections-feedbackform"]');show_feedback(forms);}
function send_feedback_forms(question_id,answer_value){var N=navigator.appName,UA=navigator.userAgent,temp,browser=[],browserVersion=UA.match(/(opera|chrome|safari|firefox|msie|maxthon|lunascape)\/?\s*(\.?\d+(\.\d+)*)/i);if(browserVersion&&(temp=UA.match(/version\/([\.\d]+)/i))!==null)browserVersion[2]=temp[1];browser["name"]=browserVersion[1];browser["version"]=browserVersion[2];$.ajax({url:APP_URL+'feedback/send_valuation',type:'POST',data:{value:answer_value,question:question_id,browser:browser['name'],browser_version:browser['version'],language:LANGUAGE_SHORT},success:function(response){response=JSON.parse(response);var callback=window[response.callback];if(typeof callback==='function'){callback(response.last_id);}}});}
function set_feedback_id(id){if(document.querySelector('.form-feedback .show-menu')){document.querySelector('.form-feedback .show-menu').dataset.qid=id;}}
function send_feedback_comment(comment,id){$.ajax({url:APP_URL+'feedback/update_comment',type:'POST',data:{id:id,answer:comment},success:function(response){close_feedback();}});}
function close_feedback(){var popover=document.querySelector('.form-feedback .show-menu');popover.querySelector('textarea').value='';popover.classList.toggle('show-menu');popover.dataset.qid='';popover.parentNode.parentNode.parentNode.innerHTML='<span>'+messages.feedback.thanks_message+'</span>';};$(document).on('mousedown','section.related-styles *:not(ul.icons):not(header.related-header)',function(e){e.stopPropagation();if(e.wich!==3){var label='';label=ga_element_dispacher(this);ga('send','event','related-styles','click',label);}});$(document).on('mousedown','section.related-packs *:not(ul.icons):not(header.related-header)',function(e){e.stopPropagation();if(e.wich!==3){var label='';label=ga_element_dispacher(this);ga('send','event','related-packs','click',label);}});$(document).on('mousedown','section.related-tags *:not(ul.icons):not(header.related-header)',function(e){e.stopPropagation();if(e.wich!==3){var label='';label=ga_element_dispacher(this);ga('send','event','related-tags','click',label);}});function ga_element_dispacher(el){var element='';if(el.classList.contains('badge')){element='view-all';}else if(el.classList.contains('flaticon-collections_remove')){element='collections-remove';}else if(el.classList.contains('flaticon-collections_add')){element='collections-add';}else if(el.classList.contains('flaticon-eye')){element='view-icon';}else if(el.parentNode.classList.contains('breadcrumb')){element='breadcrumb';}else{element='container';}
return element;};var pack_items;$(document).ready(function(){if(total_pack>0&&pack_items!=null){next=(current<total_pack)?current+1:0;prev=(current>0)?current-1:total_pack-1;var loadPack=true;if(detectBrowser()=='IE'){$('a.next').attr('href',$('.next-icon-1').attr('data-slug'));$('a.prev').attr('href',$('.prev-icon-1').attr('data-slug'));loadPack=false;}
if(loadPack)set_list_pack(pack,icon_id);}else{$('.next').html('');$('.prev').html('');$('.prev-icon').hide();$('.next-icon').hide();}
if(typeof toggleDetailButton=='function')toggleDetailButton();});var iconsSlider=function(speed){var slider=this,active=false,svgActive=false,prev1,prev2,next1,next2,currentArr,packTotal=pack_items.length-1,prevIcon2=$('.prev-icon-2'),prevIcon1=$('.prev-icon-1'),mainIcon=$('.main-icon'),nextIcon1=$('.next-icon-1'),nextIcon2=$('.next-icon-2'),headerTitle=$('.detail-header h1');updateItems();function updateItems(){prev1=(current-1)<0?packTotal:current-1,prev2=(prev1-1)<0?packTotal:prev1-1,next1=(current+1)>packTotal?0:current+1,next2=(next1+1)>packTotal?0:next1+1;currentArr=[pack_items[prev2].src,pack_items[prev1].src,pack_items[current].src,pack_items[next1].src,pack_items[next2].src];}
function updateSelectors(){prevIcon2=$('.prev-icon-2'),prevIcon1=$('.prev-icon-1'),mainIcon=$('.main-icon'),nextIcon1=$('.next-icon-1'),nextIcon2=$('.next-icon-2');}
this.setImages=function(direction){if(direction==='next'){prevIcon2.removeAttr('class').addClass('next-icon next-icon-2').not('[data-type="svg"]').find('img').attr('src',pack_items[next2].src);prevIcon1.removeAttr('class').addClass('prev-icon prev-icon-2');mainIcon.removeAttr('class').addClass('prev-icon prev-icon-1');nextIcon1.removeAttr('class').addClass('main-icon');nextIcon2.removeAttr('class').addClass('next-icon next-icon-1');}
if(direction==='prev'){prevIcon2.removeAttr('class').addClass('prev-icon prev-icon-1');prevIcon1.removeAttr('class').addClass('main-icon');mainIcon.removeAttr('class').addClass('next-icon next-icon-1');nextIcon1.removeAttr('class').addClass('next-icon next-icon-2');nextIcon2.removeAttr('class').addClass('prev-icon prev-icon-2').not('[data-type="svg"]').find('img').attr('src',pack_items[prev2].src);}
updateSelectors();if(svgActive)
{if(direction==='next')
{if((pack_items[next2].color==1&&pack_items[next2].premium==0)||(pack_items[next2].premium==1&&gr.auth.me.premium))
getSVG(nextIcon2.not('[data-type="img"]'),pack_items[next2].src);else
nextIcon2.not('[data-type="img"]').html('<img src="'+pack_items[next2].src+'" />');}
if(direction==='prev')
{if((pack_items[next2].color==1&&pack_items[next2].premium==0)||(pack_items[next2].premium==1&&gr.auth.me.premium))
getSVG(prevIcon2.not('[data-type="img"]'),pack_items[prev2].src);else
prevIcon2.not('[data-type="img"]').html('<img src="'+pack_items[prev2].src+'" />');}}
else
{}};this.navigation=function(direction){var images=document.querySelectorAll(".gallery div.main-icon img");[].forEach.call(images,function(i){var format=i.src.slice(-3);i.src=(format=='png')?pack_items[current].png:pack_items[current].src;});if(!active){active=true;svgActive=$('#detail .svg-version').hasClass('active');headerTitle.addClass('out');if(direction==='next'){current++;prevIcon2.addClass('nextPos');prevIcon1.addClass('prevOut');mainIcon.addClass('mainPrev');nextIcon1.addClass('nextMain');nextIcon2.addClass('nextIn');ga('send','event','Detail View','Move','Next');}
if(direction==='prev'){current--;prevIcon2.addClass('prevIn');prevIcon1.addClass('prevMain');mainIcon.addClass('mainNext');nextIcon1.addClass('nextOut');nextIcon2.addClass('prevPos');ga('send','event','Detail View','Move','Previous');}
if(current>packTotal)current=0;if(current<0)current=packTotal;updateItems();set_main();setTimeout(function(){headerTitle.removeClass('out');},300);setTimeout(function(){slider.setImages(direction);active=false;},speed);}};};function set_main(){get_equivalents(pack_items[current].id);if(pack_items[current].tags.length){var ul=document.querySelector('ul.tags');ul.innerHTML='';for(i=0;i<pack_items[current].tags.length;i++){var li=document.createElement('li');var link=document.createElement('a');link.innerHTML=pack_items[current].tags[i].tag;link.href=pack_items[current].tags[i].slug;li.appendChild(link);ul.appendChild(li);}}
var classIconType=(pack_items[current].selection==1)?'flaticon-selection':'hidden';classIconType=(pack_items[current].premium==1)?'flaticon-premium':classIconType;document.querySelector('#detail h1 span i').className='';document.querySelector('#detail h1 span i').classList.add(classIconType);document.querySelector('#detail h1 span').classList.toggle('premium',pack_items[current].premium==1);_search=(pack_items[current].premium)?messages.common.free:'premium';_replace=(pack_items[current].premium)?'premium':messages.common.free;$('h1 span.title').html(pack_items[current].description);var h1=document.querySelector("h1");var text=h1.lastChild.nodeValue;h1.lastChild.nodeValue=text.replace(_search,_replace);$_('.modal-single-icon.modal-download p.filename .description').innerHTML=pack_items[current].description;$_("meta[property='og:title']").content=h1.innerText;$_("meta[name='twitter:title']").content=h1.innerText;var share_image=pack_items[current].src.replace('www.flaticon','imageog.flaticon').replace("svg/","png/512/").replace(".svg",".png")+'?size=1200x630f&pad=10,10,10,10&ext=png&bg=FFFFFFFF';$_('.modal-single-icon.modal-download p.filename img').src=pack_items[current].src;$_("meta[property='og:image']").content=share_image;$_("meta[name='twitter:image']").content=share_image;var tw_description=$_("meta[name='twitter:description']").content.split(".");tw_description[0]=tw_description[0].replace(_search,_replace);$_("meta[name='twitter:description']").content=tw_description.join(".");$_("meta[property='og:url']").content=pack_items[current].slug;$_("meta[property='og:description']").content=tw_description.join(".");$_(".modal-single-icon.modal-download .modal-body").classList.toggle("nopremium",!Boolean(pack_items[current].selection));$_(".detail-header .publish_date").innerText=pack_items[current].published;var url=pack_items[current].slug;var category=document.querySelector('.category-icon');document.title=pack_items[current].description+" -"+document.title.split("-")[1].replace(capitalize(category.innerHTML),capitalize(pack_items[current].category)).replace(new RegExp("("+_search+")",'gi'),capitalize(_replace));if(pack_items[current].category)document.querySelector('.category-in-icon').classList.remove('hidden');else document.querySelector('.category-in-icon').classList.add('hidden');document.querySelector('.category-icon').href=pack_items[current].category_url;document.querySelector('.category-icon').innerHTML=pack_items[current].category;var upgrade_btn=$_("#fi-premium-upgrade-button .btn-upgrade");if(upgrade_btn)
{upgrade_btn.href=ACCOUNTS_BASE_URL+'premium/'+pack_items[current].pack_id;}
if('history'in window){window.history.pushState({flaticon:'icon'},pack_items[current].description,url);}
var url_path=url.replace(APP_URL,'');ga('send','pageview','/'+url_path);$_('#stats-downloads').innerHTML=pack_items[current].downloads.toString().replace(/\B(?=(\d{3})+(?!\d))/g,",");$_('#download-form #icon_id').value=pack_items[current].id;$_('#download-form #author').value=pack_items[current].team_id;$_('#download-form #selection').value=pack_items[current].selection;$_('#download-form #colored').value=pack_items[current].color;$_('#download-form #premium').value=pack_items[current].premium;$_('#download-form #keyword').value=pack_items[current].description;set_list_tags();if(typeof toggleDetailButton=='function')toggleDetailButton();Premium.check();if(window.innerWidth>480)$('html,body').animate({scrollTop:0},'slow');}
function get_equivalents(id)
{if(!id)return false;if(!iconsSlider.icon_equivalent_wrapper)return false;$.ajax({url:'/ajax/get_equivalents/'+id,type:'GET',async:true,dataType:'json',success:function(data){iconsSlider.icon_equivalent_wrapper.innerHTML='';for(var i in data)
{data[i].active=(id==i)?' active':'';data[i].id=i;iconsSlider.icon_equivalent_wrapper.insertAdjacentHTML("beforeend",iconsSlider.icon_equivalent_tpl(data[i]));}},error:function(jqXHR,textStatus,errorThrown){iconsSlider.icon_equivalent_wrapper.innerHTML='';console.log('AX ERROR['+errorThrown+']: '+textStatus);}});}
function configure_items_equivalents()
{iconsSlider.icon_equivalent_wrapper=document.querySelector(".detail-styles .detail_equivalent_icons");if(iconsSlider.icon_equivalent_wrapper){iconsSlider.icon_equivalent_tpl=Handlebars.tag('detail-icon-equivalent');iconsSlider.icon_equivalent_wrapper=document.querySelector(".detail-styles .detail_equivalent_icons");}}
function toggleSliderDetailButton(){if(window.toggleDetailBtnInterval)clearInterval(window.toggleDetailBtnInterval);if(pack_items!=null&&pack_items instanceof(Array)&&(current==parseInt(current,10)||current==0)){icon_id=parseInt(pack_items[current].id,10);icon_name=pack_items[current].keyword;icon_team=parseInt(pack_items[current].team_id,10);icon_color=parseInt(pack_items[current].color,10);icon_premium=parseInt(pack_items[current].premium,10);}
else
{icon_id=parseInt(document.getElementById('icon_id').value,10);icon_name=document.querySelector('ul.tags li a.title');icon_team=parseInt(document.getElementById('team').value,10);icon_color=parseInt(document.getElementById('colored').value,10);icon_premium=parseInt(document.getElementById('premium').value,10);}
if(db instanceof Object){var method='addIcon';var collection=Collection.getActive();if(db.queryAll(collection.bookmark_id,{query:{id:icon_id}}).length){method='delIcon';}
var btn=$_("#detail-icon-button");var txt_btn;if(method==='delIcon')
{btn.addClass('btn-danger');txt_btn=messages.collection.delete_icon;}
else
{btn.removeClass('btn-danger');txt_btn=messages.collection.add_icon;}
if(typeof btn.querySelector('span')!='undefined')btn.querySelector('span').innerHTML=txt_btn;btn.setAttribute('onclick',"Widget."+method+"("+icon_id+",'"+icon_name+"',"+icon_team+", "+icon_color+", "+icon_premium+")");btn.get('i').classList.toggle('flaticon-collections_remove',method=='delIcon');}else{window.toggleDetailBtnInterval=setInterval(toggleDetailButton,1000);}}
function set_list_tags(){var tags_list=pack_items[current].tags.map(function(tag){return tag.tag_id}).join();$.ajax({url:'/ajax/search/tags',data:{tags:tags_list,pack:pack},type:'POST',async:true,dataType:'json',success:function(json){var icons=json.items;var total=json.total;var tag=json.tag;$(INFINITY.css_selector).html('');$('section .tags a span').html(total);if(parseInt(total)>0){var breadcrumb=$('section.related-tags .breadcrumb a:last-child');breadcrumb.attr({href:"/"+tag.slug,title:tag.name});breadcrumb.html(capitalize(tag.name));$(".related-header a.badge span").html(tag.total);INFINITY.setUrl=false;INFINITY.tplLoadItem(icons,false);}},error:function(jqXHR,textStatus,errorThrown){console.log('AX ERROR['+errorThrown+']: '+textStatus);}});}
function set_list_pack(pack,icon){if(typeof ie!=='undefined'&&ie){$('#detail').addClass('loaded ie9');return;};if(!(pack_items instanceof(Array))||!pack_items.length)return;$('#detail').addClass('loaded');var mySlider=new iconsSlider(500);configure_items_equivalents();$('#detail a.prev, #detail a.next').fadeIn(250);$('#detail a.next').on('click',function(e){e.preventDefault();mySlider.navigation('next');});$('#detail a.prev').on('click',function(e){e.preventDefault();mySlider.navigation('prev');});$(document).on('keydown',function(e){if(document.querySelector(".modal input[type=checkbox]:checked")){return;}
var inputs=document.querySelectorAll('.collection .collection-content.edit-mode .icons .collectionIcon .edit .collection-icon-rename, .collection .collection-header .edit-name.active .collection-name-input');var focused=[].some.call(inputs,function(e){return e==document.activeElement;});if(!focused)
{if(e.keyCode==39)mySlider.navigation('next');if(e.keyCode==37)mySlider.navigation('prev');}});};;(function($){$.waypoints=function(element,options){var waypoint=this;waypoint.element=$(element);};$.fn.waypoints=function(options){return this.each(function(){var waypoint=new $.waypoints(this,options),counter=0;var settings=$.extend({view:"top",viewOut:false,oneTime:true,inView:function(){},outView:function(){}},options||{});waypoint.position=function(){var waypointP=waypoint.element.offset().top,waypointH=waypoint.element.outerHeight(true),waypointV=settings.view,waypointR;switch(true){case(/[0-9 -()+]+$/.test(waypointV)):waypointR=(waypointP+((waypointV/100)*waypointH));break;case(/top/.test(waypointV)):waypointR=waypointP;break;case(/bottom/.test(waypointV)):waypointR=(waypointP+waypointH);break;default:waypointR=waypointP;break;}
return waypointR;}
$(window).scroll(function(){var windowH=$(window).height(),scrollT=$(window).scrollTop(),scrollB=scrollT+windowH,waypointP=waypoint.position(),waypointV=/[0-9 -()+]+$/.test(settings.view)?settings.view/100:(settings.view==='top'?0:1),waypointH=waypoint.element[0].clientHeight*waypointV;if(waypointP>=scrollT&&waypointP<=scrollB){if(settings.oneTime&&counter<1||!settings.oneTime){waypoint.element[0].page=waypoint.element[0].getAttribute("data-page");settings.inView.call(this,waypoint.element[0]);}
counter++;}else if(settings.viewOut&&(window.pageYOffset<=(waypoint.element[0].offsetTop-window.innerHeight)||window.pageYOffset>=(waypointP+waypointH))){settings.outView.call(this,waypoint.element[0]);}});});};})(jQuery);